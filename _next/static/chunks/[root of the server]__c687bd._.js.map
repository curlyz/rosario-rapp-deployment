{
  "version": 3,
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/util.ts"],"sourcesContent":["import { ClassValue, clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n    return twMerge(clsx(inputs));\n}"],"names":[],"mappings":";;;;;;;;AAGO,SAAS,GAAG,GAAG,MAAoB;IACtC,OAAO,mKAAQ,0IAAK;AACxB"}},
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/calibration.ts"],"sourcesContent":["/*\n    Preferences report to State\n    Here are list of API of mapping\n*/\n\n\n\n/*\n    Calibration value are already reflected within the hardware !\n*/\n\nimport {initialState as providerInitialState} from \"@/gateway/provider\";\nimport { queryDevice } from \"./connection\";\nimport {produce} from 'immer'\n\nconst initialState = {\n    flowmeter: [1, 1, 1],\n    grinder: [1, 1, 1],\n    pid: [0,0,0]\n}\n\nconst calibration = {\n    initialState,\n}\nexport default calibration;\n\nexport async function syncCalibrationFromDevice() {\n    const request = await queryDevice({\n        command: 'calib.get',\n    });\n\n    // return {\n    //     flowmeter: request['response']['calibration']['flowmeter'] as number[],\n    //     grinder: request['response']['calibration']['grinder'] as number[],\n    //     temperature: request['response']['calibration']['temperature'] as number[],\n    // };\n\n    const ctx = (window as any).ctx as typeof providerInitialState\n    ctx.setCalibration(produce(ctx.calibration, draft => {\n        draft.flowmeter = request['response']['calibration']['flowmeter'] as number[]\n        draft.grinder = request['response']['calibration']['grinder'] as number[]\n        // draft.temperature = request['response']['calibration']['temperature'] as number[]\n        console.log('calibration/ pulled from device', request['response']['calibration'])\n        return draft\n    })\n    )\n\n    // !\n\n    // ctx.calibration = {\n    //     flowmeter: request['response']['calibration']['flowmeter'] as number[],\n    //     grinder: request['response']['calibration']['grinder'] as number[],\n    //     // temperature: request['response']['calibration']['temperature'] as number[],\n    // }\n\n}\n\nimport { isInitialized } from './connection'\n\n\nexport async function setCalibration({ flowmeter, grinder, temperature }: { flowmeter: number[], grinder: number[], temperature: number[] }) {\n    if (!isInitialized) return \n\n\n\n    return await queryDevice({\n        command: 'calib.set',\n        calibration: {\n            flowmeter,\n            grinder,\n            temperature\n        }\n    });\n}\n\n\n"],"names":[],"mappings":"AAAA;;;AAGA,GAIA;;AAEA;;;;;;;;;;AAMA,MAAM,eAAe;IACjB,WAAW;QAAC;QAAG;QAAG;KAAE;IACpB,SAAS;QAAC;QAAG;QAAG;KAAE;IAClB,KAAK;QAAC;QAAE;QAAE;KAAE;AAChB;AAEA,MAAM,cAAc;IAChB;AACJ;uCACe;AAER,eAAe;IAClB,MAAM,UAAU,MAAM,wIAAY;QAC9B,SAAS;IACb;IAEA,WAAW;IACX,8EAA8E;IAC9E,0EAA0E;IAC1E,kFAAkF;IAClF,KAAK;IAEL,MAAM,MAAM,AAAC,OAAe,GAAG;IAC/B,IAAI,cAAc,CAAC,+IAAQ,IAAI,WAAW,EAAE,CAAA;QACxC,MAAM,SAAS,GAAG,OAAO,CAAC,WAAW,CAAC,cAAc,CAAC,YAAY;QACjE,MAAM,OAAO,GAAG,OAAO,CAAC,WAAW,CAAC,cAAc,CAAC,UAAU;QAC7D,oFAAoF;QACpF,QAAQ,GAAG,CAAC,mCAAmC,OAAO,CAAC,WAAW,CAAC,cAAc;QACjF,OAAO;IACX;AAGA,IAAI;AAEJ,sBAAsB;AACtB,8EAA8E;AAC9E,0EAA0E;AAC1E,qFAAqF;AACrF,IAAI;AAER;;AAKO,eAAe,eAAe,EAAE,SAAS,EAAE,OAAO,EAAE,WAAW,EAAqE;IACvI,IAAI,4IAAgB;IAIpB,OAAO,MAAM,wIAAY;QACrB,SAAS;QACT,aAAa;YACT;YACA;YACA;QACJ;IACJ;AACJ"}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/pid.ts"],"sourcesContent":["\"use client\";\n\nimport { produce } from \"immer\";\nimport { queryDevice } from \"./connection\";\nimport { initialState } from \"./provider\";\nimport { isInitialized } from \"./connection\";\n\n// + finalized\nexport interface IPidState {\n  isActive: boolean;\n  targetTemperature: number;\n  proportional: number;\n  integral: number;\n  derivative: number;\n  activeRange: number;\n}\n\nexport const pidInitialState: IPidState[] = new Array(3).fill({\n  isActive: false,\n  proportional: 0,\n  integral: 0,\n  derivative: 0,\n  targetTemperature: 0,\n  activeRange: 0,\n});\n\nexport interface IPidDisplay {\n  currentTemperature: number;\n  currentPower: number;\n  powerSamples: number[];\n  temperatureSamples: number[];\n}\nexport const pidInitialDisplay: IPidDisplay[] = new Array(3).fill({\n  currentTemperature: 0,\n  currentPower: 0,\n  temperatureSamples: Array(100).fill(0),\n  powerSamples: Array(100).fill(0),\n});\n\nexport class PidSettingParameter {\n  proportional: number;\n  integral: number;\n  derivative: number;\n  targetTemperature: number;\n  activeRange: number;\n  isActive: boolean;\n\n  constructor({\n    proportional,\n    integral,\n    derivative,\n    targetTemperature,\n    activeRange,\n    isActive,\n  }: {\n    proportional: number;\n    integral: number;\n    derivative: number;\n    targetTemperature: number;\n    activeRange: number;\n    isActive: boolean;\n  }) {\n    this.proportional = proportional;\n    this.integral = integral;\n    this.derivative = derivative;\n    this.targetTemperature = targetTemperature;\n    this.activeRange = activeRange;\n    this.isActive = isActive;\n  }\n  isEqual(other: PidSettingParameter): boolean {\n    return (\n      this.proportional === other.proportional &&\n      this.integral === other.integral &&\n      this.derivative === other.derivative &&\n      this.targetTemperature === other.targetTemperature &&\n      this.activeRange === other.activeRange &&\n      this.isActive === other.isActive\n    );\n  }\n}\n\nexport class PidStatusParameter {\n  currentTemperature: number;\n  currentPower: number;\n  temperatureSamples: number[];\n  powerSamples: number[];\n  constructor({\n    currentTemperature,\n    currentPower,\n    temperatureSamples,\n    powerSamples,\n  }: {\n    currentTemperature: number;\n    currentPower: number;\n    temperatureSamples: number[];\n    powerSamples: number[];\n  }) {\n    this.currentTemperature = currentTemperature;\n    this.currentPower = currentPower;\n    this.temperatureSamples = temperatureSamples;\n    this.powerSamples = powerSamples;\n  }\n}\n\nconst syncedPidState = new Map<number, PidSettingParameter>();\nexport async function setPidConfiguration({\n  channel,\n  pid,\n}: {\n  channel: number;\n  pid: PidSettingParameter;\n}) {\n  // only send if different\n\n  // dont run this if device hasn't get the initializeSync process done\n  if (!isInitialized) {\n    return false;\n  }\n  await queryDevice({\n    command: \"pid.set\",\n    channel: channel,\n    proportional: pid.proportional,\n    integral: pid.integral,\n    derivative: pid.derivative,\n    targetTemperature: pid.targetTemperature,\n    activeRange: pid.activeRange,\n    isActive: pid.isActive,\n  });\n  return true;\n}\n\nexport async function syncPidConfigurationFromDevice({\n  channel,\n}: {\n  channel: number;\n}): Promise<PidSettingParameter> {\n  const request = await queryDevice({\n    command: \"pid.get\",\n    channel,\n  });\n\n  const pid = new PidSettingParameter({\n    proportional: request[\"response\"][\"proportional\"] as number,\n    integral: request[\"response\"][\"integral\"] as number,\n    derivative: request[\"response\"][\"derivative\"] as number,\n    targetTemperature: request[\"response\"][\"targetTemperature\"] as number,\n    activeRange: request[\"response\"][\"activeRange\"] as number,\n    isActive: request[\"response\"][\"isActive\"] as boolean,\n    // history: {\n    //     power: request['response']['history']['power'] as number[],\n    //     temperature: request['response']['history']['temperature'] as number[]\n    // }\n  });\n\n  const ctx = (window as any).ctx as typeof initialState;\n  ctx.setPidState(\n    produce(ctx.pidState, (draft) => {\n      draft[channel].proportional = pid.proportional;\n      draft[channel].integral = pid.integral;\n      draft[channel].derivative = pid.derivative;\n      draft[channel].targetTemperature = pid.targetTemperature;\n      draft[channel].activeRange = pid.activeRange;\n      draft[channel].isActive = pid.isActive;\n    }),\n  );\n\n  return pid;\n}\n\nexport async function syncPidStatus({\n  channel,\n}: {\n  channel: number;\n}): Promise<PidStatusParameter> {\n  const request = await queryDevice({\n    command: \"pid.status\",\n    channel: channel,\n  });\n\n  const status = new PidStatusParameter({\n    currentTemperature: request[\"response\"][\"currentTemperature\"] as number,\n    currentPower: request[\"response\"][\"currentPower\"] as number,\n    temperatureSamples: request[\"response\"][\"temperatureSamples\"] as number[],\n    powerSamples: request[\"response\"][\"powerSamples\"] as number[],\n  });\n  console.log(\"sync pid status\", {status, channel, request  });\n\n  const ctx = (window as any).ctx as typeof initialState;\n  \n\n  ctx.setPidDisplay(produce(ctx.pidDisplay, draft => {\n      draft[channel].currentTemperature = status.currentTemperature;\n      draft[channel].currentPower = status.currentPower;\n      draft[channel].temperatureSamples = status.temperatureSamples;\n      draft[channel].powerSamples = status.powerSamples;\n  }))\n\n  return status;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 227, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/service_worker.ts"],"sourcesContent":["export async function registerServiceWorker() {\n  try {\n    if (location.href.includes(\"localhost\")) {\n      console.log(\"sw/ disable service worker on localhost\");\n      return;\n    }\n    setInterval(function () {\n      fetch(\"/index.html\");\n    }, 10000);\n\n    \n\n    var regitration = await navigator.serviceWorker.register(\"/sw.js\", {\n      scope: \"/\",\n    });\n\n  }\n  catch (e) {\n    console.error(e);\n  }\n}\n"],"names":[],"mappings":";;;AAAO,eAAe;IACpB,IAAI;QACF,IAAI,SAAS,IAAI,CAAC,QAAQ,CAAC,cAAc;YACvC,QAAQ,GAAG,CAAC;YACZ;QACF;QACA,YAAY;YACV,MAAM;QACR,GAAG;QAIH,IAAI,cAAc,MAAM,UAAU,aAAa,CAAC,QAAQ,CAAC,UAAU;YACjE,OAAO;QACT;IAEF,EACA,OAAO,GAAG;QACR,QAAQ,KAAK,CAAC;IAChB;AACF"}},
    {"offset": {"line": 251, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 256, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/grinder.ts"],"sourcesContent":["\"use client\";\n\nimport { queryDevice } from \"./connection\";\nimport { initialState } from \"./provider\";\n\nexport interface IGrinderState {\n  connectionType: \"Wire\" | \"Bluetooth\";\n  connectionId: number;\n  calibration: number;\n  id: number;\n  name: string;\n}\n\nexport enum EnumSkipBehaviour {\n  Skip = \"Skip\",\n  Wait = \"Wait\",\n}\n\nexport const grinderInitialState: IGrinderState[] = [\n  {\n    connectionType: \"Wire\",\n    connectionId: 20,\n    calibration: 1.17,\n    id: 0,\n    name: \"Arabica\",\n  },\n  {\n    connectionType: \"Wire\",\n    connectionId: 20,\n    calibration: 1.17,\n    id: 0,\n    name: \"Coco\",\n  },\n];\nexport class GrinderSettingParameter {\n  connectionType: \"Wire\" | \"Bluetooth\" = \"Wire\";\n  connectionId: number = 0;\n  calibration: number = 0;\n  constructor({ connectionType, connectionId, calibration }: IGrinderState) {\n    this.connectionType = connectionType;\n    this.connectionId = connectionId;\n    this.calibration = calibration;\n  }\n}\n\nexport async function setGrinderConfiguration() {\n  // map each of the pid state to this\n  const ctx = (window as any).ctx as typeof initialState;\n  const grinders = ctx.grinderSettings;\n\n  await queryDevice({\n    command: \"grinder.set\",\n    grinders,\n  });\n}\n\nexport async function getGrinderConfiguration() {\n  const req = await queryDevice({\n    command: \"grinder.get\",\n  });\n  const grinderSettings = req[\"response\"][\"grinderSettings\"];\n  console.log(\"grinder/ acquired\", grinderSettings);\n\n  const ctx = (window as any).ctx as typeof initialState;\n  // ctx.grinderSettings.forEach(draft => {\n  //     grinderSettings.set\n  // })\n  ctx.setGrinderSettings(grinderSettings);\n}\n"],"names":[],"mappings":";;;;;;;;;AAAA;;;UAaY;;;GAAA,sBAAA;AAKL,MAAM,sBAAuC;IAClD;QACE,gBAAgB;QAChB,cAAc;QACd,aAAa;QACb,IAAI;QACJ,MAAM;IACR;IACA;QACE,gBAAgB;QAChB,cAAc;QACd,aAAa;QACb,IAAI;QACJ,MAAM;IACR;CACD;AACM,MAAM;IACX,iBAAuC,OAAO;IAC9C,eAAuB,EAAE;IACzB,cAAsB,EAAE;IACxB,YAAY,EAAE,cAAc,EAAE,YAAY,EAAE,WAAW,EAAiB,CAAE;QACxE,IAAI,CAAC,cAAc,GAAG;QACtB,IAAI,CAAC,YAAY,GAAG;QACpB,IAAI,CAAC,WAAW,GAAG;IACrB;AACF;AAEO,eAAe;IACpB,oCAAoC;IACpC,MAAM,MAAM,AAAC,OAAe,GAAG;IAC/B,MAAM,WAAW,IAAI,eAAe;IAEpC,MAAM,wIAAY;QAChB,SAAS;QACT;IACF;AACF;AAEO,eAAe;IACpB,MAAM,MAAM,MAAM,wIAAY;QAC5B,SAAS;IACX;IACA,MAAM,kBAAkB,GAAG,CAAC,WAAW,CAAC,kBAAkB;IAC1D,QAAQ,GAAG,CAAC,qBAAqB;IAEjC,MAAM,MAAM,AAAC,OAAe,GAAG;IAC/B,yCAAyC;IACzC,0BAA0B;IAC1B,KAAK;IACL,IAAI,kBAAkB,CAAC;AACzB"}},
    {"offset": {"line": 319, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 331, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/i18n/index.js"],"sourcesContent":["var en = require(\"./translations.en.json\");\nvar vi = require(\"./translations.vi.json\");\n\nconst i18n = {\n  translations: {\n    en,\n    vi,\n  },\n  defaultLang: \"en\",\n  useBrowserDefault: true,\n  // optional property will default to \"query\" if not set\n  languageDataStore: \"localStorage\",\n};\n\nmodule.exports = i18n;\n"],"names":[],"mappings":"AAAA,IAAI,KAAK;AACT,IAAI,KAAK;AAET,MAAM,OAAO;IACX,cAAc;QACZ;QACA;IACF;IACA,aAAa;IACb,mBAAmB;IACnB,uDAAuD;IACvD,mBAAmB;AACrB;AAEA,OAAO,OAAO,GAAG"}},
    {"offset": {"line": 344, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 349, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/target.ts"],"sourcesContent":["export enum ProfileType {\n    PressureProfiling = \"PressureProfile\",\n    FlowrateProfiling = \"FlowateProfile\",\n};\nexport enum TargetType {\n    Weight = \"Weight\",\n    Time = \"Time\",\n};\nexport class Time {\n    duration: number;\n    constructor({ duration }: { duration: number }) {\n        this.duration = duration;\n    }\n    toData() {\n        return {\n            targetType: TargetType.Time,\n            duration: this.duration,\n        }\n    }\n    static fromData(data: any) {\n        return new Time({\n            duration: data.duration\n        });\n    }\n}\nexport class Weight {\n    weight: number;\n    constructor({ weight }: { weight: number }) {\n        this.weight = weight;\n    }\n    toData() {\n        return {\n            targetType: TargetType.Weight,\n            weight: this.weight,\n        }\n    }\n\n    static fromData(data: any) {\n        return new Weight({\n            weight: data.weight\n        });\n    }\n}\nexport type TargetClass = Time | Weight;\n"],"names":[],"mappings":";;;;;;;UAAY;;;GAAA,gBAAA;;UAIA;;;GAAA,eAAA;AAIL,MAAM;IACT,SAAiB;IACjB,YAAY,EAAE,QAAQ,EAAwB,CAAE;QAC5C,IAAI,CAAC,QAAQ,GAAG;IACpB;IACA,SAAS;QACL,OAAO;YACH,UAAU;YACV,UAAU,IAAI,CAAC,QAAQ;QAC3B;IACJ;IACA,OAAO,SAAS,IAAS,EAAE;QACvB,OAAO,IAAI,KAAK;YACZ,UAAU,KAAK,QAAQ;QAC3B;IACJ;AACJ;AACO,MAAM;IACT,OAAe;IACf,YAAY,EAAE,MAAM,EAAsB,CAAE;QACxC,IAAI,CAAC,MAAM,GAAG;IAClB;IACA,SAAS;QACL,OAAO;YACH,UAAU;YACV,QAAQ,IAAI,CAAC,MAAM;QACvB;IACJ;IAEA,OAAO,SAAS,IAAS,EAAE;QACvB,OAAO,IAAI,OAAO;YACd,QAAQ,KAAK,MAAM;QACvB;IACJ;AACJ"}},
    {"offset": {"line": 399, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 404, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/action.ts"],"sourcesContent":["import { ProfileType } from \"./target\";\n\nexport enum ActionType {\n  Grinding = \"Grinding\",\n  Extracting = \"Extracting\",\n  Profiling = \"Profilling\",\n}\nexport enum ConnectionType {\n  Wire = \"Wired\",\n  Bluetooth = \"Bluetooth\",\n}\n\nexport class GrinderAction {\n  // grinder have grinderId, grinderConnection\n  grinderId: number;\n  grinderConnection: ConnectionType;\n  canSkip: boolean;\n  canWait: boolean;\n\n  constructor({\n    grinderId,\n    grinderConnection,\n    canSkip,\n    canWait,\n  }: {\n    grinderId: number;\n    grinderConnection: ConnectionType;\n    canSkip: boolean;\n    canWait: boolean;\n  }) {\n    this.grinderId = grinderId;\n    this.grinderConnection = grinderConnection;\n    this.canSkip = canSkip;\n    this.canWait = canWait;\n  }\n\n  toData() {\n    return {\n      actionType: ActionType.Grinding,\n      grinderId: this.grinderId,\n      grinderConnection: this.grinderConnection,\n      canSkip: this.canSkip,\n      canWait: this.canWait,\n    };\n  }\n\n  static fromData(data: any) {\n    return new GrinderAction({\n      grinderId: data.grinderId,\n      grinderConnection: data.grinderConnection,\n      canSkip: data.canSkip,\n      canWait: data.canWait,\n    });\n  }\n}\nexport class PumpAction {\n  power: number;\n  valveState: boolean;\n  constructor({ power, valveState }: { power: number; valveState: boolean }) {\n    this.power = power;\n    this.valveState = valveState;\n  }\n  toData() {\n    return {\n      actionType: ActionType.Extracting,\n      power: this.power,\n      valveState: this.valveState,\n    };\n  }\n\n  static fromData(data: any) {\n    return new PumpAction({\n      power: data.power,\n      valveState: data.valveState,\n    });\n  }\n}\nexport class ProfilingAction {\n  profileType: ProfileType;\n  segments: Segment[];\n  refreshInterval: number; // how fast we update\n  kp: number;\n  ki: number;\n  kd: number;\n\n  constructor({\n    profileType,\n    segments,\n    refreshInterval,\n  }: {\n    profileType: ProfileType;\n    segments: Segment[];\n    refreshInterval: number;\n  }) {\n    this.profileType = profileType;\n    this.segments = segments;\n    this.refreshInterval = refreshInterval;\n  }\n  toData() {\n    const steps: Segment[] = [];\n    this.segments.forEach((segment) => {\n      steps.push(segment);\n    });\n\n    return {\n      actionType: ActionType.Profiling,\n      profileType: this.profileType,\n      refreshInterval: this.refreshInterval,\n      segments: steps,\n    };\n  }\n  static fromData(data: any) {\n    const segments = data.segments.map((segment: any) =>\n      Segment.fromData(segment),\n    );\n    return new ProfilingAction({\n      profileType: data.profileType,\n      segments: segments,\n      refreshInterval: data.refreshInterval,\n    });\n  }\n}\nexport class Segment {\n  duration: number;\n  value: number;\n\n  constructor({ duration, value }: { duration: number; value: number }) {\n    this.duration = duration;\n    this.value = value;\n  }\n\n  toData() {\n    return {\n      duration: this.duration,\n      value: this.value,\n    };\n  }\n\n  static fromData(data: any) {\n    return new Segment({\n      duration: data.duration,\n      value: data.value,\n    });\n  }\n}\nexport type ActionClass = GrinderAction | PumpAction | ProfilingAction;\n"],"names":[],"mappings":";;;;;;;;;UAEY;;;;GAAA,eAAA;;UAKA;;;GAAA,mBAAA;AAKL,MAAM;IACX,4CAA4C;IAC5C,UAAkB;IAClB,kBAAkC;IAClC,QAAiB;IACjB,QAAiB;IAEjB,YAAY,EACV,SAAS,EACT,iBAAiB,EACjB,OAAO,EACP,OAAO,EAMR,CAAE;QACD,IAAI,CAAC,SAAS,GAAG;QACjB,IAAI,CAAC,iBAAiB,GAAG;QACzB,IAAI,CAAC,OAAO,GAAG;QACf,IAAI,CAAC,OAAO,GAAG;IACjB;IAEA,SAAS;QACP,OAAO;YACL,UAAU;YACV,WAAW,IAAI,CAAC,SAAS;YACzB,mBAAmB,IAAI,CAAC,iBAAiB;YACzC,SAAS,IAAI,CAAC,OAAO;YACrB,SAAS,IAAI,CAAC,OAAO;QACvB;IACF;IAEA,OAAO,SAAS,IAAS,EAAE;QACzB,OAAO,IAAI,cAAc;YACvB,WAAW,KAAK,SAAS;YACzB,mBAAmB,KAAK,iBAAiB;YACzC,SAAS,KAAK,OAAO;YACrB,SAAS,KAAK,OAAO;QACvB;IACF;AACF;AACO,MAAM;IACX,MAAc;IACd,WAAoB;IACpB,YAAY,EAAE,KAAK,EAAE,UAAU,EAA0C,CAAE;QACzE,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,UAAU,GAAG;IACpB;IACA,SAAS;QACP,OAAO;YACL,UAAU;YACV,OAAO,IAAI,CAAC,KAAK;YACjB,YAAY,IAAI,CAAC,UAAU;QAC7B;IACF;IAEA,OAAO,SAAS,IAAS,EAAE;QACzB,OAAO,IAAI,WAAW;YACpB,OAAO,KAAK,KAAK;YACjB,YAAY,KAAK,UAAU;QAC7B;IACF;AACF;AACO,MAAM;IACX,YAAyB;IACzB,SAAoB;IACpB,gBAAwB;IACxB,GAAW;IACX,GAAW;IACX,GAAW;IAEX,YAAY,EACV,WAAW,EACX,QAAQ,EACR,eAAe,EAKhB,CAAE;QACD,IAAI,CAAC,WAAW,GAAG;QACnB,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,eAAe,GAAG;IACzB;IACA,SAAS;QACP,MAAM,QAAmB,EAAE;QAC3B,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;YACrB,MAAM,IAAI,CAAC;QACb;QAEA,OAAO;YACL,UAAU;YACV,aAAa,IAAI,CAAC,WAAW;YAC7B,iBAAiB,IAAI,CAAC,eAAe;YACrC,UAAU;QACZ;IACF;IACA,OAAO,SAAS,IAAS,EAAE;QACzB,MAAM,WAAW,KAAK,QAAQ,CAAC,GAAG,CAAC,CAAC,UAClC,QAAQ,QAAQ,CAAC;QAEnB,OAAO,IAAI,gBAAgB;YACzB,aAAa,KAAK,WAAW;YAC7B,UAAU;YACV,iBAAiB,KAAK,eAAe;QACvC;IACF;AACF;AACO,MAAM;IACX,SAAiB;IACjB,MAAc;IAEd,YAAY,EAAE,QAAQ,EAAE,KAAK,EAAuC,CAAE;QACpE,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,KAAK,GAAG;IACf;IAEA,SAAS;QACP,OAAO;YACL,UAAU,IAAI,CAAC,QAAQ;YACvB,OAAO,IAAI,CAAC,KAAK;QACnB;IACF;IAEA,OAAO,SAAS,IAAS,EAAE;QACzB,OAAO,IAAI,QAAQ;YACjB,UAAU,KAAK,QAAQ;YACvB,OAAO,KAAK,KAAK;QACnB;IACF;AACF"}},
    {"offset": {"line": 527, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 532, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/step.ts"],"sourcesContent":["import {\n  ActionClass,\n  ActionType,\n  GrinderAction,\n  ProfilingAction,\n  PumpAction,\n} from \"./action\";\nimport { TargetClass, TargetType, Time, Weight } from \"./target\";\n\n// Interim object\nexport type IStepFeedback = {\n  //\n\n  stepId: number;\n  groupId: number;\n  target: {\n    type: EnumTarget;\n    total: number;\n    value: number;\n  };\n  action: {\n    profilingType: EnumProfileType;\n    expectedValue: number;\n    timestamp: number;\n    input: number;\n    pressure: number;\n    output: number;\n  };\n};\n\nexport enum EnumTarget {\n  Time = \"Time\",\n  Weight = \"Weight\",\n}\nexport enum EnumAction {\n  Grind = \"Grind\",\n  Rest = \"Rest\",\n  Extract = \"Extract\",\n  Profile = \"Profile\",\n  PourOver = \"Pour\",\n  Sound = \"Sound\",\n  RGB = \"RGB\",\n}\n\nexport type IStep = {\n  id: string;\n  action: IAction;\n  target: ITarget;\n};\n\nexport type ITarget = {\n  targetType: EnumTarget;\n  value: number;\n  current?: number; // for reporting progress\n};\n\nexport type IPourOverParam = {\n  /* \n        Pour over \n    */\n  actionType: \"Pour\";\n  stepAmount: number;\n  duration: number;\n  pumpPower: number;\n};\nexport type ISoundParam = {\n  actionType: \"Sound\";\n};\nexport type IRGBParam = {\n  actionType: \"RGB\";\n  color: string;\n  start: number;\n  stop: number;\n  animation: string;\n\n};\n\nexport type IAction =\n  | IRestParam\n  | IGrindParam\n  | IExtractParam\n  | IProfileParam\n  | IPourOverParam\n  | ISoundParam\n  | IRGBParam;\n\nexport type IRestParam = {\n  actionType: \"Rest\";\n  valveState: boolean;\n};\n\nexport type IGrindParam = {\n  actionType: \"Grind\";\n  ingredient: string;\n  canSkip: boolean;\n  mustWait: boolean;\n};\n\nexport type IExtractParam = {\n  actionType: \"Extract\";\n  power: number;\n};\n\nexport enum EnumProfileType {\n  Pressure = \"Pressure\",\n  Flowrate = \"Flowrate\",\n  Power = \"Power\",\n}\n\nexport type IProfileParam = {\n  actionType: \"Profile\";\n  segments: IProfilingSegment[];\n  profilingType: EnumProfileType;\n  updateInterval: number;\n};\n\n\n\nexport type IProfilingSegment = {\n  duration: number;\n  value: number;\n  smooth: boolean;\n};\n\n//! Deprecated\nexport class Step {\n  action: ActionClass;\n  target: TargetClass;\n  constructor({\n    action,\n    target,\n  }: {\n    action: ActionClass;\n    target: TargetClass;\n  }) {\n    this.action = action;\n    this.target = target;\n  }\n\n  toData() {\n    return {\n      action: this.action.toData(),\n      target: this.target.toData(),\n    };\n  }\n\n  static fromData(data: any) {\n    let _action: ActionClass;\n    switch (data.actionType) {\n      case ActionType.Grinding:\n        _action = new GrinderAction(data.action);\n        break;\n      case ActionType.Extracting:\n        _action = new PumpAction(data.action);\n        break;\n      case ActionType.Profiling:\n        _action = new ProfilingAction(data.action);\n        break;\n      default:\n        _action = new GrinderAction(data.action);\n    }\n    let _target: TargetClass;\n    switch (data.targetType) {\n      case TargetType.Time:\n        _target = new Time(data.target);\n        break;\n      case TargetType.Weight:\n        _target = new Weight(data.target);\n        break;\n      default:\n        _target = new Time(data.target);\n    }\n    return new Step({\n      action: _action,\n      target: _target,\n    });\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;UA8BY;;;GAAA,eAAA;;UAIA;;;;;;;;GAAA,eAAA;;UAqEA;;;;GAAA,oBAAA;AAsBL,MAAM;IACX,OAAoB;IACpB,OAAoB;IACpB,YAAY,EACV,MAAM,EACN,MAAM,EAIP,CAAE;QACD,IAAI,CAAC,MAAM,GAAG;QACd,IAAI,CAAC,MAAM,GAAG;IAChB;IAEA,SAAS;QACP,OAAO;YACL,QAAQ,IAAI,CAAC,MAAM,CAAC,MAAM;YAC1B,QAAQ,IAAI,CAAC,MAAM,CAAC,MAAM;QAC5B;IACF;IAEA,OAAO,SAAS,IAAS,EAAE;QACzB,IAAI;QACJ,OAAQ,KAAK,UAAU;YACrB,KAAK,mIAAW,QAAQ;gBACtB,UAAU,0IAAkB,KAAK,MAAM;gBACvC;YACF,KAAK,mIAAW,UAAU;gBACxB,UAAU,uIAAe,KAAK,MAAM;gBACpC;YACF,KAAK,mIAAW,SAAS;gBACvB,UAAU,4IAAoB,KAAK,MAAM;gBACzC;YACF;gBACE,UAAU,0IAAkB,KAAK,MAAM;QAC3C;QACA,IAAI;QACJ,OAAQ,KAAK,UAAU;YACrB,KAAK,mIAAW,IAAI;gBAClB,UAAU,iIAAS,KAAK,MAAM;gBAC9B;YACF,KAAK,mIAAW,MAAM;gBACpB,UAAU,mIAAW,KAAK,MAAM;gBAChC;YACF;gBACE,UAAU,iIAAS,KAAK,MAAM;QAClC;QACA,OAAO,IAAI,KAAK;YACd,QAAQ;YACR,QAAQ;QACV;IACF;AACF"}},
    {"offset": {"line": 609, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 614, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/formula.ts"],"sourcesContent":["import { initialState } from \"@/gateway/provider\";\nimport { produce } from \"immer\";\nimport { queryDevice } from \"./connection\";\nimport { EnumAction, IStep, Step } from \"./step\";\nimport { FaMapLocation } from \"react-icons/fa6\";\n\nexport enum EnumFormulaType {\n  Espresso = \"Espresso\",\n  Teapresso = \"Teapresso\",\n  PourOver = \"PourOver\",\n}\n\nexport class Formula {\n  steps: Step[];\n  name?: string;\n  uuid?: number;\n  createdAt?: number;\n  lastUsed?: number;\n  totalUsed?: number;\n\n  constructor({\n    steps,\n    name,\n    uuid,\n    createdAt,\n    lastUsed,\n    totalUsed,\n  }: {\n    steps: Step[];\n    name?: string;\n    uuid?: number;\n    createdAt?: number;\n    lastUsed?: number;\n    totalUsed?: number;\n  }) {\n    this.steps = steps;\n    this.name = name;\n    this.uuid = uuid;\n    this.createdAt = createdAt;\n    this.lastUsed = lastUsed;\n    this.totalUsed = totalUsed;\n  }\n  toData() {\n    const steps: Step[] = [];\n    this.steps.forEach((step) => {\n      steps.push(step);\n    });\n    return {\n      steps: steps,\n      name: this.name,\n      uuid: this.uuid,\n      createdAt: this.createdAt,\n      lastUsed: this.lastUsed,\n      totalUsed: this.totalUsed,\n    };\n  }\n\n  fromData(data: any) {\n    const steps = data.steps.map((step: any) => Step.fromData(step));\n    return new Formula({\n      steps: steps,\n      name: data.name,\n      uuid: data.uuid,\n      createdAt: data.createdAt,\n      lastUsed: data.lastUsed,\n      totalUsed: data.totalUsed,\n    });\n  }\n}\n\nexport async function clearGroupFormula({\n  groupId,\n  buttonId,\n}: {\n  groupId: number;\n  buttonId: number;\n}) {\n  return await queryDevice({\n    command: \"group.clear\",\n    groupId,\n    buttonId,\n  });\n}\nexport async function writeGroupFormula({\n  groupId,\n  buttonId,\n  formula,\n}: {\n  groupId: number;\n  buttonId: number;\n  formula: object;\n}) {\n  return await queryDevice({\n    command: \"group.write\",\n    groupId,\n    buttonId,\n    formula,\n  });\n}\n\nexport async function saveGroupFormula({\n  groupId,\n  buttonId,\n}: {\n  groupId: number;\n  buttonId: number;\n}) {\n  return await queryDevice({\n    command: \"group.save\",\n    groupId,\n    buttonId,\n  });\n}\n\nexport async function loadGroupFormula({\n  groupId,\n  buttonId,\n}: {\n  groupId: number;\n  buttonId: number;\n}) {\n  return await queryDevice({\n    command: \"group.load\",\n    groupId,\n    buttonId,\n  });\n}\n\nexport async function readGroupFormula({\n  groupId,\n  buttonId,\n}: {\n  groupId: number;\n  buttonId: number;\n}) {\n  return await queryDevice({\n    command: \"group.read\",\n    groupId,\n    buttonId,\n  });\n}\n\nexport async function runGroupFormula({\n  groupId,\n  buttonId,\n}: {\n  groupId: number;\n  buttonId: number;\n}) {\n\n  return await queryDevice({\n    command: \"group.run\",\n    groupId,\n    buttonId,\n  });\n}\n\nfunction convertSteps(steps: IStep[]) {\n  /*\n    There are bugs in the Runes of NewStepCard that keep messing this up\n    This is a clean workaround\n  */\n  const cvts: any = [];\n  for (const step of steps) {\n    // if (step.action.actionType == 'Rest') {\n    //   const action = step.action as IRestParam\n    //   action.valveState = action.valveState * 1000\n    // }\n    const cvt: any = {};\n    cvt.action = {};\n    cvt.target = {};\n    cvts.push(cvt);\n\n    const mock = 1; // send raw valu \n\n\n    if (step.action.actionType == EnumAction.Rest) {\n      cvt.action.actionType = \"Rest\";\n      cvt.action.valveState = step.action.valveState || true;\n      cvt.target.targetType = \"Time\";\n      cvt.target.value = step.target.value * 1000 || 0;\n    } else if (step.action.actionType == EnumAction.Extract) {\n      cvt.action.actionType = \"Extract\";\n      cvt.action.power = step.action.power || 0;\n      cvt.target.targetType = \"Weight\";\n      cvt.target.value = step.target.value * mock || 0;\n    } else if (step.action.actionType == EnumAction.Grind) {\n      cvt.action.actionType = \"Grind\";\n      // cvt.action.power = step.action.power;\n      cvt.action.ingredient = step.action.ingredient || \"\";\n      cvt.action.canSkip = step.action.canSkip || false;\n      cvt.target.targetType = \"Weight\";\n      cvt.target.value = step.target.value * mock || 0;\n\n    } else if (step.action.actionType == EnumAction.PourOver) {\n      cvt.action.actionType = \"Pour\"\n      cvt.action.stepAmount = step.action.stepAmount\n      cvt.action.duration = step.action.duration * 1000\n      cvt.action.pumpPower = step.action.pumpPower\n      cvt.target.targetType = \"Weight\"\n      cvt.target.value = step.target.value * mock || 0\n    } else if (step.action.actionType == EnumAction.RGB) {\n      cvt.action.actionType = \"RGB\"\n      cvt.action.color = step.action.color\n      cvt.action.start = step.action.start\n      cvt.action.stop = step.action.stop\n\n\n      \n    } else if (step.action.actionType == EnumAction.Profile) {\n      cvt.action.actionType = \"Profile\";\n      cvt.action.segments = step.action.segments || [];\n      cvt.action.profilingType = step.action.profilingType;\n      cvt.target.targetType = \"Weight\";\n      cvt.target.value = step.target.value * mock || 0;\n      // loop through each segment, the duration must all be *1000 (miliseconds)\n      // clone the array\n      const clonedSegments = JSON.parse(JSON.stringify(cvt.action.segments));\n\n      // transform the smooth and timescale\n      const transformedSegments: any[] = []\n      for (const segment of clonedSegments) {\n        if (segment.smooth == false) {\n          console.log(\"add the smooth segments\")\n          transformedSegments.push({\n            duration: 1,\n            value: segment.value\n          })\n          transformedSegments.push({\n            duration: segment.duration * 1000,\n            value: segment.value\n          })\n        }\n        else {\n          transformedSegments.push({\n            duration: segment.duration * 1000,\n            value: segment.value\n          })\n        }\n      }\n\n\n\n      cvt.action.segments = transformedSegments;\n      console.log(\"segments\", transformedSegments);\n    }\n\n    // if (step.target.targetType == EnumTarget.Time) {\n    //   step.target.value = step.target.value * 1000\n    // }\n    // else if (step.target.targetType == EnumTarget.Weight) {\n    //   step.target.value *= 100\n    // }\n  }\n  return cvts;\n}\n\n\nexport async function cancelRunningFormula(groupId: number) {\n  await queryDevice({\n    command: \"group.cancel\",\n    groupId: groupId,\n  });\n}\n\nconst formulaClickQueue = {};\nconst groupRunningFormulaId = {}\nlet formulaClickQueueTimeout: ReturnType<typeof setTimeout>;\nexport function registerFormulaClick(formulaId: string) {\n  formulaClickQueue[formulaId] = formulaClickQueue[formulaId] || 0;\n  formulaClickQueue[formulaId] += 1;\n  clearTimeout(formulaClickQueueTimeout);\n  formulaClickQueueTimeout = setTimeout(async () => {\n    for (const key in formulaClickQueue) {\n      const groupId = formulaClickQueue[key];\n      const formulaId = key;\n      console.log(\n        \"provider/ registerFormulaClick\",\n        key,\n        formulaClickQueue[key],\n      );\n\n      groupRunningFormulaId[key] = groupId;\n\n      // clear the feedback of the current chart\n      (window as any).fbstore = [];\n\n      await runFormula({\n        formulaId: key,\n        groupId: formulaClickQueue[key],\n      });\n\n      delete formulaClickQueue[key];\n    }\n  }, 1000);\n}\n\nexport async function cancelFormulaClick(formulaId: string) {\n  console.log(\"provider/ cancelFormulaClick\", formulaId);\n  clearTimeout(formulaClickQueueTimeout);\n\n\n\n  setTimeout(async () => {\n    // await cancelRunningFormula(1);\n    // await cancelRunningFormula(2);\n\n    await cancelRunningFormula(groupRunningFormulaId[formulaId])\n    delete groupRunningFormulaId[formulaId]\n\n  });\n}\nexport async function downloadFormula({\n  groupId, buttonId, formulaId\n}: {\n  groupId: number\n  buttonId: number\n  formulaId: string\n}) {\n\n  const ctx = (window as any).ctx as typeof initialState\n  const steps = ctx.formulas[formulaId].steps;\n  const convertedSteps = convertSteps(steps);\n\n  const fm = JSON.parse(JSON.stringify(ctx.formulas[formulaId]))\n  fm.steps = convertedSteps\n  fm.buildupDuration *= 1000;\n  console.warn(\"Formula\");\n  console.warn(JSON.stringify(fm, null, 2));\n\n  await writeGroupFormula({\n    groupId,\n    buttonId,\n    formula: fm\n  })\n  await saveGroupFormula({ groupId, buttonId })\n}\n\n\nexport async function runFormula({\n  formulaId,\n  groupId,\n}: {\n  formulaId: string;\n  groupId: number;\n}) {\n  const ctx = (window as any).ctx as typeof initialState;\n  const steps = ctx.formulas[formulaId].steps;\n  if (groupId > 3 || groupId < 1) return;\n  // const steps = (JSON.parse(localStorage.getItem(formulaId)) as IStep[]) || [];\n\n  console.log(\n    `device/ run the formula, load from LS on GROUP ${groupId}`,\n    steps,\n  );\n\n  const convertedSteps = convertSteps(steps);\n  \n\n  console.log(\"device/ run the formula\");\n  console.log(JSON.stringify(convertedSteps, null, 2));\n\n  // clear the formulaFeedbacks\n  ctx.setFeedbacks(\n    produce(ctx.formulaFeedbacks, (draft) => {\n      draft[formulaId] = {};\n      return draft;\n    }),\n  );\n\n  await queryDevice({\n    command: \"group.cancel\",\n    groupId: groupId,\n  });\n\n\n\n\n  const fm = JSON.parse(JSON.stringify(ctx.formulas[formulaId]))\n  fm.buildupDuration *= 1000;\n  fm.steps = convertedSteps\n  fm.formulaId = formulaId;\n  console.warn(\"Formula\");\n  console.warn(JSON.stringify(fm, null, 2));\n\n\n\n\n\n  await queryDevice({\n    command: \"group.write\",\n    groupId: groupId,\n    buttonId: 0, // control button\n    formula: fm,\n  });\n\n  await queryDevice({\n    command: \"group.run\",\n    groupId: groupId,\n    buttonId: 0,\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 905, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 910, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { cancelFormulaClick, registerFormulaClick, downloadFormula } from \"@/gateway/formula\";\nimport { produce } from \"immer\";\nimport { useSelectedLanguage, useTranslation } from \"next-export-i18n\";\nimport { useRouter } from \"next/router\";\nimport { createContext, useEffect, useMemo, useState } from \"react\";\nimport { Layouts } from \"react-grid-layout\";\nimport { useEffectOnce, useLocalStorage } from \"usehooks-ts\";\nimport { EnumFormulaType } from \"./formula\";\nimport {\n  IGrinderState,\n  grinderInitialState,\n  setGrinderConfiguration,\n} from \"./grinder\";\nimport {\n  IPidDisplay,\n  IPidState,\n  PidSettingParameter,\n  syncPidStatus,\n  pidInitialDisplay,\n  pidInitialState,\n  setPidConfiguration,\n} from \"./pid\";\nimport { IProgressReport } from \"./progress\";\nimport { registerServiceWorker } from \"./service_worker\";\nimport { EnumTarget, IStep, IStepFeedback } from \"./step\";\nimport calibration, { setCalibration } from \"./calibration\";\n\nasync function sleep(ms: number) {\n  await new Promise((rs, _) => setTimeout(rs, ms));\n}\n\nexport function switchLocales(locale: string) {\n  console.log('switchLocales', locale)\n  // copied from next-export-i18n / LanguageSwitcher\n  window.localStorage.setItem(\"next-export-i18n-lang\", locale);\n  const event = new Event(\"localStorageLangChange\");\n  document.dispatchEvent(event);\n}\n\n// This dictionary holds the function references\nexport const initialState = {\n  calibration: {\n    flowmeter: new Array(3).fill(1),\n    grinder: new Array(3).fill(1),\n    pressure: new Array(4).fill(1.2)\n  },\n  setCalibration: (calibration: any) => { },\n\n\n\n  flowmeterDisplay: new Array(3).fill({\n    flowRate: 0,\n    flowCount: 0\n  }),\n  setFlowmeterDisplay: (flowmeterDisplay: any) => { },\n  flowCount: new Array(3).fill(0),\n  flowRate: new Array(3).fill(0),\n  pressure: new Array(4).fill(0),\n  setPressure: (pressure: number[]) => {},\n  connectButtonStyle: \"outline\",\n  connectButtonText: \"Connect\",\n  selectedPage: \"Formula\",\n  pidState: pidInitialState,\n  formulas: {} as Record<string, DisplayFormulaParam>,\n  setPidState: (pidState: IPidState[]) => { },\n  pidDisplay: pidInitialDisplay,\n  setPidDisplay: (pidState: IPidDisplay[]) => { },\n  connected: false,\n  grinderSettings: grinderInitialState,\n  setGrinderSettings: (grinderSettings: IGrinderState[]) => { },\n  setFlowCount: (flowCount: number[]) => { },\n  setFlowRate: (flowRate: number[]) => { },\n  registerFormulaClick: registerFormulaClick,\n  cancelFormulaClick: cancelFormulaClick,\n  downloadFormula: downloadFormula,\n  selectedFormulaId: \"\",\n  registerSelectedFormulaId: (formulaId: string) => { },\n  setFormulas: (formulas: Record<string, DisplayFormulaParam>) => { },\n  setLayout: (layout: Layouts) => { },\n  setSelectedPage: (page: string) => { },\n  layout: {} as Layouts,\n  // steps: [] as IStep[],\n  // setSteps: (steps: IStep[]) => {},\n  darkMode: false,\n  setDarkMode: (darkMode: boolean) => { },\n  language: \"en\",\n  setLanguage: (language: string) => { },\n  draggable: false,\n  setDraggable: (draggable: boolean) => { },\n\n  addFormulaOpen: false,\n  setAddFormulaOpen: (state: boolean) => { },\n  style: {\n    background: \"bg-white\",\n    hightlight: \"orange-800\",\n    primary: \"purple-800\",\n  },\n  setStyle: (style: any) => { },\n\n  progressReport: {} as Record<string, IProgressReport>,\n  setProgressReport: (progressReport: Record<string, IProgressReport>) => { },\n  formulaFeedbacks: {} as Record<string, Record<number, IStepFeedback>>,\n  formulaUpdatedTimestamp: {} as Record<string, number>,\n  setformulaUpdatedTimestamp: (formulaUpdatedTimestamp: Record<string, number>) => { },\n  setFeedbacks: (\n    formulaFeedbacks: Record<string, Record<number, IStepFeedback>>,\n  ) => { },\n\n\n  modalDisplay: false,\n  setModalDisplay: (modalDisplay: boolean) => { },\n\n  switchLocales: switchLocales,\n};\n\nlet updateFlag = {\n  pidState: false,\n  grinderState: false,\n  calibrationState: false\n};\nconst manageSync = async () => {\n  // const ctx = (window as any).ctx as typeof initialState;\n  const ctx = (window as any).ctx as typeof initialState;\n  if (updateFlag.pidState) {\n    updateFlag.pidState = false;\n    console.log(\"Update PID\", ctx.pidState);\n    for (var channel = 0; channel < 3; channel++) {\n      const pid = new PidSettingParameter({\n        proportional: ctx.pidState[channel].proportional,\n        integral: ctx.pidState[channel].integral,\n        derivative: ctx.pidState[channel].derivative,\n        targetTemperature: ctx.pidState[channel].targetTemperature,\n        activeRange: ctx.pidState[channel].activeRange,\n        isActive: ctx.pidState[channel].isActive,\n      });\n      console.log(\"sync/ pid query to device\", pid);\n      await setPidConfiguration({ channel, pid });\n    }\n  }\n  if (updateFlag.grinderState) {\n    updateFlag.grinderState = false;\n    console.log(\"topic/ update grinder settings\");\n    await setGrinderConfiguration();\n  }\n\n  if (updateFlag.calibrationState) {\n    updateFlag.calibrationState = false\n    console.log('topic/ update calibration settings')\n    await setCalibration({\n      flowmeter: ctx.calibration.flowmeter,\n      grinder: ctx.calibration.grinder,\n      temperature: [0, 0, 0]\n    })\n  }\n};\nconst managePull = async () => {\n  // handle the pulling of data, mostly the pid every 5 seconds to update the chart state\n\n  const ctx = (window as any).ctx as typeof initialState;\n  try {\n    for (var channel = 0; channel < 3; channel++) {\n      await syncPidStatus({ channel });\n    }\n  } catch (e) {\n    console.error(e);\n  }\n};\n\n// async function simulateFormulaClick(groupId: number, formulaId: string) {\n//   const ctx = (window as any).ctx as typeof initialState;\n//   // repeat 5 times\n//   ctx.setProgressReport(\n//     produce(ctx.progressReport, (draft: Record<string, IProgressReport>) => {\n//       draft[formulaId] = draft[formulaId] || ({} as IProgressReport);\n//       draft[formulaId].isRunning = true;\n//       return draft;\n//     }),\n//   );\n\n//   await sleep(5000);\n//   ctx.setProgressReport(\n//     produce(ctx.progressReport, (draft: Record<string, IProgressReport>) => {\n//       draft[formulaId] = draft[formulaId] || ({} as IProgressReport);\n//       draft[formulaId].isRunning = false;\n//       return draft;\n//     }),\n//   );\n// }\n\nexport const DeviceContext = createContext(initialState);\n\nexport type IFeedbackReport = {\n  // this is what device send to ui\n};\nexport function handleFeedback(data: any) {\n  console.log(\"Report/\", JSON.stringify(data, null, 2));\n  const ctx = (window as any).ctx as typeof initialState;\n\n  const { formulaId, stepId, target, action } = data as {\n    formulaId: string;\n    stepId: number;\n    target: {\n      type: EnumTarget;\n      total: number;\n      value: number;\n    };\n    action: {\n      profilingType: string;\n      expectedValue: number;\n      timestamp: number;\n      input: number;\n      output: number;\n    };\n  };\n  // const { type, total, value } = target;\n\n  if (data.command == \"rp.start\" && data.isLocal == true) {\n    ctx.setModalDisplay(true)\n    try {\n      (window as any).startMissionControl(data)\n\n    }\n    catch (e) {\n      console.error(e)\n    }\n\n  }\n  else if (data.command == \"rp.finish\") {\n    (window as any).finishMissionControl()\n    // setTimeout(() => {\n    //   ctx.setModalDisplay(false)\n\n    // }, 10000)\n  }\n  else if (data.command == \"rp.progress\") {\n    // update the progress locally\n    if (ctx.modalDisplay) {\n      // stream to mission control, don't set any feedbacks\n      \n      try {\n        (window as any).updateMissionControl(data)\n\n      }\n      catch (e) {\n        \n      }\n      return;\n    }\n  }\n\n\n  ctx.setformulaUpdatedTimestamp(produce(ctx.formulaUpdatedTimestamp, (draft) => {\n    draft[data.formulaId] = new Date().getTime()\n    return draft\n  }))\n\n  ctx.setFeedbacks(\n    produce(ctx.formulaFeedbacks, (draft) => {\n      // draft[formulaId][stepId].target = target\n      const formulaUpdate: Record<number, IStepFeedback> = draft[formulaId] || {};\n      draft[formulaId] = formulaUpdate;\n\n      // mofify the step of the formula update\n      formulaUpdate[stepId] = formulaUpdate[stepId] || ({} as IStepFeedback);\n      formulaUpdate[stepId].target = target;\n      formulaUpdate[stepId].action = action as IStepFeedback[\"action\"];\n\n\n      return draft;\n    }),\n  );\n  console.log(\"Update/ : Set formulaUpdatedTimestamp to \", data.formulaId)\n}\n\nexport type DisplayFormulaParam = {\n  id: string;\n  title: string;\n  text: string;\n  color: string;\n  backdrop: string;\n  formulaType: EnumFormulaType;\n  steps: IStep[];\n  buildupDuration: number;\n  lossyWeight: number; // amount of water that is lost, convertSteps will add this to the last step\n  maximumDuration: number;\n  isShared: boolean;\n  category: string;\n};\n\nexport function DeviceProvider({ children }) {\n  const { t } = useTranslation();\n  const [connectButtonStyle, setConnectButtonStyle] = useState(\n    initialState.connectButtonStyle,\n  );\n  const [connectButtonText, setConnectButtonText] = useState(t(\"Connect\"));\n  const [connected, setConnected] = useState(initialState.connected);\n  const [selectedFormulaId, registerSelectedFormulaId] =\n    useLocalStorage<string>(\"rapp-selectedFormulaId\", \"\");\n\n  const { lang } = useSelectedLanguage();\n  const [calibration, setCalibration] = useState(initialState.calibration)\n  const [formulaUpdatedTimestamp, setformulaUpdatedTimestamp] = useState(initialState.formulaUpdatedTimestamp)\n\n  useEffect(() => {\n    if (lang == \"en\" && !connected) {\n      setConnectButtonText(\"Connect\");\n    } else if (lang == \"vi\" && !connected) {\n      setConnectButtonText(\"Kết nối\");\n    }\n  }, [lang, connected]);\n\n  const [formulas, setFormulas] = useLocalStorage<\n    Record<string, DisplayFormulaParam>\n  >(\"rapp-fml\", {});\n\n  const [formulaFeedbacks, setFeedbacks] = useState<\n    Record<string, Record<number, IStepFeedback>>\n  >({});\n\n  const [layout, setLayout] = useLocalStorage<Layouts>(\"rapp-layout\", {});\n  // const { toast } = usseToast();\n  //   (window as any).toast = toast\n\n  const router = useRouter();\n  const pathMapping = {\n    \"/\": \"Formula\",\n    \"/lab\": \"Alchemy\",\n    \"/setting\": \"Setting\",\n  };\n  const initialSelectedPage = pathMapping[router.pathname];\n  console.log(`map/ set initialSelectedPage to ${initialSelectedPage}`);\n  const [selectedPage, setSelectedPage] = useState(initialSelectedPage);\n  const [pidState, setPidState] = useState<IPidState[]>(initialState.pidState);\n  const [pidDisplay, setPidDisplay] = useState<IPidDisplay[]>(\n    initialState.pidDisplay,\n  );\n  const [grinderSettings, setGrinderSettings] = useState<IGrinderState[]>(\n    initialState.grinderSettings,\n  );\n  const [darkMode, setDarkMode] = useLocalStorage<boolean>(\"darkMode\", false);\n  const [language, setLanguage] = useLocalStorage<string>(\"language\", \"en\");\n  const [draggable, setDraggable] = useState(\n    Object.entries(formulas).length == 0,\n  );\n  // const [steps, setSteps] = useState<IStep[]>([]);\n  const [style, setStyle] = useState(initialState.style);\n  const [flowCount, setFlowCount] = useState(initialState.flowCount);\n  const [flowRate, setFlowRate] = useState(initialState.flowRate);\n    const [pressure, setPressure] = useState(initialState.pressure)\n  const [flowmeterDisplay, setFlowmeterDisplay] = useState(initialState.flowmeterDisplay)\n\n  const [modalDisplay, setModalDisplay] = useState<boolean>(false);\n\n  const [addFormulaOpen, setAddFormulaOpen] = useState(false);\n  useEffect(() => {\n    if (darkMode) {\n      document.body.classList.add(\"dark\");\n    } else {\n      document.body.classList.remove(\"dark\");\n    }\n  }, [darkMode]);\n\n  const [progressReport, setProgressReport] = useState<\n    Record<string, IProgressReport>\n  >({});\n\n  // useEffect(() => {\n  //   manageSync({ ctx, connected });\n  // }, [connected]);\n\n  const value = useMemo(\n    () => ({\n      connectButtonStyle,\n      connectButtonText,\n      selectedPage,\n      pidState,\n      pidDisplay,\n      connected,\n      grinderSettings,\n      selectedFormulaId,\n      formulas,\n      layout,\n      calibration,\n      // steps,\n      darkMode,\n      language,\n      draggable,\n      style,\n      addFormulaOpen,\n      progressReport,\n      formulaFeedbacks,\n      flowmeterDisplay,\n      setformulaUpdatedTimestamp,\n      formulaUpdatedTimestamp,\n      modalDisplay,\n      setModalDisplay,\n      pressure, \n      setPressure\n\n    }),\n    [\n      grinderSettings,\n      connected,\n      connectButtonStyle,\n      connectButtonText,\n      selectedPage,\n      pidState,\n      pidDisplay,\n      selectedFormulaId,\n      formulas,\n      layout,\n      calibration,\n      // steps,\n      draggable,\n      language,\n      darkMode,\n      style,\n      addFormulaOpen,\n      progressReport,\n      formulaFeedbacks,\n      flowmeterDisplay,\n      setformulaUpdatedTimestamp,\n      formulaUpdatedTimestamp,\n      setModalDisplay,\n      modalDisplay,\n      pressure, \n      setPressure\n\n    ],\n  );\n\n  const setValue = useMemo(\n    () => ({\n      setConnected,\n      setConnectButtonStyle,\n      setConnectButtonText,\n      setSelectedPage,\n      setPidState,\n      setPidDisplay,\n      setGrinderSettings,\n      registerFormulaClick,\n      cancelFormulaClick,\n      downloadFormula,\n      registerSelectedFormulaId,\n      setLayout,\n      setFormulas,\n      setCalibration,\n      // setSteps,\n      setDarkMode,\n      setLanguage,\n      setDraggable,\n      setStyle,\n      setAddFormulaOpen,\n      setProgressReport,\n      setFeedbacks,\n      switchLocales,\n      setFlowCount,\n      setFlowRate,\n      setFlowmeterDisplay,\n    }),\n    [\n      setConnected,\n      setConnectButtonStyle,\n      setConnectButtonText,\n      setSelectedPage,\n      setPidState,\n      setPidDisplay,\n      setGrinderSettings,\n      registerSelectedFormulaId,\n      setLayout,\n      setFormulas,\n      // setSteps,\n      setDarkMode,\n      setLanguage,\n      setDraggable,\n      setStyle,\n      setAddFormulaOpen,\n      setProgressReport,\n      setFeedbacks,\n      setFlowCount,\n      setFlowRate,\n      setFlowmeterDisplay,\n    ],\n  );\n\n  const props = useMemo(() => ({ ...value, ...setValue }), [setValue, value]);\n\n  useEffect(() => {\n    (window as any).ctx = props;\n  }, [props]);\n\n  useEffect(() => {\n    updateFlag.pidState = true; // mark that pid is updated, so a sync will be pending\n  }, [pidState, setPidState]);\n\n  useEffect(() => {\n    updateFlag.calibrationState = true\n  }, [calibration])\n\n  useEffect(() => {\n    updateFlag.grinderState = true;\n  }, [grinderSettings, setGrinderSettings]);\n\n  useEffectOnce(() => {\n    // dont use useEffect, it will create 3 intervals\n    var win = (window as any)\n\n    if (win.syncInterval) clearInterval(win.syncInterval);\n    win.syncInterval = setInterval(async () => await manageSync(), 5000);\n\n\n    // create a private key\n\n\n    if (win.pullInterval) clearInterval(win.pullInterval);\n    win.pullInterval = setInterval(async () => await managePull(), 10000);\n\n    setTimeout(async () => {\n      await registerServiceWorker();\n    }, 1000);\n\n    window.addEventListener('keydown', (evt) => {\n      if (evt.ctrlKey) {\n        if (evt.key == 'k') {\n           setModalDisplay(true)\n        }\n       }\n     });\n\n\n  });\n\n  // Todo: fix later, too lzay\n  const contextValue = {\n    ...props,\n    flowCount: [],\n    flowRate: [],\n  };\n\n  return (\n    <DeviceContext.Provider value={contextValue}>{children}</DeviceContext.Provider>\n  );\n}\nexport default DeviceContext;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1367, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1372, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/event.ts"],"sourcesContent":["import { mailbox } from \"./connection\";\nimport { handleFeedback, initialState } from \"./provider\";\nimport { produce } from 'immer'\n// @refresh reset\n\n/**\n * Although most of the data transfer are JSON based dictionary\n * Some, for optimization, sent as number[], which is very compact, around 20 bytes\n *\n */\n\nexport class FlowmeterUpdateEvent {\n  flowmeter: number[];\n  flowrate: number[];\n  constructor(data: number[]) {\n    this.flowmeter = [data[0], data[2], data[4]];\n    this.flowrate = [data[1], data[3], data[5]];\n  }\n}\n\nexport class ButtonClickEvent {\n  groupId: number;\n  controlButton: boolean;\n  coffeeButtons: boolean[]; // 4 buttons\n  doseButton: boolean;\n\n  // if groupId == 0, use these\n  _waterButton: boolean;\n  _doseButton: boolean;\n  _warmerButton: boolean;\n\n  constructor(data: number[]) {\n    this.groupId = data[0] as number;\n    this.controlButton = !data[1];\n    this.coffeeButtons = [!data[2], !data[3], !data[4], !data[5]];\n    this.doseButton = !data[6];\n    // this._waterButton = !data[7];\n    // this._doseButton = !data[8];\n    // this._warmerButton = !data[9];\n  }\n}\n\nexport class ButtonBrightnessEvent {\n  groupId: number;\n  controlButton: number;\n  coffeeButtons: number[]; // 4 buttons\n  doseButton: number;\n  // if groupId == 0, use these\n  _waterButton: number;\n  _doseButton: number;\n  _warmerButton: number;\n\n  constructor(data: number[]) {\n    this.groupId = data[0] as number;\n    this.controlButton = data[1];\n    this.coffeeButtons = [data[2], data[3], data[4], data[5]];\n    this.doseButton = data[6];\n    // this._waterButton = data[7];\n    // this._doseButton = data[8];\n    // this._warmerButton = data[9];\n  }\n}\n\nexport class RelayUpdateEvent {\n  pump: number; // 0\n  group: boolean[]; // 1, 2, 3\n  refill: boolean; // 4\n  warmer: boolean; // 5\n  dose: boolean; // 6\n  boiler: boolean; // 7\n\n  constructor(data: number[]) {\n    this.pump = data[0];\n    this.group = [!!data[1], !!data[2], !!data[3]];\n    this.refill = !!data[4];\n    this.warmer = !!data[5];\n    this.dose = !!data[6];\n    this.boiler = !!data[7];\n  }\n}\n\nexport class PidUpdateEvent {\n  kp: number[];\n  ki: number[];\n  kd: number[];\n  taret: number[];\n  range: number[];\n  temperature: number[];\n  power: number[];\n\n  constructor(data: number[]) {}\n}\n\nexport class TerminalUpdateEvent {\n  message: string;\n  constructor(data: string) {\n    this.message = data;\n  }\n}\n\nexport type UpdateEvent =\n  | ButtonClickEvent\n  | ButtonBrightnessEvent\n  | RelayUpdateEvent\n  | PidUpdateEvent\n  | TerminalUpdateEvent\n  | FlowmeterUpdateEvent;\n\nexport class UnknownUpdateEvent {\n  data: number[];\n  constructor(data: number[]) {\n    this.data = data;\n  }\n}\n\ninterface ResponseQueryEvent {}\nenum EventType {\n  ButtonClick = 0xb0,\n  RelayUpdate = 0xb1,\n  FlowmeterUpdate = 0xb2,\n  PidUpdate = 0xb3,\n  ButtonBrightness = 0xb5,\n  TerminalUpdate = 0xb6,\n  ResponseQuery = 0xb7,\n}\n\nimport { Header } from \"./connection\";\nexport function interpretMessage(\n  header: Header,\n  data: number[] | { [key: string]: any },\n) {\n  console.debug(\"Interpreet\", data);\n\n  const ctx = (window as any).ctx as typeof initialState;\n\n  if (Array.isArray(data)) {\n    console.debug(\"Data is an array\");\n\n    const uuid = data[0];\n    const event = data[1];\n    const payload = data.slice(2);\n\n    if (event == EventType.ButtonClick) {\n      // updateState(new ButtonClickEvent(payload))\n    } else if (event == EventType.ButtonBrightness) {\n      // updateState(new ButtonBrightnessEvent(payload))\n    } else if (event == EventType.RelayUpdate) {\n      // updateState(new RelayUpdateEvent(payload))\n    } else if (event == EventType.PidUpdate) {\n      // updateState(new PidUpdateEvent(payload))\n    } else if (event == EventType.TerminalUpdate) {\n      // updateState(new TerminalUpdateEvent(payload as any))\n    } else if (event == EventType.FlowmeterUpdate) {\n      // updateState(new FlowmeterUpdateEvent(payload))\n      console.log('fm/ update', event, payload)\n      // this is an array of 8\n      // 0 is flowcount, 1 is flowrate and so on\n      // don't update state too fast\n\n\n      // ctx.setFlowCount(produce(ctx.flowCount, draft => {\n      //   draft = [\n      //     payload[0],\n      //     payload[2],\n      //     payload[4]\n      //   ]\n      //   return draft\n      // }))\n      // ctx.setFlowRate(\n      //   produce(ctx.flowRate, draft => {\n      //     draft = [\n      //       payload[1],\n      //       payload[3],\n      //       payload[5]\n      //     ]\n      //     return draft\n      //   }))\n\n      ctx.setFlowmeterDisplay(produce(ctx.flowmeterDisplay, draft => {\n        draft = [\n          {\n            flowCount: Math.round((payload[0] * ctx.calibration.flowmeter[0]) * 10) / 10,\n            flowRate: Math.round((payload[1] * ctx.calibration.flowmeter[0]) * 10) / 10\n          },\n          {\n            flowCount: Math.round((payload[2] * ctx.calibration.flowmeter[1]) * 10) / 10,\n            flowRate: Math.round((payload[3] * ctx.calibration.flowmeter[1]) * 10) / 10\n          },\n          {\n            flowCount: Math.round((payload[4] * ctx.calibration.flowmeter[2]) * 10) / 10,\n            flowRate: Math.round((payload[5] * ctx.calibration.flowmeter[2]) * 10) / 10\n          }\n        ]\n        return draft\n      }))\n\n    } else {\n      return new UnknownUpdateEvent(payload);\n    }\n  } else if (typeof data === \"object\") {\n    console.debug(\"Data is an object/dictionary\");\n    const id = data[\"id\"] as number;\n\n    if (mailbox.hasOwnProperty(id)) {\n      mailbox[id] = data;\n    }\n\n    if (data.command && data.command.startsWith(\"rp.\")) {\n      handleFeedback(data);\n    }\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1577, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1582, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/gateway/connection.ts"],"sourcesContent":["\"use client\";\n\nimport { decode, encode } from \"@msgpack/msgpack\";\nimport { interpretMessage } from \"./event\";\nimport { getGrinderConfiguration } from \"./grinder\";\nimport { syncPidConfigurationFromDevice } from \"./pid\";\nimport { initialState } from \"@/gateway/provider\";\nimport { produce } from \"immer\";\nimport { syncCalibrationFromDevice } from \"./calibration\";\n\nasync function sleep(ms: number) {\n  await new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n\nexport var isInitialized = false\n\nasync function initializeSync() {\n  console.log('initilizeSync')\n  // while the device is still connected, do the sync\n  //% load the pid state\n  const ctx = (window as any).ctx as typeof initialState\n\n  for (var channel = 0; channel < 3; channel++) {\n    await syncPidConfigurationFromDevice({ channel })\n  }\n\n  await syncCalibrationFromDevice()\n  isInitialized = true\n\n}\n\nexport function handleConnectButton() {\n  console.debug(\"State\", device);\n  if (device === null) {\n    requestDevice();\n  } else {\n    disconnectDevice();\n  }\n}\n\nexport interface Header {\n  isFinished: boolean;\n  isFirst: boolean;\n  isCompressed: boolean;\n  requireAck: boolean;\n  channel: number;\n  payloadLength: number;\n  frameType: number;\n}\n\nexport let device: BluetoothDevice | null = null;\nexport let charact: BluetoothRemoteGATTCharacteristic;\nexport let mtu: number = 20;\nexport let incomeBuffer: Uint8Array = new Uint8Array();\nexport let reconnectTimeout: ReturnType<typeof setTimeout>;\n\nexport async function connectDevice(device: BluetoothDevice) {\n  console.debug(\"gateway/ attempt to connect to device\");\n  if (device?.gatt == undefined) {\n    console.error(\"ble/ gatt doesn't exist\", device);\n    return;\n  }\n\n  await device.gatt.connect();\n  const rosarioService = await device.gatt.getPrimaryService(\n    \"0000ffe0-0000-1000-8000-00805f9b34fb\",\n  );\n  console.debug(\"ble/ rosarioService connected\", rosarioService);\n  charact = await rosarioService.getCharacteristic(\n    \"0000ee00-0000-1000-8000-00805f9b34fb\",\n  );\n  charact.addEventListener(\"characteristicvaluechanged\", (event: Event) => {\n    const recv = (event.target as BluetoothRemoteGATTCharacteristic).value;\n    if (recv == null) return;\n    decodeMessage(new Uint8Array(recv.buffer));\n  });\n  charact.startNotifications();\n  console.debug(\"ble/ general characteristic connected\", charact);\n\n  // read the mtu characteristic\n  const mtuCharact = await rosarioService.getCharacteristic(\n    \"0000ee01-0000-1000-8000-00805f9b34fb\",\n  );\n\n  // Convert DataView to int, LSB\n  mtu = (await mtuCharact.readValue()).getUint16(0, true);\n  if (mtu >= 500) {\n    mtu = 500;\n  }\n\n  const firmwareCharact = await rosarioService.getCharacteristic(\n    \"0000ee02-0000-1000-8000-00805f9b34fb\",\n  );\n\n  // Convert DataView to int, LSB\n  let firmwareVersion = 0;\n  firmwareVersion = (await firmwareCharact.readValue()).getUint16(0, true);\n\n  console.debug(\n    \"Connect device success\",\n    device.name,\n    \"fw:\",\n    firmwareVersion,\n    \"mtu:\",\n    mtu,\n  );\n\n  (window as any).ctx.setConnectButtonStyle(\"solid\");\n  (window as any).ctx.setConnectButtonText(\n    device.name?.replace(\"AnataLAB\", \"\") || \"Device\",\n  );\n  (window as any).ctx.setConnected(true);\n\n  setTimeout(async () => {\n    await initializeSync();\n  }, 2000);\n}\n\nexport function decodeMessage(data: Uint8Array) {\n  console.debug(\"/\");\n  // Get the first 4 bytes of data\n  const headerRaw = data.slice(0, 4);\n  const header = {\n    isFinished: headerRaw[0] & 0b00000001 ? true : false,\n    isFirst: headerRaw[0] & 0b00000010 ? true : false,\n    isCompressed: headerRaw[0] & 0b00000100 ? true : false,\n    requireAck: headerRaw[0] & 0b00001000 ? true : false,\n    channel: headerRaw[1],\n    payloadLength: headerRaw[3] + (headerRaw[2] << 8),\n    frameType: headerRaw[0] & 0b11110000, // this is reversed\n  };\n  const payload = data.slice(4);\n  console.debug(\"decodeMessage\", header, header.frameType);\n\n  if (header.frameType == 48) {\n    console.debug(\"ack signal received\");\n    mailbox[header.channel] = true;\n    return;\n  }\n\n  if (header.isFirst) {\n    incomeBuffer = new Uint8Array();\n  }\n  const currentBuffer = incomeBuffer;\n  incomeBuffer = new Uint8Array(currentBuffer.length + payload.length);\n  incomeBuffer.set(currentBuffer);\n  incomeBuffer.set(payload, currentBuffer.length);\n\n  if (header.isFinished) {\n    if (header.isCompressed) {\n      throw Error(\"not supported yet\");\n    }\n    /** @type {object} */\n\n    try {\n      const data = decode(incomeBuffer);\n      // console.debug(\"HandleIncome\", data, mailbox)\n      interpretMessage(header as Header, data as number[]);\n    } catch (e) {\n      console.warn(\"error decode\", e, incomeBuffer);\n    } finally {\n      incomeBuffer = new Uint8Array();\n    }\n  }\n}\nexport async function requestDevice() {\n  console.debug(\"gateway/ device requested\");\n  if (device != null) return;\n\n  device = await window.navigator.bluetooth.requestDevice({\n    filters: [{ namePrefix: \"AnataLAB\" }],\n    optionalServices: [\n      \"0000ffe1-0000-1000-8000-00805f9b34fb\",\n      \"0000ffe0-0000-1000-8000-00805f9b34fb\",\n    ],\n  });\n  if (!device) return;\n  device.addEventListener(\"gattserverdisconnected\", () => {\n\n  \n\n    location.reload()\n\n    isInitialized = false\n    console.debug(`ble/ disconnected`, \"Red\");\n    reconnectTimeout = setTimeout(async () => {\n      if (device) {\n        await connectDevice(device);\n      }\n    }, 10000);\n    (window as any).ctx.setConnectButtonStyle(\"outline\");\n    (window as any).ctx.setConnectButtonText(\"Retrying ...\");\n    (window as any).ctx.setConnected(false);\n  });\n  await connectDevice(device);\n}\nexport async function disconnectDevice() {\n  console.debug(\"gateway/ device disconnected\");\n  if (device == null) return;\n  clearTimeout(reconnectTimeout);\n  device.gatt?.disconnect();\n  device = null;\n\n  console.debug(\"CTX\", (window as any).ctx);\n  (window as any).ctx.setConnectButtonStyle(\"outline\");\n  (window as any).ctx.setConnectButtonText(\"Connect\");\n  (window as any).ctx.setConnected(false);\n}\n\nconst splitChunk = (arr: Uint8Array, size: number) =>\n  Array.from({ length: Math.ceil(arr.length / size) }, (v, i) =>\n    arr.slice(i * size, i * size + size),\n  );\n\nconst encodeMessage = (chunk: Uint8Array, header: Header) => {\n  // generate the 4 header flags, then combine it with the chunk\n  var headerByte = 0x00;\n  if (header.isFinished) {\n    headerByte = headerByte | 0b00000001;\n  }\n  if (header.isFirst) {\n    headerByte = headerByte | 0b00000010;\n  }\n  if (header.isCompressed) {\n    headerByte = headerByte | 0b00000100;\n  }\n  if (header.requireAck) {\n    headerByte = headerByte | 0b00001000;\n  }\n\n  const headers = new Uint8Array([\n    headerByte,\n    header.channel,\n    header.payloadLength / 256,\n    header.payloadLength % 256,\n  ]);\n\n  const finalized = new Uint8Array(headers.length + chunk.length);\n  finalized.set(headers);\n  finalized.set(chunk, headers.length);\n  return finalized;\n};\n\nfunction assignRandomId(): number {\n  (window as any).randomId = (window as any).randomId || 1;\n  (window as any).randomId += 1;\n  if ((window as any).randomId > 200) {\n    (window as any).randomId = 1;\n  }\n  return (window as any).randomId;\n}\n\nexport let mailbox = {};\n\nlet isSending = false;\nexport async function queryDevice(params: any) {\n  if (!(window as any).ctx.connected) return;\n  while (isSending) {\n    await sleep(10);\n  }\n  isSending = true;\n  /*\n        main point of contact between api and device\n        encode params, split to chunk, add the header and send\n        wait for mailbox for return\n        remember to set ack flag\n    */\n  try {\n    params.id = new Date().getTime();\n    const encoded = encode(params);\n    const chunks = splitChunk(encoded, mtu - 3);\n    console.debug(`splited into ${chunks.length} chunks`);\n\n    mailbox[params.id] = null;\n\n    for (var idx = 0; idx < chunks.length; idx++) {\n      const chunk = chunks[idx];\n      const selectedChannl = assignRandomId();\n      const signed = encodeMessage(chunk, {\n        isFinished: idx == chunks.length - 1,\n        isFirst: idx == 0,\n        isCompressed: false,\n        requireAck: true,\n        channel: selectedChannl,\n        payloadLength: chunk.length,\n        frameType: 0,\n      });\n      mailbox[selectedChannl] = null;\n      await charact.writeValue(signed);\n      let startTs = new Date().getTime();\n      while (new Date().getTime() - startTs < 3000) {\n        if (mailbox[selectedChannl] != null) {\n          break;\n        }\n        await sleep(1);\n      }\n      if (mailbox[selectedChannl] == null) {\n        throw new Error(\"no ack signal received !\");\n      }\n    }\n\n    // now we wait for response\n    let futureTs = new Date().getTime() + 5000;\n    while (mailbox[params.id] == null) {\n      await sleep(1);\n      if (new Date().getTime() > futureTs) {\n        throw new Error(\"no response received !\");\n      }\n    }\n\n    let response = mailbox[params.id];\n    delete mailbox[params.id];\n\n    console.debug(\"queryDevice\", { params, response });\n\n    return response;\n  } catch (e) {\n    return null;\n  } finally {\n    isSending = false;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1859, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1864, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/hooks/useDeviceContext.ts"],"sourcesContent":["import { useContext } from \"react\";\nimport { DeviceContext } from \"../gateway/provider\";\n\nconst useDeviceContext = () => {\n  return useContext(DeviceContext);\n};\n\nexport default useDeviceContext;\n"],"names":[],"mappings":";;;;;;;;;AAGA,MAAM,mBAAmB;;IACvB,OAAO;AACT;GAFM;uCAIS"}},
    {"offset": {"line": 1879, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1884, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/mission-control.tsx"],"sourcesContent":["'use client'\nimport {\n    LineChart,\n    Line,\n    XAxis,\n    YAxis,\n    CartesianGrid,\n    Tooltip,\n    Legend,\n    ReferenceLine,\n    ResponsiveContainer,\n    Label,\n    AreaChart,\n    Area,\n    ComposedChart,\n} from 'recharts';\n\nimport { produce } from 'immer'\n\nimport { useEffect, useState, useRef } from 'react'\nimport demo from \"../../public/432997820_1300659664171876_8586090559895363958_n.jpeg\"\nimport useDeviceContext from '@/hooks/useDeviceContext';\nimport { cn } from '@/util';\nimport { motion } from 'framer-motion'\n\nconst data = [\n    {\n        name: 'Page A',\n        uv: 4000,\n        pv: 2400,\n        amt: 2400,\n    },\n    {\n        name: 'Page B',\n        uv: 3000,\n        pv: 1398,\n        amt: 2210,\n    },\n    {\n        name: 'Page C',\n        uv: 2000,\n        pv: 9800,\n        amt: 2290,\n    },\n    {\n        name: 'Page D',\n        uv: 2780,\n        pv: 3908,\n        amt: 2000,\n    },\n    {\n        name: 'Page E',\n        uv: 1890,\n        pv: 4800,\n        amt: 2181,\n    },\n    {\n        name: 'Page F',\n        uv: 2390,\n        pv: 3800,\n        amt: 2500,\n    },\n    {\n        name: 'Page G',\n        uv: 3490,\n        pv: 4300,\n        amt: 2100,\n    },\n];\n\n\ntype MissionPoint = {\n    pressure: number\n    flowrate: number\n    power: number\n    weight: number\n    time: number\n}\n\nconst MissionControl = () => {\n\n\n    const timeout = useRef<ReturnType<typeof setTimeout>>()\n\n\n    const [data, setData] = useState<MissionPoint[]>([])\n    const startTimestamp = useRef<number>(0)\n\n    const { setModalDisplay } = useDeviceContext()\n\n\n    const [height, setHeight] = useState(0)\n    const [width, setWidth] = useState(0)\n\n\n    const [flip, setFlip] = useState(false)\n\n    const [missionStartTimestamp, setmissionStartTimestamp] = useState(0)\n    useEffect(() => {\n        window.addEventListener('resize', () => {\n            setFlip(window.innerHeight > window.innerWidth)\n        })\n    })\n\n    useEffect(() => {\n        setHeight(window.innerHeight)\n        setWidth(window.innerWidth)\n    }, [setHeight, setWidth])\n\n\n\n\n    useEffect(() => {\n\n        (window as any).startMissionControl = (e) => {\n            setmissionStartTimestamp(Date.now())\n            console.log(\"rp.start mission stasrt\")\n            setData([])\n\n        }\n\n\n        (window as any).updateMissionControl = (update: any) => {\n            console.log(\"mission/\", update, data)\n\n            const currentState: MissionPoint = {\n                pressure: update.pressure < 0.5 ? 0 : Math.round((update.pressure || 0) * 10) / 10,\n                flowrate: Math.round((update.flowrate || 0) * 10) / 10,\n                power: update.power,\n                weight: Math.round((update.flowcount || 0) * 10) / 10,\n                time: Math.round((Date.now() - missionStartTimestamp || 0) / 1000)\n            }\n\n            setData(produce(data, draft => {\n                draft.push(currentState)\n            }))\n\n\n        }\n\n        (window as any).finishMissionControl = () => {\n            const currentState: MissionPoint = {\n                pressure: 0,\n                flowrate: 0,\n                power: 0,\n                weight: 0,\n                time: Math.round((Date.now() - missionStartTimestamp || 0) / 1000)\n            }\n\n            // setData(produce(data, draft => {\n            //     draft.push(currentState)\n            // }))\n\n        }\n\n        // clear the values\n\n\n    })\n\n\n    return (\n        <motion.div\n            className={cn(\"w-full h-full overflow-clip  flex flex-col\")}\n            animate={{\n                rotate: flip ? 90 : 0\n            }}\n\n        >\n            <div className=\"flex flex-row h-20 mt-6 px-20 justify-between items-start\">\n                <div className=\"flex flex-col\">\n                    <h1 className=\"text-xl text-gray-300\">Time</h1>\n                    <h1 className=\"text-2xl text-black\">{(Math.round((Date.now() - missionStartTimestamp) / 100) / 10).toFixed(1) || 0} s</h1>\n                </div>\n                <div className=\"flex flex-col\">\n                    <h1 className=\"text-xl text-gray-300\">Weight</h1>\n                    <h1 className=\"text-2xl text-black\">{(data[data.length - 1]?.weight || 0).toFixed(1)} gram</h1>\n                </div>\n                <div className=\"flex flex-col\">\n                    <h1 className=\"text-xl text-gray-300\">Flowrate</h1>\n                    <h1 className=\"text-2xl text-black\">{(data[data.length -1]?.flowrate || 0).toFixed(1)} gram/s</h1>\n                </div>\n                <div className=\"flex flex-col\">\n                    <h1 className=\"text-xl text-gray-300\">Pressure</h1>\n                    <h1 className=\"text-2xl text-black\">{(data[data.length -1]?.pressure || 0).toFixed(1)} bar</h1>\n                </div>\n                <button\n                    className=\"bg-red-300 hover:bg-red-700 text-white font-bold py-2 px-4 rounded h-16\"\n                    onClick={() => {\n                        setModalDisplay(false)\n                    }}\n                >\n                    Close\n                </button>\n            </div>\n\n            <div className=\"w-full h-full\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <ComposedChart data={data}>\n                        <CartesianGrid strokeDasharray=\"3 3\" />\n\n                        <XAxis dataKey=\"time\" interval={40} padding={{ left: 30, right: 30 }} />\n\n\n\n                        <YAxis width={80} yAxisId=\"left\" tick={{ fontSize: 10 }} domain={[0, 12]}>\n                        </YAxis>\n                        <YAxis width={80} yAxisId=\"right\" orientation=\"right\" tick={{ fontSize: 10, }} domain={[0, 20]}>\n                        </YAxis>\n                        <Tooltip />\n                        <Legend />\n\n                        {/* <Area isAnimationActive={false} dot={false} type=\"monotone\" dataKey=\"weight\" yAxisId=\"right\" fill=\"#eeeeee\" fillOpacity={0.8} /> */}\n\n                        <Line isAnimationActive={false} dot={false} type=\"monotone\" dataKey=\"pressure\" yAxisId=\"left\" stroke=\"#8884d8\" activeDot={{ r: 8 }} strokeWidth={5} />\n                        <Line isAnimationActive={false} dot={false} type=\"monotone\" dataKey=\"flowrate\" yAxisId=\"right\" stroke=\"#00aeef\" strokeWidth={5} />\n                        <Line isAnimationActive={false} dot={false} type=\"monotone\" dataKey=\"power\" yAxisId=\"right\" stroke=\"#ff0000\" />\n                    </ComposedChart>\n                </ResponsiveContainer>\n\n                    </div>\n            {/* <img src={demo.src} alt=\"demo\" className=\"w-screen h-screen absolute\" /> */}\n\n        </motion.div>\n    );\n};\n\nexport default MissionControl;\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2289, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2294, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/ui/use-toast.ts"],"sourcesContent":["// Inspired by react-hot-toast library\nimport * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2447, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2452, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;;;;;AAGO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,mKAAQ,0IAAK;AACtB"}},
    {"offset": {"line": 2463, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2468, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/ui/toast.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAOA,MAAM,gBAAgB,8JAAgB,QAAQ;AAE9C,MAAM,8BAAgB,2HAAM,UAAU,MAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,8JAAgB,QAAQ;QACvB,KAAK;QACL,WAAW,sHACT,qIACA;QAED,GAAG,KAAK;;;;;;;AAGb,cAAc,WAAW,GAAG,8JAAgB,QAAQ,CAAC,WAAW;AAEhE,MAAM,gBAAgB,oKACpB,6lBACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,MAAM,sBAAQ,2HAAM,UAAU,OAI5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAO,EAAE;IACnC,qBACE,qJAAC,8JAAgB,IAAI;QACnB,KAAK;QACL,WAAW,sHAAG,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf;;AACA,MAAM,WAAW,GAAG,8JAAgB,IAAI,CAAC,WAAW;AAEpD,MAAM,4BAAc,2HAAM,UAAU,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,8JAAgB,MAAM;QACrB,KAAK;QACL,WAAW,sHACT,sgBACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8JAAgB,MAAM,CAAC,WAAW;AAE5D,MAAM,2BAAa,2HAAM,UAAU,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,8JAAgB,KAAK;QACpB,KAAK;QACL,WAAW,sHACT,yVACA;QAEF,eAAY;QACX,GAAG,KAAK;kBAET,cAAA;YAAG,WAAU;;;;;;;;;;;;AAGjB,WAAW,WAAW,GAAG,8JAAgB,KAAK,CAAC,WAAW;AAE1D,MAAM,2BAAa,2HAAM,UAAU,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,8JAAgB,KAAK;QACpB,KAAK;QACL,WAAW,sHAAG,yBAAyB;QACtC,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG,8JAAgB,KAAK,CAAC,WAAW;AAE1D,MAAM,iCAAmB,2HAAM,UAAU,QAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,8JAAgB,WAAW;QAC1B,KAAK;QACL,WAAW,sHAAG,sBAAsB;QACnC,GAAG,KAAK;;;;;;;AAGb,iBAAiB,WAAW,GAAG,8JAAgB,WAAW,CAAC,WAAW"}},
    {"offset": {"line": 2594, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2599, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/ui/toaster.tsx"],"sourcesContent":["import {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\nimport { useToast } from \"@/components/ui/use-toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAUO,SAAS;;IACd,MAAM,EAAE,MAAM,EAAE,GAAG;IAEnB,qBACE;;YACG,OAAO,GAAG,CAAC,SAAU,EAAE,EAAE,EAAE,KAAK,EAAE,WAAW,EAAE,MAAM,EAAE,GAAG,OAAO;gBAChE,qBACE;oBAAiB,GAAG,KAAK;;sCACvB,qJAAC;4BAAI,WAAU;;gCACZ,uBAAS;8CAAa;;;;;;gCACtB,6BACC;8CAAmB;;;;;;;;;;;;wBAGtB;sCACD;;;;;;mBARU;;;;;YAWhB;0BACA;;;;;;;;;;;AAGN;GAtBgB;;;;;KAAA"}},
    {"offset": {"line": 2675, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2680, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/ui/dialog.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAMA,MAAM,SAAS,+JAAgB,IAAI;AAEnC,MAAM,gBAAgB,+JAAgB,OAAO;AAE7C,MAAM,eAAe,+JAAgB,MAAM;AAE3C,MAAM,cAAc,+JAAgB,KAAK;AAEzC,MAAM,8BAAgB,2HAAM,UAAU,CAGpC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,+JAAgB,OAAO;QACtB,KAAK;QACL,WAAW,sHACT,2JACA;QAED,GAAG,KAAK;;;;;;KAVP;AAaN,cAAc,WAAW,GAAG,+JAAgB,OAAO,CAAC,WAAW;AAE/D,MAAM,8BAAgB,2HAAM,UAAU,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,qJAAC;;0BACC,qJAAC;;;;;0BACD,qJAAC,+JAAgB,OAAO;gBACtB,KAAK;gBACL,WAAW,sHACT,+fACA;gBAED,GAAG,KAAK;;oBAER;kCACD,qJAAC,+JAAgB,KAAK;wBAAC,WAAU;;0CAC/B;gCAAG,WAAU;;;;;;0CACb,qJAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,cAAc,WAAW,GAAG,+JAAgB,OAAO,CAAC,WAAW;AAE/D,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,qJAAC;QACC,WAAW,sHACT,sDACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,eAAe,CAAC,EACpB,SAAS,EACT,GAAG,OACkC,iBACrC,qJAAC;QACC,WAAW,sHACT,iEACA;QAED,GAAG,KAAK;;;;;;MATP;AAYN,aAAa,WAAW,GAAG;AAE3B,MAAM,4BAAc,2HAAM,UAAU,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,+JAAgB,KAAK;QACpB,KAAK;QACL,WAAW,sHACT,qDACA;QAED,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,+JAAgB,KAAK,CAAC,WAAW;AAE3D,MAAM,kCAAoB,2HAAM,UAAU,OAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,qJAAC,+JAAgB,WAAW;QAC1B,KAAK;QACL,WAAW,sHAAG,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,kBAAkB,WAAW,GAAG,+JAAgB,WAAW,CAAC,WAAW"}},
    {"offset": {"line": 2822, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 2839, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3058, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3067, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/assets/images/anatalab.png.mjs (structured image object)"],"sourcesContent":["import src from \"IMAGE\";\nexport default { src, width: 914, height: 562, blurDataURL: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAYAAAB4ka1VAAAAbUlEQVR42i3OLQ6AMAyG4W5TCBwShSDhN0EAwSC4A0dAgkBwBiyGE3BQ3i1d8qTt8mWriEiPyhjja4oMNRLRk1trF+fcR/8QfHFjZ3YhwDD6S/qTemHDymxDAAWvHPpFoyrEojt0mNBixoAS0Q9N3gnX7qWyngAAAABJRU5ErkJggg==\", blurWidth: 8, blurHeight: 5 }\n"],"names":[],"mappings":";;;;;;uCACe;IAAE,GAAG;IAAE,OAAO;IAAK,QAAQ;IAAK,aAAa;IAA0P,WAAW;IAAG,YAAY;AAAE"}},
    {"offset": {"line": 3081, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3086, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/navigation/TopNavigationBar.tsx"],"sourcesContent":["import VietCafeLogo from \"@/assets/images/vietcafe.jpeg\";\nimport AnataLABLogo from '@/assets/images/anatalab.png';\n\nimport { handleConnectButton } from \"@/gateway/connection\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport Image from \"next/image\";\nimport { useRouter } from \"next/router\";\nimport { FaPlus } from \"react-icons/fa6\";\nimport { IoLockClosedOutline, IoLockOpenOutline } from \"react-icons/io5\";\nimport {\n  MdBluetooth,\n  MdBluetoothConnected,\n  MdDarkMode,\n  MdOutlineWbSunny,\n} from \"react-icons/md\";\n\nimport { Popover, PopoverTrigger, PopoverContent } from \"@nextui-org/react\";\n\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuGroup,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuPortal,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\"\nimport { useDefaultMessages } from \"@buildo/bento-design-system\";\nimport { useTranslation } from \"next-export-i18n\";\nimport Lottie from 'react-lottie'\n\nimport lottieLotus from '@/assets/lottie/lotus.lottie.json'\nimport lottieEarth from '@/assets/lottie/earth.lottie.json'\nimport lottieCoffee from '@/assets/lottie/coffee.lottie.json'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n  DialogClose,\n  DialogFooter,\n} from \"@/components/ui/dialog\"\nimport { uuid } from \"uuidv4\";\n\nimport {\n  Button,\n  ModalContent,\n  ModalHeader,\n  ModalBody,\n  ModalFooter\n} from \"@nextui-org/react\";\nimport { Modal } from '@buildo/bento-design-system'\n\nimport { useState } from 'react'\nimport { produce } from 'immer'\nimport { EnumFormulaType } from \"@/gateway/formula\";\n\nexport function DropdownMenuDemo() {\n  const { setAddFormulaOpen } = useDeviceContext()\n  const { t } = useTranslation()\n\n  return (\n    <Popover placement=\"bottom-end\" color=\"primary\">\n      <PopoverTrigger>\n      </PopoverTrigger>\n      <PopoverContent>\n        <div className=\"flex flex-col\">\n          <button\n\n          >\n\n          </button>\n        </div>\n\n\n      </PopoverContent>\n\n\n    </Popover>\n  )\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n\n      </DropdownMenuTrigger>\n      <DropdownMenuContent className=\"w-56\">\n        <DropdownMenuLabel>{t(\"Add formula\")}</DropdownMenuLabel>\n        <DropdownMenuSeparator />\n        <DropdownMenuGroup>\n          <DropdownMenuItem>\n            {t(\"Explore community\")}\n            <DropdownMenuShortcut>⇧⌘P</DropdownMenuShortcut>\n          </DropdownMenuItem>\n          <DropdownMenuItem>\n            {t(\"Invent new formula\")}\n            <DropdownMenuShortcut>⌘B</DropdownMenuShortcut>\n          </DropdownMenuItem>\n          <DropdownMenuItem>\n            {t(\"\")}\n\n            <DropdownMenuShortcut>⌘S</DropdownMenuShortcut>\n          </DropdownMenuItem>\n          <DropdownMenuItem>\n            Keyboard shortcuts\n            <DropdownMenuShortcut>⌘K</DropdownMenuShortcut>\n          </DropdownMenuItem>\n        </DropdownMenuGroup>\n        <DropdownMenuSeparator />\n      </DropdownMenuContent>\n    </DropdownMenu>\n  )\n}\n\n\nconst TopNavigationBar = () => {\n  const {\n    connectButtonStyle,\n    connectButtonText,\n    selectedPage,\n    draggable,\n    setDraggable,\n    darkMode,\n    setDarkMode,\n    language,\n    setLanguage,\n    connected,\n    setAddFormulaOpen,\n  } = useDeviceContext();\n  const router = useRouter();\n\n  const [isOpen, setIsOpen] = useState(false);\n  const { t } = useTranslation()\n  const {\n    formulas, setFormulas, layout, setLayout\n  } = useDeviceContext()\n\n  async function addRandomFormula() {\n    const formulaId = uuid()\n    const randomColors = [\"#f44336\", \"#e91e63\", \"#9c27b0\", \"#673ab7\", \"#3f51b5\", \"#2196f3\", \"#03a9f4\", \"#00bcd4\", \"#009688\", \"#4caf50\", \"#8bc34a\", \"#cddc39\", \"#ffeb3b\", \"#ffc107\", \"#ff9800\", \"#ff5722\", \"#795548\", \"#607d8b\"]\n    const color = randomColors[Math.floor(Math.random() * randomColors.length)]\n\n\n    setLayout (\n      produce(layout, draft => {\n        draft[\"md\"]?.push({ i: formulaId, x: 0, y: 0, w: 1, h: 1 });\n        draft[\"xs\"]?.push({ i: formulaId, x: 0, y: 0, w: 1, h: 1 });\n        draft[\"sm\"]?.push({ i: formulaId, x: 0, y: 0, w: 1, h: 1 });\n\n      })\n    )\n\n    setFormulas(\n      produce(formulas, draft => {\n        const formula = {\n          id: formulaId,\n          title: \"\",\n          text: \"\",\n          color: color,\n          backdrop: \"gray\", // deprecated\n          formulaType: EnumFormulaType.Espresso,\n          steps: [],\n          buildupDuration: 0,\n          lossyWeight: 0,\n          maximumDuration: 0,\n          isShared: false,\n          category: \"\"\n        }\n\n        draft[formulaId] = formula\n\n\n      })\n    )\n  }\n\n\n\n  const fns = [\n    {\n      key: \"community\",\n      onClick: () => { },\n      title: \"From Community\",\n      text: \"Explore the shared formula from people around the world !\",\n      animationData: lottieEarth,\n    },\n\n    {\n      key: \"token\",\n      onClick: () => { },\n      title: \"From Token\",\n      text: \"Load from a SHARE code!\",\n      animationData: lottieLotus,\n    },\n\n    {\n      key: \"invent\",\n      onClick: async () => {\n        // setAddFormulaOpen(true)\n\n        // just invent by add a new shit in, let user edit inside lab view, smart\n\n        await addRandomFormula()\n\n      },\n      title: \"Let's Invent\",\n      text: \"Create new formula now !\",\n      animationData: lottieCoffee,\n    },\n\n  ]\n\n\n  const imageButtons = fns.map((fn) => (\n    <button\n      key={fn.key}\n      onClick={() => {\n        setIsOpen(false)\n        fn.onClick()\n      }}\n      className=\"flex items-center justify-between h-20 w-full bg-transparent hover:bg-blue-500 text-black  hover:text-white py-2 px-4  hover:border-transparent rounded-xl \"\n    >\n      {/* <img src=\"/path/to/image.png\" alt=\"Icon\" className=\"w-8 h-8\" /> */}\n      <Lottie\n        options={{\n          loop: true,\n          autoplay: true,\n          animationData: fn.animationData,\n          rendererSettings: {\n            preserveAspectRatio: 'xMidYMid slice'\n          }\n        }}\n        height={80}\n        width={80}\n      />\n\n      <span className=\"flex-1 text-left ml-4\">\n        <div className=\"text-lg font-bold\">{fn.title}</div>\n        <div className=\"text-sm \">{fn.text}</div>\n      </span>\n    </button>\n  ))\n\n\n  return (\n    <>\n\n      <div className=\"fixed z-10 flex w-full items-center justify-between bg-transparent p-2 backdrop-blur-[20px]\">\n        <div\n          className=\"logo overflow-hidden \"\n          onClick={() => {\n            router.push(\"/\");\n          }}\n        >\n          <Image src={AnataLABLogo} alt=\"AnataLAB Logo\" width={80} />\n        </div>\n\n        <div className=\"flex h-[48px] flex-row items-center justify-evenly space-x-1\">\n          {router.pathname == \"/\" && (\n            <>\n              {draggable && (\n                <Dialog>\n                  <DialogTrigger>\n\n                    <div\n                      className={`flex h-[48px] w-[48px] cursor-pointer items-center  justify-center rounded-xl border border-dashed border-black p-1 `}\n                      onClick={() => {\n                        // setDraggable(!draggable);\n                        setIsOpen(true)\n\n                      }}\n                    >\n                      <FaPlus className=\"text-black\" />{\" \"}\n                    </div>\n\n                  </DialogTrigger>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogDescription>\n                      </DialogDescription>\n                    </DialogHeader>\n                    <DialogFooter>\n                      <DialogClose asChild>\n                        <div className=\"flex flex-col space-y-6\">\n                          {imageButtons}\n\n                        </div>\n\n                      </DialogClose>\n                    </DialogFooter>\n                  </DialogContent>\n                </Dialog>\n              )}\n              <div\n                className={`flex h-[48px] w-[48px] cursor-pointer  items-center justify-center rounded-xl border border-black p-1 ${draggable ? \"bg-black\" : \"\"\n                  }`}\n                onClick={() => {\n                  setDraggable(!draggable);\n                }}\n              >\n                {draggable ? (\n                  <IoLockOpenOutline className=\"text-white\" />\n                ) : (\n                  <IoLockClosedOutline className=\"text-black\" />\n                )}\n              </div>\n            </>\n          )}\n          <div\n            className={`flex h-[48px] w-[48px] cursor-pointer  items-center justify-center rounded-xl border border-black p-1 ${darkMode ? \"bg-black\" : \"\"\n              }`}\n            onClick={() => {\n              setDarkMode(!darkMode);\n            }}\n          >\n            {darkMode ? (\n              <MdDarkMode className=\"text-white\" />\n            ) : (\n              <MdOutlineWbSunny className=\"text-black\" />\n            )}\n          </div>\n\n          <div\n            // className={`border border-black  p-1 rounded-xl  h-[48px] w-fit flex justify-center items-center cursor-pointer ${\n            //   darkMode ? \"bg-black\" : \"\"\n            // }`}\n\n            className={`flex h-[48px] w-fit cursor-pointer flex-row items-center justify-center space-x-2 rounded-xl border border-black p-3   ${connected ? \"bg-black\" : \"\"\n              }`}\n            onClick={() => {\n              handleConnectButton();\n            }}\n          >\n            {connected ? (\n              <MdBluetoothConnected className=\"text-white\" />\n            ) : (\n              <MdBluetooth className=\"text-black\" />\n            )}\n            <h1\n              className={`${connected ? \"text-white\" : \"text-black\"\n                } select-none text-black`}\n            >\n              {connectButtonText}\n            </h1>\n          </div>\n\n          {/* \n        <Button\n          label={connectButtonText}\n          hierarchy=\"primary\"\n          icon={() => {\n            return <MdBluetooth />;\n          }}\n          onPress={() => {\n            handleConnectButton();\n          }}\n          kind={connectButtonStyle as \"solid\" | \"outline\"}\n        /> */}\n        </div>\n      </div>\n    </>);\n};\nexport default TopNavigationBar;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3660, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3665, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/navigation/BottomNavigationBar.tsx"],"sourcesContent":["\"use client\";\n\nimport { Button } from \"@buildo/bento-design-system\";\nimport { BiSolidCoffeeAlt } from \"react-icons/bi\";\nimport { IoIosSettings } from \"react-icons/io\";\n\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { useSelectedLanguage, useTranslation } from \"next-export-i18n\";\nimport { useRouter } from \"next/router\";\nimport { MdLanguage } from \"react-icons/md\";\nimport { cn } from \"@/util\";\n\n\n\nconst LanguagePicker = () => {\n  const { switchLocales } = useDeviceContext();\n  const { lang } = useSelectedLanguage();\n  return (\n    <div\n      className=\"absolute bottom-0 right-0 m-1 flex cursor-pointer flex-row items-center space-x-2 rounded-xl border p-4 hover:text-purple-900 select-none\"\n      onClick={() => {\n        const current = localStorage.getItem(\"next-export-i18n-lang\");\n\n        if (current == \"en\") {\n          console.log('switch language to vi')\n          switchLocales(\"vi\");\n        } else {\n          console.log('switch language to en')\n\n          switchLocales(\"en\");\n        }\n      }}\n    >\n      <MdLanguage size={16} />\n      {/* <h3 className=\"\">{lang == \"en\" ? \"Tiếng Việt\" : \"English\"}</h3> */}\n    </div>\n  );\n};\n\nconst BottomNavigationBar = () => {\n  const router = useRouter();\n  const { selectedPage, setSelectedPage } = useDeviceContext();\n\n  const { t, locales } = useTranslation();\n\n  return (\n    <div\n      className=\"fixed bottom-0 z-50 flex h-14 w-full justify-center bg-white\"\n      style={{\n        boxShadow: \"1px -3px 5px 0px rgba(0,0,0,0.19)\",\n      }}\n    >\n      <LanguagePicker />\n      <div>\n        <div className=\"flex flex-row  items-center justify-between\">\n          {router.pathname == \"/lab\" ? (\n            <div\n              className=\"cursor-pointer flex-row items-center space-x-2 rounded-xl p-4\"\n              onClick={() => {\n                // setSelectedPage(\"Settings\");\n                if (router.pathname == \"/lab\") {\n                  router.push(\"/\");\n                }\n              }}\n            >\n              <h1 className=\"text-xl font-bold dark:text-white\">\n                {router.pathname == \"/lab\" ? t(\"◀ Back\") : selectedPage}\n              </h1>\n            </div>\n          ) : (\n            <div className=\"flex p cursor-pointer items-center space-x-8   p-4\">\n                <button className={cn(\n                  \"flex items-center space-x-2 \",\n                  selectedPage === \"Formula\" ? \"text-black\": \"text-gray-300\"\n                )}\n                  onClick={() => {\n                    setSelectedPage(\"Formula\");\n                    router.push(\"/\");\n\n                  }}\n                >\n                  <BiSolidCoffeeAlt />\n                  <h1>{t(\"Formula\")}</h1>\n\n                </button>\n                \n                <button className={cn(\n                  \"flex items-center space-x-2 \",\n                  selectedPage === \"Setting\" ? \"text-black\": \"text-gray-300\"\n                )}\n                  onClick={() => {\n                    setSelectedPage(\"Setting\");\n                    router.push(\"/setting\");\n\n                  }}\n                >\n                  <IoIosSettings />\n                  <h1>{t(\"Setting\")}</h1>\n\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default BottomNavigationBar;\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;;;;;AAcA,MAAM,iBAAiB;;IACrB,MAAM,EAAE,aAAa,EAAE,GAAG;IAC1B,MAAM,EAAE,IAAI,EAAE,GAAG;IACjB,qBACE,qJAAC;QACC,WAAU;QACV,SAAS;YACP,MAAM,UAAU,aAAa,OAAO,CAAC;YAErC,IAAI,WAAW,MAAM;gBACnB,QAAQ,GAAG,CAAC;gBACZ,cAAc;YAChB,OAAO;gBACL,QAAQ,GAAG,CAAC;gBAEZ,cAAc;YAChB;QACF;kBAEA,cAAA;YAAY,MAAM;;;;;;;;;;;AAIxB;GAvBM;;;;;;KAAA;AAyBN,MAAM,sBAAsB;;IAC1B,MAAM,SAAS;IACf,MAAM,EAAE,YAAY,EAAE,eAAe,EAAE,GAAG;IAE1C,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,GAAG;IAEvB,qBACE,qJAAC;QACC,WAAU;QACV,OAAO;YACL,WAAW;QACb;;0BAEA,qJAAC;;;;;0BACD,qJAAC;0BACC,cAAA,qJAAC;oBAAI,WAAU;8BACZ,OAAO,QAAQ,IAAI,uBAClB,qJAAC;wBACC,WAAU;wBACV,SAAS;4BACP,+BAA+B;4BAC/B,IAAI,OAAO,QAAQ,IAAI,QAAQ;gCAC7B,OAAO,IAAI,CAAC;4BACd;wBACF;kCAEA,cAAA,qJAAC;4BAAG,WAAU;sCACX,OAAO,QAAQ,IAAI,SAAS,EAAE,YAAY;;;;;;;;;;6CAI/C,qJAAC;wBAAI,WAAU;;0CACX,qJAAC;gCAAO,WAAW,8GACjB,gCACA,iBAAiB,YAAY,eAAc;gCAE3C,SAAS;oCACP,gBAAgB;oCAChB,OAAO,IAAI,CAAC;gCAEd;;kDAEA;;;;;kDACA,qJAAC;kDAAI,EAAE;;;;;;;;;;;;0CAIT,qJAAC;gCAAO,WAAW,8GACjB,gCACA,iBAAiB,YAAY,eAAc;gCAE3C,SAAS;oCACP,gBAAgB;oCAChB,OAAO,IAAI,CAAC;gCAEd;;kDAEA;;;;;kDACA,qJAAC;kDAAI,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASzB;IAnEM;;;;;;;MAAA;uCAoES"}},
    {"offset": {"line": 3850, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3855, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/pages/layout.tsx"],"sourcesContent":["'use client'\n\nimport BottomNavigationBar from \"@/components/navigation/BottomNavigationBar\";\nimport TopNavigationBar from \"@/components/navigation/TopNavigationBar\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { Stack } from \"@buildo/bento-design-system\";\nimport { FollowerPointerCard } from \"@/components/ui/following-pointer\";\nimport { Modal } from '@buildo/bento-design-system'\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport MissionControl from \"@/components/mission-control\";\nimport { Metadata } from 'next';\n\n// export const metadata: Metadata = {\n//   title: 'ROSARIO',\n//   description: 'Fine-tuning coffee experience',\n// };\n\nconst Layout = ({ children }) => {\n  const { modalDisplay, setModalDisplay } = useDeviceContext();\n\n\n  return (\n    <>\n      <Stack space={4}>\n        <TopNavigationBar />\n        <div className=\"mt-[58px] overflow-auto\" style={{ height: 'calc(100vh - 100px)' }}>\n          {\n            modalDisplay ? (<MissionControl />) : children\n          }</div>\n        <Toaster />\n\n        <BottomNavigationBar />\n      </Stack>\n\n\n    </>\n  )\n\n};\n\nexport default Layout;\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;;;;AAYA,sCAAsC;AACtC,sBAAsB;AACtB,kDAAkD;AAClD,KAAK;AAEL,MAAM,SAAS,CAAC,EAAE,QAAQ,EAAE;;IAC1B,MAAM,EAAE,YAAY,EAAE,eAAe,EAAE,GAAG;IAG1C,qBACE;kBACE,cAAA;YAAO,OAAO;;8BACZ;;;;;8BACA,qJAAC;oBAAI,WAAU;oBAA0B,OAAO;wBAAE,QAAQ;oBAAsB;8BAE5E,6BAAgB;;;;+BAAsB;;;;;;8BAE1C;;;;;8BAEA;;;;;;;;;;;;AAOR;GArBM;;;;;KAAA;uCAuBS"}},
    {"offset": {"line": 3934, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3939, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/ui/separator.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n"],"names":[],"mappings":";;;;;;;;;;;;AAKA,MAAM,0BAAY,2HAAM,UAAU,MAIhC,CACE,EAAE,SAAS,EAAE,cAAc,YAAY,EAAE,aAAa,IAAI,EAAE,GAAG,OAAO,EACtE,oBAEA,qJAAC,kKAAmB,IAAI;QACtB,KAAK;QACL,YAAY;QACZ,aAAa;QACb,WAAW,sHACT,sBACA,gBAAgB,eAAe,mBAAmB,kBAClD;QAED,GAAG,KAAK;;;;;;;AAIf,UAAU,WAAW,GAAG,kKAAmB,IAAI,CAAC,WAAW"}},
    {"offset": {"line": 3968, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 3973, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/ColorRune.tsx"],"sourcesContent":["import { CirclePicker } from 'react-color'\nimport {\n    Modal\n} from '@buildo/bento-design-system'\nimport { useTranslation } from 'next-export-i18n';\n\nimport { useState } from 'react'\nimport useDeviceContext from '@/hooks/useDeviceContext';\nimport { produce } from 'immer'\nimport { IRGBParam } from '@/gateway/step';\n\n\nexport const ColorRune = ({ index }: { index: number }) => {\n    /**\n     * This function displays the input text as normal text, but word by word so it will wrap around.\n     * @param {string} text - The text to be displayed.\n    */\n    \n    const [colorModal, setColorModal] = useState(false)\n    const { t } = useTranslation()\n    const { formulas, setFormulas, selectedFormulaId } = useDeviceContext()\n    const step = formulas[selectedFormulaId].steps[index];\n    const action = step.action as IRGBParam;\n\n\n    return (\n        <>\n            {colorModal && (\n                <Modal\n                size=\"small\"\n                autoFocus={false}\n                title={t(\"Set color\")}\n                onClose={() => setColorModal(false)}\n                primaryAction={{\n                    label: t(\"OK\"),\n                    onPress: async () => {\n                        setColorModal(false)\n\n                    },\n                }}\n                secondaryAction={{\n                    label: t(\"Cancel\"),\n                    onPress: () => setColorModal(false),\n                }}\n            >\n                <div className=\"flex items-center justify-center w-full h-full p-4\">\n                    <CirclePicker\n                        className='m-4'\n                        color={action.color || \"#00aeef\"}\n                        onChange={(color: any, e: any) => {\n                            // setFormulas(produce(formulas, draft => {\n                            //     if (!formulas[selectedFormulaId]) return;\n                            //     formulas[selectedFormulaId]. = color.hex\n                            // }))\n                            console.log(\"set to colr \", color)\n\n\n                            setFormulas(produce(formulas, (draft) => {\n                                // draft[selectedFormulaId].steps[index].target.value = e;\n                                \n                                var action = draft[selectedFormulaId].steps[index].action as IRGBParam\n                                action.color = color.hex\n                                action.start = 0\n                                action.stop = 0\n                            }))\n\n\n                        }}\n                    />\n                </div>\n            </Modal>\n            )}\n            <button className=\"ml-2 h-8 w-8  rounded-xl  ring-1 ring-white \"\n                style={{\n                    backgroundColor: action.color || \"#000000\"\n                }}\n                onClick={() => {\n                    setColorModal(true)\n                }}\n            ></button>\n\n        </>\n    );\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAYO,MAAM,YAAY,CAAC,EAAE,KAAK,EAAqB;;IAClD;;;IAGA,GAEA,MAAM,CAAC,YAAY,cAAc,GAAG,uIAAS;IAC7C,MAAM,EAAE,CAAC,EAAE,GAAG;IACd,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,iBAAiB,EAAE,GAAG;IACrD,MAAM,OAAO,QAAQ,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM;IACrD,MAAM,SAAS,KAAK,MAAM;IAG1B,qBACI;;YACK,4BACG;gBACA,MAAK;gBACL,WAAW;gBACX,OAAO,EAAE;gBACT,SAAS,IAAM,cAAc;gBAC7B,eAAe;oBACX,OAAO,EAAE;oBACT,SAAS;wBACL,cAAc;oBAElB;gBACJ;gBACA,iBAAiB;oBACb,OAAO,EAAE;oBACT,SAAS,IAAM,cAAc;gBACjC;0BAEA,cAAA,qJAAC;oBAAI,WAAU;8BACX,cAAA;wBACI,WAAU;wBACV,OAAO,OAAO,KAAK,IAAI;wBACvB,UAAU,CAAC,OAAY;4BACnB,2CAA2C;4BAC3C,gDAAgD;4BAChD,+CAA+C;4BAC/C,MAAM;4BACN,QAAQ,GAAG,CAAC,gBAAgB;4BAG5B,YAAY,+IAAQ,UAAU,CAAC;gCAC3B,0DAA0D;gCAE1D,IAAI,SAAS,KAAK,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM;gCACzD,OAAO,KAAK,GAAG,MAAM,GAAG;gCACxB,OAAO,KAAK,GAAG;gCACf,OAAO,IAAI,GAAG;4BAClB;wBAGJ;;;;;;;;;;;;;;;;0BAKZ,qJAAC;gBAAO,WAAU;gBACd,OAAO;oBACH,iBAAiB,OAAO,KAAK,IAAI;gBACrC;gBACA,SAAS;oBACL,cAAc;gBAClB;;;;;;;;AAKhB;GAvEa;;;;;;KAAA"}},
    {"offset": {"line": 4080, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4085, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/WeightRune.tsx"],"sourcesContent":["import { EnumTarget, IPourOverParam } from \"@/gateway/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { Banner, Modal, SliderField, Stack, NumberField , Column, Columns} from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { useTranslation } from \"next-export-i18n\";\n\nexport function WeightRune({\n  // value,\n  //   onChange,\n  // progress,\n  subIndex = -1,\n  index,\n}: {\n  // value: number;\n  // onChange: Dispatch<SetStateAction<number>>;\n  // progress: number;\n  subIndex: number;\n  index: number;\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId, formulaFeedbacks } =\n    useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n  const [weight, setWeight] = useState<number>(subIndex == -1 ? \n    step.target.value : (step.action as IPourOverParam).stepAmount || 0  \n  );\n\n  const [current, setCurrent] = useState<number>(0);\n  const { t } = useTranslation()\n\n\n\n  /*\n      Progress doesn't always show up, it will disappear after 5 seconds\n      So after 5 seconds, it must be clear to null\n      So the number has its own internal state\n  */\n\n  useEffect(() => {\n    const updated =\n      formulaFeedbacks[selectedFormulaId]?.[index]?.target?.value || 0;\n    setCurrent(updated * 10);\n  }, [formulaFeedbacks, index, selectedFormulaId]);\n\n  let timeout = useRef(null);\n\n  // useEffect(() => {\n  //   setCurrent(progress);\n\n  //   clearTimeout(timeout.current)\n  //   timeout.current = setTimeout(() => {\n  //     setCurrent(null)\n  //   }, 5000)\n  //   console.log(\"Progress is updated for weight\", progress)\n  // }, [progress])\n\n  function handleChangeAction() {\n    setFormulas(\n      produce(formulas, (draft) => {\n        if (subIndex == -1) {\n          draft[selectedFormulaId].steps[index].target.targetType =\n            EnumTarget.Weight;\n          draft[selectedFormulaId].steps[index].target.value = weight;\n\n        }\n        else {\n          const action = step.action as IPourOverParam\n          action.stepAmount = weight\n        }\n      }),\n    );\n  }\n\n  return (\n    <>\n      {current != null  && current > 0 && (\n        <h1\n          className=\" text-xl font-bold text-green-800\"\n          onClick={() => setIsOpen(true)}\n        >\n          {`${(current / 10).toFixed(1)}/`}\n        </h1>\n      )}\n\n      <h1\n        className=\" text-xl font-bold text-blue-800\"\n        onClick={() => setIsOpen(true)}\n      >\n        {weight.toFixed(1)}\n        {weight <= 1 ? \" gram\" : \" grams\"}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title={t(\"How much ?\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              handleChangeAction();\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Columns space={4} align=\"center\">\n              <Column width={\"4/5\"}>\n                <SliderField\n                  type=\"single\"\n                name=\"weight\"\n                value={weight}\n                onChange={setWeight}\n                label=\"Weight\"\n                minValue={0}\n                maxValue={500}\n                step={1}\n                />\n                </Column>\n              <Column width={\"1/5\"}>\n              <NumberField\n                value={weight}\n                onChange={setWeight}\n                label=\"Weight\"\n                minValue={0}\n                maxValue={500}\n                step={1}\n              />\n              </Column>\n            </Columns>\n            <Banner\n              kind=\"informative\"\n              title=\"Reminder\"\n              description={t(\"Calibration is required for accurate weight, please go to Settings\")}\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAOO,SAAS,WAAW,EACzB,SAAS;AACT,cAAc;AACd,YAAY;AACZ,WAAW,CAAC,CAAC,EACb,KAAK,EAON;;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,uIAAS;IACrC,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,iBAAiB,EAAE,gBAAgB,EAAE,GAClE;IACF,MAAM,OAAO,QAAQ,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM;IACrD,MAAM,CAAC,QAAQ,UAAU,GAAG,uIAAiB,YAAY,CAAC,IACxD,KAAK,MAAM,CAAC,KAAK,GAAG,AAAC,KAAK,MAAM,CAAoB,UAAU,IAAI;IAGpE,MAAM,CAAC,SAAS,WAAW,GAAG,uIAAiB;IAC/C,MAAM,EAAE,CAAC,EAAE,GAAG;IAId;;;;EAIA,GAEA,wIAAU;QACR,MAAM,UACJ,gBAAgB,CAAC,kBAAkB,EAAE,CAAC,MAAM,EAAE,QAAQ,SAAS;QACjE,WAAW,UAAU;IACvB,GAAG;QAAC;QAAkB;QAAO;KAAkB;IAE/C,IAAI,UAAU,qIAAO;IAErB,oBAAoB;IACpB,0BAA0B;IAE1B,kCAAkC;IAClC,yCAAyC;IACzC,uBAAuB;IACvB,aAAa;IACb,4DAA4D;IAC5D,iBAAiB;IAEjB,SAAS;QACP,YACE,+IAAQ,UAAU,CAAC;YACjB,IAAI,YAAY,CAAC,GAAG;gBAClB,KAAK,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,GACrD,iIAAW,MAAM;gBACnB,KAAK,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,GAAG;YAEvD,OACK;gBACH,MAAM,SAAS,KAAK,MAAM;gBAC1B,OAAO,UAAU,GAAG;YACtB;QACF;IAEJ;IAEA,qBACE;;YACG,WAAW,QAAS,UAAU,mBAC7B,qJAAC;gBACC,WAAU;gBACV,SAAS,IAAM,UAAU;0BAExB,CAAC,EAAE,CAAC,UAAU,EAAE,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;;;;;;0BAIpC,qJAAC;gBACC,WAAU;gBACV,SAAS,IAAM,UAAU;;oBAExB,OAAO,OAAO,CAAC;oBACf,UAAU,IAAI,UAAU;;;;;;;YAE1B,wBACC;gBACE,MAAK;gBACL,OAAO,EAAE;gBACT,SAAS,IAAM,UAAU;gBACzB,eAAe;oBACb,OAAO;oBACP,SAAS;wBACP,UAAU;wBACV;oBACF;gBACF;gBACA,iBAAiB;oBACf,OAAO;oBACP,SAAS,IAAM,UAAU;gBAC3B;0BAEA,cAAA;oBAAO,OAAO;;sCACZ;4BAAS,OAAO;4BAAG,OAAM;;8CACvB;oCAAQ,OAAO;8CACb,cAAA;wCACE,MAAK;wCACP,MAAK;wCACL,OAAO;wCACP,UAAU;wCACV,OAAM;wCACN,UAAU;wCACV,UAAU;wCACV,MAAM;;;;;;;;;;;8CAGR;oCAAQ,OAAO;8CACf,cAAA;wCACE,OAAO;wCACP,UAAU;wCACV,OAAM;wCACN,UAAU;wCACV,UAAU;wCACV,MAAM;;;;;;;;;;;;;;;;;sCAIV;4BACE,MAAK;4BACL,OAAM;4BACN,aAAa,EAAE;;;;;;;;;;;;;;;;;;;AAO7B;GAzIgB;;;;;;KAAA"}},
    {"offset": {"line": 4277, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4282, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/ui/popover.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAKA,MAAM,UAAU,gKAAiB,IAAI;AAErC,MAAM,iBAAiB,gKAAiB,OAAO;AAE/C,MAAM,+BAAiB,2HAAM,UAAU,MAGrC,CAAC,EAAE,SAAS,EAAE,QAAQ,QAAQ,EAAE,aAAa,CAAC,EAAE,GAAG,OAAO,EAAE,oBAC5D,qJAAC,gKAAiB,MAAM;kBACtB,cAAA,qJAAC,gKAAiB,OAAO;YACvB,KAAK;YACL,OAAO;YACP,YAAY;YACZ,WAAW,sHACT,8aACA;YAED,GAAG,KAAK;;;;;;;;;;;;AAIf,eAAe,WAAW,GAAG,gKAAiB,OAAO,CAAC,WAAW"}},
    {"offset": {"line": 4321, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4326, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/TimeRune.tsx"],"sourcesContent":["import {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { IPourOverParam, IProfileParam } from \"@/gateway/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { SliderField, Columns, Column, Inline, NumberField, Banner, Modal, Stack } from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useTranslation } from \"next-export-i18n\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { IoIosCloseCircle } from \"react-icons/io\";\nimport { Step } from '../../../gateway/step';\n\nexport function TimeRune({\n  // value,\n  //   onChange,\n  // progress\n  index,\n  subIndex = -1, \n\n  /*\n    subIndex = -1 is for something\n    subIndex = -2 is for PourOver\n  */\n}: {\n  // value: number;\n  //       onChange: Dispatch<SetStateAction<number>>;\n  //      progress:  number;\n  index: number;\n  subIndex: number;\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [current, setCurrent] = useState<number>(-1);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const { formulaFeedbacks } = useDeviceContext();\n  const [active, setActive] = useState(false);\n\n  const step = formulas[selectedFormulaId].steps[index];\n\n  const [time, setTime] = useState<number>(\n    subIndex == -1\n      ? step.target.value\n      : subIndex == -2\n        ? (step.action as IPourOverParam).duration || 0\n        : (step.action as IProfileParam).segments[subIndex]?.duration || 0,\n  );\n\n  /*\n    Progress doesn't always show up, it will disappear after 5 seconds\n    So after 5 seconds, it must be clear to null\n    So the number has its own internal state\n  */\n\n  let timeout = useRef<ReturnType<typeof setTimeout>>();\n\n\n  useEffect(() => {\n    const updated = subIndex == -1\n      ? step.target.value\n      : subIndex == -2\n        ? (step.action as IPourOverParam).duration || 0\n        : (step.action as IProfileParam).segments[subIndex]?.duration || 0;\n\n    if (updated != current) {\n      setTime(updated);\n      setActive(true);\n\n      clearTimeout(timeout.current);\n      timeout.current = setTimeout(() => {\n        setActive(false);\n      }, 1000);\n    }\n  }, [formulas, selectedFormulaId, index, subIndex, step, current]);\n\n  useEffect(() => {\n    const updated = formulaFeedbacks[selectedFormulaId]?.[index]?.target?.value;\n    // if you have subIndex, there nis no need to update progress, handled by the line chart already, more visual\n    if (subIndex == -1) {\n      setCurrent(updated || -1);\n    }\n  }, [formulaFeedbacks, index, selectedFormulaId, subIndex]);\n  const { t } = useTranslation();\n\n  function handleChangeAction() {\n    setFormulas(\n      produce(formulas, (draft) => {\n        if (subIndex == -1) {\n          draft[selectedFormulaId].steps[index].target.value = time;\n        } else if (subIndex == -2) {\n          (draft[selectedFormulaId].steps[index].action as IPourOverParam).duration = time\n        } else {\n          const action = step.action as IProfileParam;\n          action.segments[subIndex].duration = time;\n        }\n      }),\n    );\n  }\n\n  return (\n    <>\n      {current != null && current > 0&& (\n        <h1\n          className=\" text-xl font-bold text-green-800\"\n          onClick={() => setIsOpen(true)}\n        >\n          {`${(current / 1000).toFixed(1)}/`}\n        </h1>\n      )}\n      \n      <h1\n        className=\" text-xl font-bold text-blue-800\"\n        onClick={() => setIsOpen(true)}\n      >\n        {time.toFixed(1)}\n        \n        {\" \" + (time <= 1 ? t(\"second\") : t(\"seconds\"))}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title={t(\"How long?\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: t(\"OK\"),\n            onPress: () => {\n              setIsOpen(false);\n              handleChangeAction();\n            },\n          }}\n          secondaryAction={{\n            label: t(\"Cancel\"),\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Columns space={4} align=\"center\">\n              <Column width={\"4/5\"}>\n                <SliderField\n                  type=\"single\"\n                  name=\"time\"\n                  value={time}\n                  onChange={setTime}\n                  label={t('Time')}\n                  minValue={0}\n                  maxValue={120}\n                  step={1}\n                />\n              </Column>\n              <Column width={\"1/5\"}>\n                <NumberField\n                  value={time}\n                  onChange={setTime}\n                  label={t('Time')}\n                  minValue={0}\n                  maxValue={500}\n                  step={1}\n                />\n              </Column>\n            </Columns>\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n\n\n  return (\n    <Popover\n      onOpenChange={(e) => {\n        setIsOpen(e != false);\n      }}\n      open={isOpen}\n    >\n      <PopoverTrigger>\n        <div\n          className=\"flex h-8 w-fit items-center justify-between rounded-lg p-2\"\n          onClick={() => {\n            setIsOpen(true);\n          }}\n        >\n          {current != -1 && (\n            <h1\n              className=\" text-xl font-bold text-green-800\"\n              onClick={() => setIsOpen(true)}\n            >\n              {`${(current / 1000).toFixed(1)}/`}\n            </h1>\n          )}\n\n          <h1 className=\" text-xl font-bold text-blue-800\">\n            {time} {time <= 1 ? t(\"second\") : t(\"seconds\")}\n          </h1>\n        </div>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80 space-y-8 rounded-xl  border\">\n        <IoIosCloseCircle\n          className=\"absolute right-2 top-2 text-gray-500\"\n          size={20}\n          onClick={() => {\n            setIsOpen(false);\n          }}\n        />\n\n        <SliderField\n          value={time}\n          onChange={(e: number) => {\n            setTime(e);\n            setFormulas(\n              produce(formulas, (draft) => {\n                // draft[selectedFormulaId].steps[index].target.value = e;\n                if (subIndex == -1) {\n                  draft[selectedFormulaId].steps[index].target.value = e;\n                } else {\n                  const action = step.action as IProfileParam;\n                  action.segments[subIndex].duration = e;\n                }\n              }),\n            );\n          }}\n          label={t(\"Time\")}\n          type=\"single\"\n          name=\"value\"\n          minValue={0}\n          maxValue={60}\n          step={1}\n        />\n      </PopoverContent>\n    </Popover>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4622, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4627, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/TextRune.tsx"],"sourcesContent":["export const TextRune = ({ text }: { text: string }) => {\n  /**\n   * This function displays the input text as normal text, but word by word so it will wrap around.\n   * @param {string} text - The text to be displayed.\n   */\n  return (\n    <>\n      {text.split(\" \").map((word, index) => (\n        <h1 key={index} className=\"mx-1 text-xl text-gray-900\">\n          {word}\n        </h1>\n      ))}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;;AAAO,MAAM,WAAW,CAAC,EAAE,IAAI,EAAoB;IACjD;;;GAGC,GACD,qBACE;kBACG,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,MAAM,sBAC1B,qJAAC;gBAAe,WAAU;0BACvB;eADM;;;;;;AAMjB;KAda"}},
    {"offset": {"line": 4651, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4656, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/PumpRune.tsx"],"sourcesContent":["import { Banner, Modal, SliderField, Stack, NumberField, Columns, Column } from \"@buildo/bento-design-system\";\nimport { Dispatch, SetStateAction, useState } from \"react\";\nimport { useEffectOnce } from \"usehooks-ts\";\nimport { useTranslation } from \"next-export-i18n\";\n\nexport const PumpRune = ({\n  value,\n  onChange,\n}: {\n  value: number;\n  onChange: Dispatch<SetStateAction<number>>;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [power, setPower] = useState<number>(value == null ? 100 : value);\n\n  useEffectOnce(() => {\n    onChange(power)\n  })\n  const {t} = useTranslation()\n\n  return (\n    <>\n      <div\n        className=\"flex h-8 w-fit items-center justify-between rounded-lg p-2\"\n        onClick={() => {\n          setIsOpen(true);\n        }}\n      >\n        <h1 className=\"text-xl font-bold text-blue-800\">{value === null ? 100 : value} %</h1>\n      </div>\n\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title={t(\"Set pump power\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              console.log(\" update power\", power);\n              onChange(power);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Columns space={4} align=\"center\">\n              <Column width={\"4/5\"}>\n                <SliderField\n                  type=\"single\"\n                  name=\"power\"\n                  value={power}\n                  onChange={(e: number) => {\n                    console.log(\"Power is updated for pump\", e);\n                    setPower(e);\n                  }}\n                  label={t(\"Pump Power\")}\n                  minValue={0}\n                  maxValue={100}\n                  step={1}\n                />\n              </Column>\n              <Column width={\"1/5\"}>\n                <NumberField\n                  value={power}\n                  onChange={setPower}\n                  onBlur={() => console.log(\"blur\")}\n                  label={t(\"\")}\n                  \n                  minValue={0}\n                  maxValue={100}\n                  step={1}\n                />\n              </Column>\n            </Columns>\n\n            <Banner\n              kind=\"informative\"\n              title={t(\"Notice\")}\n              description={t(\"Power require an external hardware to be connected to the machine, other wise it is simply ON/OFF\")}\n              action={{\n                label: \"Learn more\",\n                onPress: () => {\n                  window.open(\"https://www.google.com\");\n                },\n              }}\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAKO,MAAM,WAAW,CAAC,EACvB,KAAK,EACL,QAAQ,EAIT;;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,uIAAS;IACrC,MAAM,CAAC,OAAO,SAAS,GAAG,uIAAiB,SAAS,OAAO,MAAM;IAEjE,6LAAc;QACZ,SAAS;IACX;IACA,MAAM,EAAC,CAAC,EAAC,GAAG;IAEZ,qBACE;;0BACE,qJAAC;gBACC,WAAU;gBACV,SAAS;oBACP,UAAU;gBACZ;0BAEA,cAAA,qJAAC;oBAAG,WAAU;;wBAAmC,UAAU,OAAO,MAAM;wBAAM;;;;;;;;;;;;YAG/E,wBACC;gBACE,MAAK;gBACL,OAAO,EAAE;gBACT,SAAS,IAAM,UAAU;gBACzB,eAAe;oBACb,OAAO;oBACP,SAAS;wBACP,UAAU;wBACV,QAAQ,GAAG,CAAC,iBAAiB;wBAC7B,SAAS;oBACX;gBACF;gBACA,iBAAiB;oBACf,OAAO;oBACP,SAAS,IAAM,UAAU;gBAC3B;0BAEA,cAAA;oBAAO,OAAO;;sCACZ;4BAAS,OAAO;4BAAG,OAAM;;8CACvB;oCAAQ,OAAO;8CACb,cAAA;wCACE,MAAK;wCACL,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC;4CACT,QAAQ,GAAG,CAAC,6BAA6B;4CACzC,SAAS;wCACX;wCACA,OAAO,EAAE;wCACT,UAAU;wCACV,UAAU;wCACV,MAAM;;;;;;;;;;;8CAGV;oCAAQ,OAAO;8CACb,cAAA;wCACE,OAAO;wCACP,UAAU;wCACV,QAAQ,IAAM,QAAQ,GAAG,CAAC;wCAC1B,OAAO,EAAE;wCAET,UAAU;wCACV,UAAU;wCACV,MAAM;;;;;;;;;;;;;;;;;sCAKZ;4BACE,MAAK;4BACL,OAAO,EAAE;4BACT,aAAa,EAAE;4BACf,QAAQ;gCACN,OAAO;gCACP,SAAS;oCACP,OAAO,IAAI,CAAC;gCACd;4BACF;;;;;;;;;;;;;;;;;;;AAOd;GA3Fa;;;;;;KAAA"}},
    {"offset": {"line": 4820, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 4825, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/ProfileRune.tsx"],"sourcesContent":["// @refresh reset\n\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  EnumAction,\n  EnumProfileType,\n  IProfileParam,\n  IProfilingSegment,\n  IStepFeedback,\n} from \"@/gateway/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport {\n  Banner,\n  Button,\n  NumberField,\n  Column, Columns, Modal,\n  LineChart,\n  SliderField,\n  Stack,\n  Tiles,\n} from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useTranslation } from \"next-export-i18n\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { FaMinus, FaPlus } from \"react-icons/fa6\";\nimport { IoIosCloseCircle } from \"react-icons/io\";\nimport { useEffectOnce } from \"usehooks-ts\";\nimport { TextRune } from \"./TextRune\";\nimport { TimeRune } from \"./TimeRune\";\n\ntype PressureDtps = {\n  timestamp: number;\n  min: number;\n  max: number;\n  pressure?: number;\n  flowrate?: number;\n};\ntype FlowrateDtps = {\n  timestamp: number;\n  // flowrate: number;\n  min: number;\n  max: number;\n  pressure?: number;\n  flowrate?: number;\n};\ntype PowerDtps = {\n  timestamp: number;\n  power: number;\n  min: number;\n  max: number;\n  pressure?: number;\n  flowrate?: number;\n};\n\nexport type DataPoint = PressureDtps | FlowrateDtps | PowerDtps;\n\nconst generateDatapoints = (\n  segments: IProfilingSegment[],\n  sensor: EnumProfileType,\n  formulaFeedbacks?: IStepFeedback[\"action\"][],\n) => {\n  if (segments === undefined) return [];\n\n  const dps: DataPoint[] = [];\n  // for each segments, we add a new point\n  let totalTime = 0;\n  segments.forEach((segment) => {\n    totalTime += segment.duration;\n  });\n\n  var startTime = 0;\n  var previousValue = 0;\n  for (const segment of segments) {\n    if (segment.smooth == false) {\n      console.log(\"smooth is real\")\n      // add an additional step\n      if (sensor == EnumProfileType.Pressure) {\n        dps.push({\n          timestamp: startTime,\npressure: segment.value,\n          min: 0,\n          max: 11,\n        })\n      }\n      else if (sensor == EnumProfileType.Flowrate) {\n        dps.push({\n          timestamp: startTime,\n          flowrate: segment.value,\n          min: 0,\n          max: 51,\n        })\n      }\n      else if (sensor == EnumProfileType.Power) {\n        dps.push({\n          timestamp: startTime,\n          power: segment.value,\n          min: 0,\n          max: 101,\n        })\n      }\n      previousValue = segment.value\n    }\n\n\n\n    for (var time = 0; time < segment.duration; time += 1) {\n      var interimValue =\n        previousValue +\n        (segment.value - previousValue) * (time / segment.duration);\n      interimValue = Math.round(interimValue * 10) / 10;\n      if (sensor == EnumProfileType.Pressure) {\n        dps.push({\n          timestamp: startTime + time,\npressure: interimValue,\n          max: 10,\n          min: 0,\n          // time: timestamp\n        });\n      } else if (sensor == EnumProfileType.Flowrate) {\n        dps.push({\n          timestamp: startTime + time,\n          flowrate: interimValue,\n          max: 50,\n          min: 0,\n          // time: timestamp\n        });\n      } else if (sensor == EnumProfileType.Power) {\n        dps.push({\n          timestamp: startTime + time,\n          power: interimValue,\n          max: 100,\n          min: 0,\n          // time: timestamp\n        });\n      }\n    }\n    previousValue = segment.value;\n    startTime += segment.duration;\n  }\n  return dps;\n};\nexport const RenderedSegment = ({\n  // segments,\n  // // setSegments,\n  // sensor,\n  index,\n}: {\n  // segments: IProfilingSegment[];\n  // sensor: EnumProfileType;\n  index: number;\n  // setSegments: Dispatch<SetStateAction<IProfilingSegment[]>>;\n}) => {\n  useEffectOnce(() => {\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const action = draft[index].action as IProfileParam\n    //     action.actionType = \"Profile\";\n\n    //     action.segments = action.segments || [];\n\n    //     console.log(\"profile/ create object\", action)\n    //     if ((draft[index].action as IProfileParam).segments.length == 0) {\n    //       (draft[index].action as IProfileParam).segments = [\n    //         {\n    //           duration: 10,\n    //           value: 3,\n    //         },\n    //       ];\n    //     }\n    //     return draft\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index].action as IProfileParam;\n        action.actionType = \"Profile\";\n\n        action.segments = action.segments || [];\n\n        console.log(\"profile/ create object\", action);\n        if (action.segments.length == 0) {\n          action.segments = [\n            {\n              duration: 10,\n              value: 3,\n              smooth: false,\n            },\n          ];\n        }\n        return draft;\n      }),\n    );\n  });\n\n  // const [renderedSegments, setRenderedSegments] = useState<JSX.Element[]>([]);\n\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const { t } = useTranslation();\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam;\n\n  const renderedSegments = (action.segments || []).map((segment, idx) => {\n    return (\n      <div className=\"flex-rol flex flex-wrap\" key={idx}>\n        {idx == 0 ? (\n          <TextRune text={t(\"First,\")} />\n        ) : (\n          <TextRune text={t(\"then\")} />\n        )}\n        <SegmentModeRune index={index} subIndex={idx} />\n\n        <ProfileValueRune index={index} subIndex={idx} />\n\n        {action.segments[idx].smooth ? (\n          <TextRune text={t(\"within\")} />\n\n        ) : (\n          <TextRune text={t(\"for\")} />\n\n        )}\n\n        <TimeRune\n          // progress={segments[idx].duration}\n          // value={segments[idx].duration}\n          // onChange={(e: number) => {\n          //   setSteps(\n          //     produce(steps, (draft) => {\n          //       const action = draft[index].action as IProfileParam;\n          //       action.segments[idx].duration = e;\n          //     })\n          //   );\n          // }}\n          index={index}\n          subIndex={idx}\n        />\n        <h1 className=\"text-xl\">\n          {idx === action.segments.length - 1 ? \".\" : \",\"}\n        </h1>\n      </div>\n    );\n  });\n\n  /**\n   *  Render segments in text readable format\n   *  First, extract with 9 bar for 2 seconds, then slowly turn to 1 bar for 5 seconds, then\n   *\n   * then is a button ?\n   *\n   *  */\n\n  /* \n    Click Add -> First, reaching [pressure] of [9bar] withing [10 seconds] [+]\n    Click Add -> First, reaching [pressure] of [9bar] withing [10 seconds], then, 2 bar within 2 seconds, then 3 bar whithin 20s\n  */\n  const addSegment = () => {\n    // setSegments(\n    //   produce(segments, (draft: IProfilingSegment[]) => {\n    //     // draft.push({\n    //     //   duration: 5,\n    //     //   value: 3\n    //     // })\n    //     draft.push({\n    //       duration: Math.floor(Math.random() * 30),\n    //       value: +(Math.random() * (10 - 2) + 2).toFixed(1),\n    //     });\n    //   })\n    // );\n\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const action = draft[index].action as IProfileParam;\n    //     action.segments.push({\n    //       duration: Math.floor(Math.random() * 30),\n    //       value: +(Math.random() * (10 - 2) + 2).toFixed(1),\n    //     });\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index]\n          .action as IProfileParam;\n        action.segments = action.segments || [];\n        action.segments.push({\n          duration: Math.floor(Math.random() * 30),\n          value: +(Math.random() * (10 - 2) + 2).toFixed(1),\n          smooth: false,\n        });\n      }),\n    );\n  };\n  const removeSegment = () => {\n    // console.log(\"remove segment\", { segments });\n    // if (segments.length > 1) {\n    //   // setSegments(\n    //   //   produce(segments, (draft) => {\n    //   //     draft.splice(-1);\n    //   //   })\n    //   // );\n    // }\n    if (action.segments === undefined) return;\n    if (action.segments.length < 2) return;\n\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const action = draft[index].action as IProfileParam;\n    //     action.segments.pop();\n    //     return draft;\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index]\n          .action as IProfileParam;\n        action.segments.pop();\n        return draft;\n      }),\n    );\n  };\n  return (\n    <>\n      <Separator />\n      <ul>{renderedSegments}</ul>\n      <div className=\"flex h-10 w-fit cursor-pointer  flex-row items-center space-x-6 rounded-md bg-blue-100 p-2 transition-transform duration-200 border\">\n        <FaPlus color=\"#00aeef\" size={20} onClick={addSegment} />\n        <FaMinus color=\"#ff0000\" size={20} onClick={removeSegment} />\n      </div>\n    </>\n  );\n};\n\nexport const SegmentModeRune = ({\n  index,\n  subIndex = -1,\n}: {\n  index: number;\n  subIndex: number;\n}) => {\n\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext()\n  const step = formulas[selectedFormulaId].steps[index]\n  const { t } = useTranslation()\n\n\n  function handleSwap() {\n    setFormulas(produce(formulas, (draft) => {\n      (draft[selectedFormulaId].steps[index].action as IProfileParam).segments[subIndex].smooth = !(draft[selectedFormulaId].steps[index].action as IProfileParam).segments[subIndex].smooth\n    }))\n\n  }\n\n\n  /*\n    add reaching up or down\n    it need to have access to value of previous segment only\n  */\n  var previousValue = 0\n  if (subIndex > 0) {\n    previousValue = (step.action as IProfileParam).segments[subIndex - 1].value\n  }\n\n  var isUpward = previousValue < (step.action as IProfileParam).segments[subIndex].value\n  \n\n\n  return <>\n    <h1\n      className=\"text-xl font-bold text-orange-900\"\n      onClick={handleSwap}\n    >\n      {/* {step.action.actionType || \"Action\"} */}\n      {(step.action as IProfileParam).segments[subIndex].smooth ? (\n        isUpward ? t(\"slowly reaching up\") : t(\"slowly reaching down\")\n      ) : (t(\"hold at\"))}\n    </h1>\n  </>\n}\n\nexport const MagicLine = ({\n  // segments,\n  // sensor,\n  index,\n}: {\n  index: number;\n  // segments: IProfilingSegment[];\n  // sensor: EnumProfileType;\n}) => {\n  const [dataPoints, setDataPoints] = useState<DataPoint[]>([]);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const { formulaFeedbacks } = useDeviceContext();\n\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam;\n  const sensor = action.profilingType;\n  const segments = action.segments;\n\n  const fbstore = useRef<IStepFeedback[\"action\"][]>([]);\n\n  useEffect(() => {\n    try {\n      const actionUpdate = formulaFeedbacks[selectedFormulaId][index]?.action as IStepFeedback[\"action\"];\n\n      if (!actionUpdate) {\n        console.warn(\"No update from profileRune\")\n        return;\n      }\n      // when ever formulaFeedbacks are updated, store the values here\n      console.log(\"Line/ add value\", actionUpdate);\n\n      fbstore.current = (window as any).fbstore || [];\n      (window as any).fbstore = fbstore.current;\n\n      var store = fbstore.current;\n      store.push({\n        ...actionUpdate,\n        timestamp: Math.round(actionUpdate.timestamp / 1000),\n      });\n      // filter out the store, using the timestamp, remove those that has higher timestmap than actionUpdate\n      // store = store.filter((s) => s.timestamp >= Math.round(actionUpdate.timestamp / 1000))\n\n      const dpts = generateDatapoints(segments, sensor, store);\n      // add the current reporting in\n      dpts.map((dpt, idx) => {\n        var current = null;\n        store.forEach((s) => {\n          // find the latest value\n          if (s.timestamp == dpt.timestamp) {\n            dpt.flowrate = s.input;\n            dpt.pressure = s.pressure * 10 || 0;\n          }\n        });\n      });\n      console.log(\"Line/ dpts\", dpts, store);\n      setDataPoints(dpts);\n    } catch (e) {\n      console.error(\"ProfileRune\", e);\n    }\n  }, [formulaFeedbacks, index, segments, selectedFormulaId, sensor]);\n\n  useEffect(() => {\n    setDataPoints(generateDatapoints(segments, sensor));\n  }, [segments, sensor]);\n\n  const attrMap = {};\n  attrMap[EnumProfileType.Pressure] = \"pressure\";\n  attrMap[EnumProfileType.Flowrate] = \"flowrate\";\n  attrMap[EnumProfileType.Power] = \"power\";\n\n  return (\n    <div className=\"hover:scale-120 w-full -translate-x-10 transition-transform duration-200\">\n      <LineChart\n        key={index}\n        height={300}\n        dataKey=\"Time\"\n        categories={[\n          // add the sensor of power herer\n\n          // sensor == EnumProfileType.Pressure ? \"pressure\" : \"flowrate\",\n          attrMap[sensor] || \"unknown sensor\",\n          \"flowrate\",\n          // \"max\",\n          // \"min\",\n          \"pressure\"\n        ]}\n        hideLegend={false}\n        hideXAxis={true}\n        hideYAxis={false}\n        data={dataPoints}\n        disableAnimation={true}\n      />\n    </div>\n  );\n};\nconst ProfileValueRune = ({\n  // segments,\n  // setValue,\n  // sensor,\n  // idx,\n  index,\n  subIndex,\n}: {\n  // segments: IProfilingSegment[];\n  // setValue: Dispatch<SetStateAction<number>>;\n  // sensor: EnumProfileType;\n  // idx: number;\n  index: number;\n  subIndex: number;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam;\n  const sensor = action.profilingType;\n  const segments = action.segments;\n  const idx = subIndex;\n\n  let unit: string = \"\";\n  if (sensor == EnumProfileType.Pressure) {\n    unit = \"bar\";\n  }\n  if (sensor == EnumProfileType.Flowrate) {\n    unit = \"gram/s\";\n  } else if (sensor == EnumProfileType.Power) {\n    unit = \"%\";\n  }\n\n  const maxValue: Record<EnumProfileType, number> = {\n    [EnumProfileType.Pressure]: 10,\n    [EnumProfileType.Flowrate]: 100,\n    [EnumProfileType.Power]: 100,\n  };\n  const [value, setValue] = useState<number>(segments[subIndex].value)\n  const { t } = useTranslation()\n  \n  \n  function handleUpdate() {\n    setFormulas(\n      produce(formulas, (draft) => {\n        (draft[selectedFormulaId].steps[index].action as IProfileParam).segments[subIndex].value = value\n      })\n    )\n  }\n\n\n  return (\n    <>\n      <div\n        className=\"flex h-8 w-fit items-center justify-between rounded-lg p-2\"\n        onClick={() => {\n          setIsOpen(true);\n        }}\n      >\n        <h1 className=\"text-xl font-bold text-blue-800\">{value === null ? 100 : value} %</h1>\n      </div>\n\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title={t(\"Set target\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: t(\"OK\"),\n            onPress: () => {\n              setIsOpen(false);\n              handleUpdate();\n            },\n          }}\n          secondaryAction={{\n            label: t(\"Cancel\"),\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Columns space={4} align=\"center\">\n              <Column width={\"4/5\"}>\n                <SliderField\n                  type=\"single\"\n                  name=\"power\"\n                  value={value}\n                  onChange={(e: number) => {\n                    setValue(e);\n                  }}\n                  label={t(sensor)}\n                  minValue={0}\n                  maxValue={100}\n                  step={1}\n                />\n              </Column>\n              <Column width={\"1/5\"}>\n                <NumberField\n                  value={value}\n                  onChange={setValue}\n                  onBlur={() => console.log(\"blur\")}\n                  label={t(sensor)}\n\n                  minValue={0}\n                  maxValue={100}\n                  step={1}\n                />\n              </Column>\n            </Columns>\n\n            {/* <Banner\n              kind=\"informative\"\n              title={t(\"Notice\")}\n              description={t(\"Power require an external hardware to be connected to the machine, other wise it is simply ON/OFF\")}\n              action={{\n                label: \"Learn more\",\n                onPress: () => {\n                  window.open(\"https://www.google.com\");\n                },\n              }}\n            /> */}\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n\n  return (\n    <Popover\n      onOpenChange={(e) => {\n        console.log(\"close\", e);\n        if (e == false) {\n          setIsOpen(false);\n        }\n      }}\n      open={isOpen}\n    >\n      <PopoverTrigger>\n        <div\n          className=\"flex h-8 w-fit items-center justify-between rounded-lg p-2\"\n          onClick={() => {\n            setIsOpen(true);\n          }}\n        >\n          <h1 className=\" text-xl font-bold text-blue-800\">\n            {segments[idx].value} {unit}\n          </h1>\n        </div>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-96 min-w-96 rounded-xl border\">\n        <IoIosCloseCircle\n          className=\"absolute right-2 top-2 text-gray-500\"\n          size={20}\n          onClick={() => {\n            setIsOpen(false);\n          }}\n        />\n\n        <SliderField\n          value={segments[idx].value}\n          onChange={(e: number) => {\n            setFormulas(\n              produce(formulas, (draft) => {\n                (\n                  draft[selectedFormulaId].steps[index].action as IProfileParam\n                ).segments[idx].value = e;\n              }),\n            );\n          }}\n          label={sensor}\n          type=\"single\"\n          name=\"value\"\n          minValue={0}\n          maxValue={maxValue[sensor]}\n          step={0.1}\n        />\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport const ProfileRune = ({\n  // value,\n  // onChange,\n  index,\n}: {\n  // value: EnumProfileType;\n  // onChange: Dispatch<SetStateAction<string>>;\n  index: number;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam;\n\n  const [profileType, setProfileType] = useState<EnumProfileType>(\n    action.profilingType || EnumProfileType.Flowrate,\n  );\n\n  const { t } = useTranslation();\n  useEffect(() => {\n    setIsOpen(false);\n  }, [formulas]);\n\n  function onChange(sensor: EnumProfileType) {\n    setFormulas(\n      produce(formulas, (draft) => {\n        draft[selectedFormulaId].steps[index].action.actionType =\n          EnumAction.Profile;\n        (\n          draft[selectedFormulaId].steps[index].action as IProfileParam\n        ).profilingType = sensor;\n      }),\n    );\n  }\n\n  return (\n    <>\n      <h1\n        className=\" text-xl font-bold text-blue-800\"\n        onClick={() => {\n          setIsOpen(true);\n        }}\n      >\n        {t(action.profilingType) || EnumProfileType.Flowrate}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title=\"Select an profiling method\"\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              onChange(profileType);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={16}>\n            <Tiles space={8} columns={2}>\n              <Button\n                hierarchy=\"primary\"\n                kind={\n                  profileType == EnumProfileType.Flowrate ? \"solid\" : \"outline\"\n                }\n                label=\"Flowrate\"\n                onPress={() => {\n                  setProfileType(EnumProfileType.Flowrate);\n                }}\n              />\n\n              <Button\n                hierarchy=\"primary\"\n                kind={\n                  profileType == EnumProfileType.Pressure ? \"solid\" : \"outline\"\n                }\n                label=\"Pressure\"\n                onPress={() => {\n                  setProfileType(EnumProfileType.Pressure);\n                }}\n              />\n              <Button\n                hierarchy=\"primary\"\n                kind={\n                  profileType == EnumProfileType.Power ? \"solid\" : \"outline\"\n                }\n                label=\"Power\"\n                onPress={() => {\n                  setProfileType(EnumProfileType.Power);\n                }}\n              />\n            </Tiles>\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5670, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5675, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/IngredientRune.tsx"],"sourcesContent":["import { IGrinderState } from \"@/gateway/grinder\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport {\n  Banner,\n  Button,\n  Inline,\n  Modal,\n  Stack,\n} from \"@buildo/bento-design-system\";\nimport { useTranslation } from \"next-export-i18n\";\nimport { useRouter } from \"next/router\";\nimport { Dispatch, SetStateAction, useState } from \"react\";\nimport { useEffectOnce } from \"usehooks-ts\";\n\nexport const IngredientRune = ({\n  value,\n  onChange,\n}: {\n  value: string;\n  onChange: Dispatch<SetStateAction<string>>;\n}) => {\n  console.log(\"action/ recreate\");\n\n  const [isOpen, setIsOpen] = useState(false);\n  const { grinderSettings } = useDeviceContext();\n\n  const [ingredient, setIngridient] = useState<string>(value || \"\");\n  const { t } = useTranslation();\n  const router = useRouter();\n  useEffectOnce(() => {\n    onChange(\"\");\n  });\n\n  return (\n    <>\n      <h1\n        className=\" text-xl font-bold text-blue-800\"\n        onClick={() => setIsOpen(true)}\n      >\n        {ingredient == \"\" ? t(\"[Select ingredient]\") : ingredient}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title={t(\"Select ingredient\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              onChange(ingredient);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Inline space={4}>\n              {grinderSettings.map((grinder: IGrinderState, index: number) => {\n                return (\n                  <Button\n                    key={index}\n                    kind={ingredient == grinder.name ? \"solid\" : \"outline\"}\n                    hierarchy=\"primary\"\n                    label={grinder.name}\n                    onPress={() => setIngridient(grinder.name)}\n                  />\n                );\n              })}\n              {/* <Button\n                key={-1}\n                kind={\"outline\"}\n                hierarchy=\"primary\"\n                label={\"+\"}\n                onPress={() => {\n                  router.push(\"/setting\");\n                }}\n              /> */}\n            </Inline>\n            <Banner\n              kind=\"informative\"\n              title={t(\"Reminder\")}\n              description={t(\n                \"You can set up your grinder in the settings, the hardware can be connected to the machine wirelessly to the espresso machine\",\n              )}\n              // action={{\n              //   label: \"Learn more\",\n              //   onPress: () => {\n              //     window.open(\"https://www.google.com\");\n              //   },\n              // }}\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAcO,MAAM,iBAAiB,CAAC,EAC7B,KAAK,EACL,QAAQ,EAIT;;IACC,QAAQ,GAAG,CAAC;IAEZ,MAAM,CAAC,QAAQ,UAAU,GAAG,uIAAS;IACrC,MAAM,EAAE,eAAe,EAAE,GAAG;IAE5B,MAAM,CAAC,YAAY,cAAc,GAAG,uIAAiB,SAAS;IAC9D,MAAM,EAAE,CAAC,EAAE,GAAG;IACd,MAAM,SAAS;IACf,6LAAc;QACZ,SAAS;IACX;IAEA,qBACE;;0BACE,qJAAC;gBACC,WAAU;gBACV,SAAS,IAAM,UAAU;0BAExB,cAAc,KAAK,EAAE,yBAAyB;;;;;;YAEhD,wBACC;gBACE,MAAK;gBACL,OAAO,EAAE;gBACT,SAAS,IAAM,UAAU;gBACzB,eAAe;oBACb,OAAO;oBACP,SAAS;wBACP,UAAU;wBACV,SAAS;oBACX;gBACF;gBACA,iBAAiB;oBACf,OAAO;oBACP,SAAS,IAAM,UAAU;gBAC3B;0BAEA,cAAA;oBAAO,OAAO;;sCACZ;4BAAQ,OAAO;sCACZ,gBAAgB,GAAG,CAAC,CAAC,SAAwB;gCAC5C,qBACE;oCAEE,MAAM,cAAc,QAAQ,IAAI,GAAG,UAAU;oCAC7C,WAAU;oCACV,OAAO,QAAQ,IAAI;oCACnB,SAAS,IAAM,cAAc,QAAQ,IAAI;mCAJpC;;;;;4BAOX;;;;;;sCAWF;4BACE,MAAK;4BACL,OAAO,EAAE;4BACT,aAAa,EACX;;;;;;;;;;;;;;;;;;;AAchB;GArFa;;;;;;;;KAAA"}},
    {"offset": {"line": 5792, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5797, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/GrinderRune.tsx"],"sourcesContent":["import {\n  Banner,\n  Button,\n  Modal,\n  Stack,\n  Tiles,\n} from \"@buildo/bento-design-system\";\nimport { useTranslation } from \"next-export-i18n\";\nimport { Dispatch, SetStateAction, useEffect, useState } from \"react\";\nimport { FaRegClock } from \"react-icons/fa\";\nimport { IoMdSkipForward } from \"react-icons/io\";\nimport { useEffectOnce } from \"usehooks-ts\";\n// import { IOptionItemProps } from \"./OptionItem\";\n\n// const grinderBehaviourOptions: IOptionItemProps[] = [\n//   {\n//     title: \"can skip\",\n//     text: \"Grinder will skip this step if portafilter is not in position\",\n//     value: true,\n//   },\n//   {\n//     title: \"must wait\",\n//     text: \"Grinder will wait until the portafilter is in position\",\n//     value: false,\n//   },\n// ];\n\nexport const GrinderSkipRune = ({\n  value,\n  onChange,\n}: {\n  value: boolean;\n  onChange: Dispatch<SetStateAction<boolean>>;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { t } = useTranslation();\n  useEffect(() => {\n    setIsOpen(false);\n  }, [value]);\n  useEffectOnce(() => {\n    onChange(false);\n  });\n\n  const [skippable, setSkippable] = useState<boolean>(true);\n\n  return (\n    <>\n      <h1\n        className=\" text-xl font-bold text-blue-800\"\n        onClick={() => setIsOpen(true)}\n      >\n        {skippable ? t(\"can skip\") : t(\"must wait\")}\n      </h1>\n\n      {isOpen && (\n        <Modal\n          autoFocus={false}\n          size=\"small\"\n          title={t(\"Set grinder behaviour\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              onChange(skippable);\n            },\n          }}\n          secondaryAction={{\n            label: t(\"Cancel\"),\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Tiles space={8} columns={2}>\n              <Button\n                kind={skippable ? \"solid\" : \"outline\"}\n                hierarchy=\"primary\"\n                label={t(\"Can skip\")}\n                onPress={() => setSkippable(true)}\n                icon={() => <IoMdSkipForward />}\n              />\n              <Button\n                kind={!skippable ? \"solid\" : \"outline\"}\n                hierarchy=\"primary\"\n                label={t(\"Must wait\")}\n                onPress={() => setSkippable(false)}\n                icon={() => <FaRegClock />}\n              />\n            </Tiles>\n            <Banner\n              kind=\"informative\"\n              title={t(\"Explaination\")}\n              description={\n                skippable\n                  ? t(\n                      \"Grinder will skip this step if portafilter is not in position\",\n                    )\n                  : t(\n                      \"Grinder will wait until the portafilter is in position, then it will start grinding\",\n                    )\n              }\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA2BO,MAAM,kBAAkB,CAAC,EAC9B,KAAK,EACL,QAAQ,EAIT;;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,uIAAS;IACrC,MAAM,EAAE,CAAC,EAAE,GAAG;IACd,wIAAU;QACR,UAAU;IACZ,GAAG;QAAC;KAAM;IACV,6LAAc;QACZ,SAAS;IACX;IAEA,MAAM,CAAC,WAAW,aAAa,GAAG,uIAAkB;IAEpD,qBACE;;0BACE,qJAAC;gBACC,WAAU;gBACV,SAAS,IAAM,UAAU;0BAExB,YAAY,EAAE,cAAc,EAAE;;;;;;YAGhC,wBACC;gBACE,WAAW;gBACX,MAAK;gBACL,OAAO,EAAE;gBACT,SAAS,IAAM,UAAU;gBACzB,eAAe;oBACb,OAAO;oBACP,SAAS;wBACP,UAAU;wBACV,SAAS;oBACX;gBACF;gBACA,iBAAiB;oBACf,OAAO,EAAE;oBACT,SAAS,IAAM,UAAU;gBAC3B;0BAEA,cAAA;oBAAO,OAAO;;sCACZ;4BAAO,OAAO;4BAAG,SAAS;;8CACxB;oCACE,MAAM,YAAY,UAAU;oCAC5B,WAAU;oCACV,OAAO,EAAE;oCACT,SAAS,IAAM,aAAa;oCAC5B,MAAM,kBAAM;;;;;;;;;;8CAEd;oCACE,MAAM,CAAC,YAAY,UAAU;oCAC7B,WAAU;oCACV,OAAO,EAAE;oCACT,SAAS,IAAM,aAAa;oCAC5B,MAAM,kBAAM;;;;;;;;;;;;;;;;sCAGhB;4BACE,MAAK;4BACL,OAAO,EAAE;4BACT,aACE,YACI,EACE,mEAEF,EACE;;;;;;;;;;;;;;;;;;;AAStB;GAhFa;;;;;;KAAA"}},
    {"offset": {"line": 5936, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 5941, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/components/ActionRune.tsx"],"sourcesContent":["import {\n  EnumAction,\n  EnumProfileType,\n  EnumTarget,\n  IAction,\n  IProfileParam,\n  ITarget,\n} from \"@/gateway/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { Button, Modal, Tiles } from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useTranslation } from \"next-export-i18n\";\nimport { useEffect, useState } from \"react\";\nimport { FaChartArea } from \"react-icons/fa\";\nimport { FaClock } from \"react-icons/fa6\";\nimport { GiManualMeatGrinder } from \"react-icons/gi\";\nimport { IoWaterSharp } from \"react-icons/io5\";\nimport { LiaFillDripSolid } from \"react-icons/lia\";\nimport { TbColorFilter } from 'react-icons/tb'\n\nexport const ActionRune = ({ index }: { index: number }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const [action, setAction] = useState<EnumAction>(\n    formulas[selectedFormulaId].steps[index].action.actionType as EnumAction,\n  );\n  const step = formulas[selectedFormulaId].steps[index];\n  const { t } = useTranslation();\n\n  function handleChangeAction(e: EnumAction) {\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index].action as IAction;\n        action.actionType = e as EnumAction;\n        const target = draft[selectedFormulaId].steps[index].target as ITarget;\n\n        // set the target\n        if (e == EnumAction.Grind) {\n          target.targetType = EnumTarget.Weight;\n        } else if (e == EnumAction.Extract) {\n          target.targetType = EnumTarget.Weight;\n        } else if (e == EnumAction.Rest) {\n          target.targetType = EnumTarget.Time;\n        } else if (e == EnumAction.Profile) {\n          target.targetType = EnumTarget.Weight;\n          let _action = action as IProfileParam;\n          _action.segments = _action.segments || [];\n          _action.profilingType =\n            _action.profilingType || EnumProfileType.Flowrate;\n        } else if (e == EnumAction.PourOver) {\n          target.targetType = EnumTarget.Weight;\n        }\n\n        draft[selectedFormulaId].steps[index].action = action;\n        draft[selectedFormulaId].steps[index].target = target;\n      }),\n    );\n  }\n\n  useEffect(() => {\n    setIsOpen(false);\n  }, [formulas]);\n\n  return (\n    <>\n      <h1\n        className=\"text-xl font-bold text-orange-900 underline decoration-pink-500\"\n        onClick={() => {\n          setIsOpen(true);\n        }}\n      >\n        {/* {step.action.actionType || \"Action\"} */}\n        {t(step.action.actionType) || \"Action\"}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"large\"\n          title={t(\"Select an action\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: t(\"OK\"),\n            onPress: () => {\n              setIsOpen(false);\n              handleChangeAction(action);\n            },\n          }}\n          secondaryAction={{\n            label: t(\"Cancel\"),\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Tiles space={4} columns={3}>\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Grind ? \"solid\" : \"outline\"}\n              label={t(\"Grind\")}\n              onPress={() => {\n                setAction(EnumAction.Grind);\n              }}\n              icon={() => <GiManualMeatGrinder />}\n              isDisabled={true}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Extract ? \"solid\" : \"outline\"}\n              label={t(\"Extract\")}\n              onPress={() => {\n                setAction(EnumAction.Extract);\n              }}\n              icon={() => <IoWaterSharp />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Rest ? \"solid\" : \"outline\"}\n              label={t(\"Rest\")}\n              onPress={() => {\n                setAction(EnumAction.Rest);\n              }}\n              icon={() => <FaClock />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Profile ? \"solid\" : \"outline\"}\n              label={t(\"Profile\")}\n              onPress={() => {\n                setAction(EnumAction.Profile);\n              }}\n              icon={() => <FaChartArea />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.PourOver ? \"solid\" : \"outline\"}\n              label={t(\"Pour Over\")}\n              onPress={() => {\n                setAction(EnumAction.PourOver);\n              }}\n              icon={() => <LiaFillDripSolid />}\n              isDisabled={false}\n            />\n            {/* <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Sound ? \"solid\" : \"outline\"}\n              label={t(\"Sound\")}\n              onPress={() => {\n                setAction(EnumAction.Sound);\n              }}\n              icon={() => <AiFillSound />}\n            /> */}\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.RGB ? \"solid\" : \"outline\"}\n              label={t(\"RGB\")}\n              onPress={() => {\n                setAction(EnumAction.RGB);\n              }}\n              icon={() => <TbColorFilter />}\n            />\n          </Tiles>\n        </Modal>\n      )}\n    </>\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6170, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6175, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/components/step/StepCard.tsx"],"sourcesContent":["import {\n  EnumAction,\n  IExtractParam,\n  IGrindParam,\n  IPourOverParam,\n  IRestParam,\n} from \"@/gateway/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { produce } from \"immer\";\nimport { MdOutlineClear } from \"react-icons/md\";\nimport { ActionRune } from \"./components/ActionRune\";\nimport { GrinderSkipRune } from \"./components/GrinderRune\";\nimport { MagicLine, RenderedSegment } from \"./components/ProfileRune\";\nimport {motion, AnimatePresence} from 'framer-motion'\n\nimport { useTranslation } from \"next-export-i18n\";\nimport { IngredientRune } from \"./components/IngredientRune\";\nimport { ProfileRune } from \"./components/ProfileRune\";\nimport { PumpRune } from \"./components/PumpRune\";\nimport { TextRune } from \"./components/TextRune\";\nimport { TimeRune } from \"./components/TimeRune\";\nimport { WeightRune } from \"./components/WeightRune\";\nimport { ColorRune } from \"./components/ColorRune\";\n\nexport type ProfilingType = \"pressure sensor\" | \"flowrate profiler\";\nexport type GrinderBehaviour = \"can skip\" | \"must wait\";\nexport type ActionType = \"Grind\" | \"Extract\" | \"Rest\" | \"Profiling\";\n\n// ----------------------------------------------------------- //\n\nfunction Wrapper() {\n  return (\n    <div className=\"group relative mx-auto max-w-7xl\">\n      <div className=\"absolute -inset-1 rounded-lg bg-gradient-to-r from-purple-600 to-pink-600 opacity-25 blur transition duration-1000 group-hover:opacity-100 group-hover:duration-200\">\n        <div className=\"items-pop flex justify-start space-x-6 rounded-lg bg-white px-7 py-6 leading-none ring-1 ring-gray-900\"></div>\n      </div>\n    </div>\n  );\n}\n\nexport function NewStepCard({\n  onDelete,\n  index,\n}: {\n  onDelete: () => void;\n  index: number;\n}) {\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const steps = formulas[selectedFormulaId].steps || [];\n  const { t } = useTranslation();\n  return (\n    <AnimatePresence>\n      <motion.div\n        key={index}\n        initial={{\n          scale: 0,\n          opacity: 0\n        }}\n        animate={{\n          scale: 1,\n          opacity: 1\n        }}\n        transition={{\n          ease: \"easeInOut\"\n        }}\n        exit={{\n          scale: 0,\n          opacity: 0\n        }}\n\n\n        className=\"-inset-1 rounded-xl bg-gradient-to-r from-purple-600 to-pink-600\"\n      >\n        <div className=\"flex h-fit w-96 max-w-[calc(90vw)] flex-col rounded-xl  border  bg-white p-4 drop-shadow-xl transition-transform duration-200 hover:border-blue-500\">\n          <div\n            className=\"absolute right-0 top-0 cursor-pointer p-2\"\n            onClick={() => onDelete()}\n          >\n            <MdOutlineClear className=\"text-gray-300\" />\n          </div>\n          <div className=\"inline-flex max-w-96 flex-wrap items-center gap-2 space-x-1 text-wrap\">\n            <ActionRune index={index} />\n\n            {formulas[selectedFormulaId].steps[index].action.actionType ===\n              EnumAction.Grind && (\n                <>\n                  <WeightRune index={index} subIndex={-1} />\n                  <TextRune text={t(\"of\")} />\n                  <IngredientRune\n                    value={(steps[index].action as IGrindParam).ingredient}\n                    onChange={(ingredient: string) => {\n                      // setSteps(\n                      //   produce(steps, (draft) => {\n                      //     (draft[index].action as IGrindParam).ingredient =\n                      //       ingredient;\n                      //   })\n                      // );\n\n                      setFormulas(\n                        produce(formulas, (draft) => {\n                          (\n                            draft[selectedFormulaId].steps[index]\n                              .action as IGrindParam\n                          ).ingredient = ingredient;\n                        }),\n                      );\n                    }}\n                  />\n                  <TextRune text={t(\"bean, grinder\")} />\n                  <GrinderSkipRune\n                    value={(steps[index].action as IGrindParam).canSkip}\n                    onChange={(state: boolean) => {\n                      // setSteps(\n                      //   produce(steps, (draft) => {\n                      //     (draft[index].action as IGrindParam).canSkip = state;\n                      //     draft[index].action.actionType = EnumAction.Grind;\n                      //   })\n                      // );\n                      setFormulas(\n                        produce(formulas, (draft) => {\n                          (\n                            draft[selectedFormulaId].steps[index]\n                              .action as IGrindParam\n                          ).canSkip = state;\n                          draft[selectedFormulaId].steps[index].action.actionType =\n                            EnumAction.Grind;\n                        }),\n                      );\n                    }}\n                  />\n\n                  {(steps[index].action as IGrindParam).canSkip === true ? (\n                    <TextRune text={t(\"this step is portafilter is absent\")} />\n                  ) : (\n                    <TextRune text={t(\"until portafilter is present\")} />\n                  )}\n                </>\n              )}\n            {steps[index].action.actionType === EnumAction.Extract && (\n              <>\n                {/* <TextRune text=\"a shot of\" /> */}\n                <WeightRune index={index} subIndex={-1} />\n                <TextRune text={t(\"with pump power\")} />\n                <PumpRune\n                  value={(steps[index].action as IExtractParam).power}\n                  onChange={(power: number) => {\n                    // setSteps(\n                    //   produce(steps, (draft) => {\n                    //     (draft[index].action as IExtractParam).actionType =\n                    //       EnumAction.Extract;\n                    //     (draft[index].action as IExtractParam).power = power;\n                    //   })\n                    // );\n\n                    setFormulas(\n                      produce(formulas, (draft) => {\n                        (\n                          draft[selectedFormulaId].steps[index]\n                            .action as IExtractParam\n                        ).actionType = EnumAction.Extract;\n                        (\n                          draft[selectedFormulaId].steps[index]\n                            .action as IExtractParam\n                        ).power = power;\n                      }),\n                    );\n                  }}\n                />\n              </>\n            )}\n            {steps[index].action.actionType === EnumAction.RGB && (\n              <>\n                {/* <TextRune text=\"a shot of\" /> */}\n                <TextRune text=\"set all pixels to\" />\n                <ColorRune index={index}/>\n\n              </>\n            )}\n            {steps[index].action.actionType === EnumAction.PourOver && (\n              <>\n                <TextRune text={t(\"total of\")} />\n                <WeightRune index={index} subIndex={-1} />\n                <TextRune text={t(\", extract\")} />\n                <WeightRune index={index} subIndex={0} />\n                <TextRune text={t(\"every\")} />\n                <TimeRune subIndex={-2} index={index} />\n                <TextRune text={t(\"with pump power of\")} />\n                <PumpRune\n                  value={(steps[index].action as IPourOverParam).pumpPower}\n                  onChange={(power: number) => {\n                    // setSteps(\n                    //   produce(steps, (draft) => {\n                    //     (draft[index].action as IExtractParam).actionType =\n                    //       EnumAction.Extract;\n                    //     (draft[index].action as IExtractParam).power = power;\n                    //   })\n                    // );\n\n                    setFormulas(\n                      produce(formulas, (draft) => {\n                        (\n                          draft[selectedFormulaId].steps[index]\n                            .action as IPourOverParam\n                        ).actionType = EnumAction.PourOver;\n                        (\n                          draft[selectedFormulaId].steps[index]\n                            .action as IPourOverParam\n                        ).pumpPower = power;\n                      }),\n                    );\n                  }}\n                />\n\n              </>\n            )}\n            {steps[index].action.actionType === EnumAction.Rest && (\n              <>\n                <TextRune text={t(\"for\")} />\n                <TimeRune\n                  subIndex={-1}\n                  index={index}\n                // valveState={(steps[index].action as IRestParam).valveState}\n                // toggleChecked={(checked: boolean) => {\n                //   setSteps(\n                //     produce(steps, (draft) => {\n                //       draft[index].target.targetType = EnumTarget.Time;\n                //       (draft[index].action as IRestParam).valveState = checked;\n                //     })\n                //   );\n                // }}\n                />\n                {(steps[index].action as IRestParam).valveState && (\n                  <TextRune text=\"but keep valve open\" />\n                )}\n              </>\n            )}\n            {steps[index].action.actionType === \"Profile\" && (\n              <>\n                <TextRune text={t(\"to extract\")} />\n\n                <WeightRune index={index} subIndex={-1} />\n                <TextRune text={t(\"using\")} />\n                <ProfileRune index={index} />\n                <TextRune text={t(\"profiling\")} />\n                <RenderedSegment\n                  index={index}\n                // segments={(steps[index].action as IProfileParam).segments}\n                // setSegments={() => {\n                //   setSteps(\n                //     produce(steps, draft => {\n                //       (draft[index].action as IProfileParam).segments = segments;\n                //     })\n                //   );\n                // }}\n                // sensor={(steps[index].action as IProfileParam).profilingType}\n                />\n                <MagicLine\n                  index={index}\n                // segments={(steps[index].action as IProfileParam).segments}\n                // sensor={(steps[index].action as IProfileParam).profilingType}\n                />\n              </>\n            )}\n          </div>\n        </div>\n      </motion.div>\n\n    </AnimatePresence>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6612, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 6617, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/pages/lab.tsx"],"sourcesContent":["\"use client\";\n\nimport Head from 'next/head'\nimport { NewStepCard } from \"@/components/step/StepCard\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { EnumAction, EnumTarget } from \"@/gateway/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport {\n  Body,\n  Button,\n  Modal,\n  TextField,\n  Banner,\n  CheckboxField,\n  Tiles,\n  SliderField,\n  SelectField,\n} from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useSelectedLanguage, useTranslation } from \"next-export-i18n\";\nimport { useRouter } from \"next/router\";\nimport { ReactNode, useEffect, useRef, useState } from \"react\";\nimport {\n  DragDropContext,\n  Draggable,\n  DropResult,\n  Droppable,\n  ResponderProvided,\n} from \"react-beautiful-dnd\";\nimport { AiFillPlusCircle } from \"react-icons/ai\";\nimport {\n  FaDownload,\n  FaPlay,\n  FaShareAlt,\n  FaStop,\n  FaWindowClose,\n} from \"react-icons/fa\";\nimport { uuid } from \"uuidv4\";\nimport Layout from \"./layout\";\nimport { downloadFormula } from \"@/gateway/formula\";\nimport { queryDevice } from \"@/gateway/connection\";\n\nimport { SketchPicker, CirclePicker, ColorChangeHandler } from 'react-color';\nimport { cn } from '@/util';\n\n\nconst BetterButton = ({\n  icon,\n  label,\n  color,\n  onClick,\n}: {\n  icon: ReactNode;\n  label: string;\n  color: string;\n  onClick: () => void;\n}) => {\n  return (\n    <div\n      className={`flex size-12 cursor-pointer flex-row items-center space-x-1 rounded-xl border bg-white p-4 hover:border-blue-500`}\n    >\n      {icon}\n    </div>\n  );\n};\n\nconst Detail = () => {\n  const router = useRouter();\n  const id = router.query.slug;\n\n\n\n  const [downloadTargetGroup, setDownloadTargetGroup] = useState(-1);\n  const [downloadTargetButton, setDownloadTargetButton] = useState(-1);\n\n  const [downloadWindow, setDownloadWindow] = useState(false);\n  const [shareWindow, setShareWindow] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const [running, setRunning] = useState<boolean>(false);\n  const [shareToken, setShareToken] = useState<string>('')\n  const {\n    selectedFormulaId,\n    registerSelectedFormulaId,\n    setFormulas,\n    formulas,\n    setSelectedPage,\n    registerFormulaClick,\n    cancelFormulaClick,\n    progressReport,\n  } = useDeviceContext();\n\n\n\n\n  const [winReady, setwinReady] = useState(false);\n  const timeoutRef = useRef<ReturnType<typeof setTimeout>>();\n  const [colorModal, setColorModal] = useState<boolean>(false);\n  const { formulaFeedbacks } = useDeviceContext();\n\n  useEffect(() => {\n    if (timeoutRef) {\n      clearTimeout(timeoutRef.current);\n      timeoutRef.current = setTimeout(() => {\n        setRunning(false);\n      }, 2000);\n      setRunning(true);\n    }\n  }, [formulaFeedbacks, selectedFormulaId]);\n\n  useEffect(() => {\n    setTimeout(async () => {\n      await queryDevice({\n        command: 'group.locate',\n        buttonId: downloadTargetButton + 1,\n        groupId: downloadTargetGroup + 1,\n      })\n\n    })\n  }, [downloadTargetGroup, downloadTargetButton])\n\n  //TODO: Assume don't have any formular before\n  function handleAddStep() {\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     draft.push({\n    //       id: uuid(),\n    //       action: {\n    //         actionType: EnumAction.Rest,\n    //         valveState: false,\n    //       },\n    //       target: {\n    //         targetType: EnumTarget.Time,\n    //         value: 10,\n    //       },\n    //     });\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const formula = draft[selectedFormulaId];\n        formula.steps.push({\n          id: uuid(),\n          action: {\n            actionType: EnumAction.Rest,\n            valveState: false,\n          },\n          target: {\n            targetType: EnumTarget.Time,\n            value: 10,\n          },\n        });\n      }),\n    );\n  }\n\n  function handleDeleteStep(id: string) {\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     return draft.filter(function (item) {\n    //       return item?.id !== id;\n    //     });\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const formula = draft[selectedFormulaId];\n        formula.steps = formula.steps.filter(function (item) {\n          return item?.id !== id;\n        });\n        return draft;\n      }),\n    );\n  }\n\n  function handleDragAndDrop(result: DropResult, provided: ResponderProvided) {\n    if (!result.destination) return;\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const [reorderedItem] = draft.splice(result.source.index, 1);\n    //     draft.splice(result.destination.index, 0, reorderedItem);\n    //     return draft;\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const formula = draft[selectedFormulaId];\n        const [reorderedItem] = formula.steps.splice(result.source.index, 1);\n        formula.steps.splice(result?.destination?.index || 0, 0, reorderedItem);\n        return draft;\n      }),\n    );\n  }\n\n  useEffect(function () {\n    setwinReady(true);\n  }, []);\n  useEffect(() => {\n    console.log(\"lab/ re-render\", selectedFormulaId);\n  }, [selectedFormulaId]);\n\n  const listDrinkType = () => {\n    return (\n      <div className=\"flex h-16 w-full flex-row justify-between space-x-4\"></div>\n    );\n  };\n  const { lang } = useSelectedLanguage();\n  const { t } = useTranslation();\n\n\n\n\n\n  const translations_run = t(\"Run\");\n  return (\n    <Layout>\n      <Head>\n        <title>☕ ROSARIO</title>\n      </Head>\n\n      {colorModal && (\n        <Modal\n          size=\"small\"\n          autoFocus={false}\n          title={t(\"Set color\")}\n          onClose={() => setColorModal(false)}\n          primaryAction={{\n            label: t(\"OK\"),\n            onPress: async () => {\n              setColorModal(false)\n            },\n          }}\n          secondaryAction={{\n            label: t(\"Cancel\"),\n            onPress: () => setColorModal(false),\n          }}\n        >\n          <div className=\"flex items-center justify-center w-full h-full p-4\">\n            <CirclePicker\n              className='m-4'\n              color={formulas[selectedFormulaId]?.color || \"#00aeef\"}\n              onChange={(color: any, e: any) => {\n                setFormulas(produce(formulas, draft => {\n                  if (!formulas[selectedFormulaId]) return;\n                  formulas[selectedFormulaId].color = color.hex\n                }))\n              }}\n            />\n          </div>\n        </Modal>\n      )}\n\n      {downloadWindow && (\n        <Modal\n          size=\"large\"\n          autoFocus={false}\n          title={t(\"Assign to Button\")}\n          onClose={() => setDownloadWindow(false)}\n          primaryAction={{\n            label: t(\"Download\"),\n            onPress: async () => {\n              console.log('lab/ download formula to', { downloadTargetGroup, downloadTargetButton, selectedFormulaId })\n\n              await downloadFormula({ groupId: downloadTargetGroup + 1, buttonId: downloadTargetButton + 1, formulaId: selectedFormulaId })\n\n              setLoading(true);\n              setTimeout(() => {\n                setDownloadWindow(false);\n              }, 1000);\n            },\n          }}\n          secondaryAction={{\n            label: t(\"Cancel\"),\n            onPress: () => setDownloadWindow(false),\n          }}\n        >\n          <Body size=\"medium\">\n            {t(\n              \"This process will save the formula to a physical button on your cofee machine so you don't always need a mobile device connected\",\n            )}\n            <br />\n            <br />\n\n            <Banner\n              kind=\"informative\"\n              title={t('Notice')}\n              description={t(\n                \"The button order might not be the same physically, right after clicking saved, the button will blink to indicate which button it is in real life\"\n              )}\n              action={{\n                label: \"Learn more\",\n                onPress: () => {\n                  window.open(\"https://www.google.com\");\n                },\n              }}\n            />\n\n\n          </Body>\n\n          <div className=\"flex h-32 w-full flex-col space-y-4 p-4\">\n            <Tiles space={8} columns={3}>\n              {[1, 2, 3].map((value, index) => {\n                return (\n                  <Button\n                    key={index}\n                    label={t(`Group ${value}`)}\n                    hierarchy=\"primary\"\n                    kind={index === downloadTargetGroup ? \"solid\" : \"outline\"}\n                    onPress={() => setDownloadTargetGroup(index)}\n                  />\n                );\n              })}\n            </Tiles>\n            <Tiles space={8} columns={4}>\n              {[1, 2, 3, 4].map((value, index) => {\n                return (\n                  <Button\n                    key={index}\n                    label={t(`Button ${value}`)}\n                    hierarchy=\"primary\"\n                    kind={index === downloadTargetButton ? \"solid\" : \"outline\"}\n                    onPress={() => setDownloadTargetButton(index)}\n                  />\n                );\n              })}\n            </Tiles>\n          </div>\n        </Modal>\n      )}\n\n      {shareWindow && (\n        <Modal\n          title=\"Share your formula\"\n          onClose={() => setShareWindow(false)}\n          primaryAction={{\n            label: \"Copy\",\n            onPress: () => {\n              navigator.clipboard.writeText(shareToken).then(() => {\n                console.log(\"Share token copied to clipboard.\");\n              }, (err) => {\n                console.error(\"Could not copy share token to clipboard: \", err);\n              });\n              setShareWindow(false)\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setShareWindow(false),\n          }}\n        >\n          <Banner\n            kind={formulas[selectedFormulaId].isShared ? \"positive\" : \"informative\"}\n            title={formulas[selectedFormulaId].isShared ? t('Shared to public') : t(\"Do you want to share this to public ?\")}\n            description={\n              formulas[selectedFormulaId].isShared ? t(\n                \"This formula is already shared, people can search for it using the formula name you choose.\"\n              ) : t(\"If you share this formula, people can try it out also. They will get a copy of this formula.\")}\n            action={{\n              label: formulas[selectedFormulaId].isShared ? t(\"Hide\") : t(\"Share\"),\n              onPress: () => {\n                setFormulas(produce(formulas, draft => {\n                  draft[selectedFormulaId].isShared = !draft[selectedFormulaId].isShared\n                }))\n\n              },\n            }}\n          />\n          {/* <CheckboxField\n            label=\"Share this to community\"\n            name=\"terms-and-conditions\"\n            value={formulas[selectedFormulaId].isShared}\n            onChange={(state: boolean) => {\n              setFormulas(produce(formulas, draft => {\n                draft[selectedFormulaId].isShared = state\n              }))\n            }}\n          /> */}\n\n          <div className=\"flex justify-center items-center bg-gray-800 text-white p-4 rounded-lg mt-2\">\n            <h1 className=\"text-2xl tracking-[.4em]\">{shareToken}</h1>\n          </div>\n        </Modal>\n      )}\n\n      <div className=\"flex flex-col  items-center space-y-4 p-4\">\n        <div\n          className={\n            cn(\n              \"flex h-fit w-96 max-w-[calc(90vw)] flex-col space-y-4 rounded-xl border p-4 shadow-xl\",\n              formulas[selectedFormulaId]?.isShared == true ? \"border-green-700\" : \"border-black\"\n\n            )\n          }\n        >\n          {formulas[selectedFormulaId]?.isShared == true && (\n            <>\n              <SelectField\n                value={formulas[selectedFormulaId].category}\n                onChange={(e) => {\n                  setFormulas(produce(formulas, draft => {\n                    draft[selectedFormulaId].category = e || \"\"\n                  }))\n                }}\n                name=\"category\"\n                label=\"Which category best fit this formula ?\"\n                placeholder=\"Select a color\"\n                options={[\n                  {\n                    value: \"Espresso\",\n                    label: \"Espresso\",\n                    kind: \"two-line\",\n                    secondLine: \"Coffee in general\",\n                  },\n                  {\n                    value: \"Tea-presso\",\n                    label: \"Tea-pressor\",\n                    kind: \"two-line\",\n                    secondLine: \"Unique formula to extract green tea\",\n                  },\n                  {\n                    value: \"Pour over\",\n                    label: \"Pour over\",\n                    kind: \"two-line\",\n                    secondLine: \"Pour over coffee or brewing related\",\n                  },\n                ]}\n              />\n\n              <Separator/>\n            </>\n          )}\n          <div className=\"flex items-center w-full\">\n            <div className=\"flex-grow \">\n              <TextField\n                value={formulas[selectedFormulaId]?.title}\n                onChange={(e: string) => {\n                  setFormulas(\n                    produce(formulas, (draft) => {\n                      console.log(\"Formulas\", formulas, selectedFormulaId);\n                      draft[selectedFormulaId].title = e;\n                    }),\n                  );\n                }}\n                label={t(\"Formula\")}\n                placeholder=\"Untitled formula\"\n              />\n\n            </div>\n            <button className=\"ml-2 h-11 w-11  rounded-xl mt-6 ring-1 ring-black \"\n              style={{\n                backgroundColor: formulas[selectedFormulaId]?.color || \"#000000\"\n              }}\n              onClick={() => {\n                setColorModal(true)\n              }}\n            ></button>\n          </div>\n\n          {/* {listDrinkType()} */}\n\n          <div className=\"flex flex-row items-center justify-between space-x-1 text-white\">\n            {running === true ? (\n              <div\n                className={`flex h-12 w-2/5 cursor-pointer select-none flex-row items-center justify-evenly rounded-xl border bg-white bg-gradient-to-r from-orange-400 to-red-400 p-4 text-white hover:border-blue-500`}\n                onClick={() => {\n                  cancelFormulaClick(selectedFormulaId);\n                }}\n              >\n                <FaStop />\n                <h1>Stop</h1>\n              </div>\n            ) : (\n              <div\n                className={`flex h-12 w-2/5 cursor-pointer select-none flex-row items-center justify-evenly rounded-xl border bg-white bg-gradient-to-r from-blue-400 to-emerald-400 p-4 text-white hover:border-blue-500`}\n                onClick={() => {\n                  // console.log(\"play\");\n                  registerFormulaClick(selectedFormulaId);\n                }}\n              >\n                <FaPlay />\n                <h1>{t(\"Run\")}</h1>\n              </div>\n            )}\n            <div\n              className={`flex h-12 w-1/5 cursor-pointer flex-row items-center justify-evenly rounded-xl border bg-white bg-gradient-to-r from-purple-800 via-violet-900 to-purple-800 p-4 hover:border-blue-500`}\n              onClick={() => {\n                console.log(\"download\");\n                // open a bento model\n                setDownloadWindow(true);\n              }}\n            >\n              <FaDownload />\n            </div>\n\n            <div\n              className={`flex h-12 w-1/5 cursor-pointer flex-row items-center justify-evenly rounded-xl border bg-white bg-gradient-to-r from-blue-500 to-blue-600 p-4 hover:border-blue-500`}\n              onClick={async () => {\n\n                const data = {\n                  formulas: formulas[selectedFormulaId],\n                  timestamp: Date.now()\n                }\n                const request = await fetch('https://api.anatalab.com/gateway/rosario/create_token', {\n                  method: 'POST',\n                  headers: {\n                    'Content-Type': 'application/json'\n                  },\n                  body: JSON.stringify(data)\n                })\n\n                const response = await request.json()\n                console.log('Share token response', response)\n\n                const assignedToken = response.token\n                setShareToken(assignedToken)\n                setShareWindow(true);\n              }}\n            >\n              <FaShareAlt />\n            </div>\n\n            <div\n              className={`flex h-12 w-1/5 cursor-pointer flex-row items-center justify-evenly rounded-xl border bg-white bg-gradient-to-r from-red-500 to-red-800 p-4 hover:border-blue-500`}\n              onClick={() => {\n                console.log(\"delete\");\n                setSelectedPage(\"Formula\");\n                registerSelectedFormulaId(\"\");\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    // return draft.filter(item => item?.id !== selectedFormulaId)\n                    delete formulas[selectedFormulaId];\n                  }),\n                );\n\n                router.push(\"/\");\n              }}\n            >\n              <FaWindowClose />\n            </div>\n          </div>\n\n          <div className=\"\">\n            <SliderField\n              type=\"single\"\n              name=\"delay\"\n              label={t(\"Pressure build-up time\")}\n              value={formulas[selectedFormulaId]?.buildupDuration || 0}\n              onChange={(e: number) => {\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    console.log(\"Formulas\", formulas, selectedFormulaId);\n                    if (draft[selectedFormulaId]) {\n                      draft[selectedFormulaId].buildupDuration = e;\n                    }\n                    return draft\n                  }),\n                );\n              }}\n              minValue={0}\n              maxValue={10}\n            />\n          </div>\n          <div className=\"\">\n            <SliderField\n              type=\"single\"\n              name=\"delay\"\n              label={t(\"Weight compensation (gram)\")}\n              value={formulas[selectedFormulaId]?.lossyWeight || 0}\n              onChange={(e: number) => {\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    console.log(\"Formulas\", formulas, selectedFormulaId);\n                    if (draft[selectedFormulaId]) {\n                      draft[selectedFormulaId].lossyWeight = e;\n                    }\n                    return draft\n                  }),\n                );\n              }}\n              minValue={0}\n              maxValue={100}\n            />\n          </div>\n          {/* <div className=\"\">\n            <SliderField\n              type=\"single\"\n              name=\"delay\"\n              label={t(\"Maximum extraction time (s)\")}\n              value={formulas[selectedFormulaId]?.maximumDuration || 0}\n              onChange={(e: number) => {\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    console.log(\"Formulas\", formulas, selectedFormulaId);\n                    if (draft[selectedFormulaId]) {\n                      draft[selectedFormulaId].maximumDuration = e;\n                    }\n                    return draft\n                  }),\n                );\n              }}\n              minValue={0}\n              maxValue={100}\n            />\n          </div> */}\n\n\n        </div>\n        <Separator />\n        <div className=\" mix-w-80 flex flex-col items-center justify-center py-3 \">\n          <DragDropContext\n            onDragEnd={handleDragAndDrop}\n            onBeforeDragStart={() => {\n              console.log(\"onBeforeDragStart\");\n            }}\n            onDragStart={() => {\n              console.log(\"onDragStart\");\n            }}\n            onDragUpdate={() => {\n              console.log(\"onDragUpdate\");\n            }}\n          >\n            <div className=\"flex w-full flex-row\">\n              <Droppable droppableId=\"ROOT\">\n                {(provided) => (\n                  <div\n                    {...provided.droppableProps}\n                    ref={provided.innerRef}\n                    className=\"mx-auto flex w-full flex-col items-center justify-between space-y-4\"\n                  >\n                    {(formulas[selectedFormulaId]?.steps || [])?.map(\n                      (item, idx) => {\n                        console.log(\"render\", { item, idx });\n                        return (\n                          winReady && (\n                            <Draggable\n                              draggableId={item?.id}\n                              key={item?.id}\n                              index={idx}\n                            >\n                              {(provided) => (\n                                <div\n                                  className=\"\"\n                                  {...provided.dragHandleProps}\n                                  {...provided.draggableProps}\n                                  ref={provided.innerRef}\n                                >\n                                  <NewStepCard\n                                    onDelete={() => handleDeleteStep(item?.id)}\n                                    index={idx}\n                                  // onChange={(params) =>\n                                  //   handleChange(item?.id, params)\n                                  // }\n                                  />\n                                </div>\n                              )}\n                            </Draggable>\n                          )\n                        );\n                      },\n                    )}\n                    {provided.placeholder}\n                  </div>\n                )}\n              </Droppable>\n            </div>\n          </DragDropContext>\n          <button\n            className=\"my-4 flex h-16 w-80 cursor-pointer flex-row items-center  justify-center space-x-4 rounded-xl border bg-blue-100\"\n            onClick={handleAddStep}\n          >\n            <AiFillPlusCircle color=\"#1180EF\" size={30} />\n            <p className=\"text-lg font-bold text-[#1180EF]\">{t(\"Add Step\")}</p>\n          </button>\n        </div>\n      </div>\n    </Layout>\n  );\n};\n\nexport default Detail;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7471, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7475, "column": 0}, "map": {"version":3,"sources":["/turbopack/[next]/entry/page-loader.ts"],"sourcesContent":["const PAGE_PATH = \"/lab\";\n\n// inserted by rust code\ndeclare const PAGE_PATH: string\n\n  // Adapted from https://github.com/vercel/next.js/blob/canary/packages/next/build/webpack/loaders/next-client-pages-loader.ts\n;(window.__NEXT_P = window.__NEXT_P || []).push([\n  PAGE_PATH,\n  () => {\n    return require('PAGE')\n  },\n])\nif (module.hot) {\n  module.hot.dispose(function () {\n    window.__NEXT_P.push([PAGE_PATH])\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,YAAY;AAMjB,CAAC,OAAO,QAAQ,GAAG,OAAO,QAAQ,IAAI,EAAE,EAAE,IAAI,CAAC;IAC9C;IACA;QACE,OAAO;IACT;CACD;AACD,IAAI,OAAO,GAAG,EAAE;IACd,OAAO,GAAG,CAAC,OAAO,CAAC;QACjB,OAAO,QAAQ,CAAC,IAAI,CAAC;YAAC;SAAU;IAClC;AACF"}},
    {"offset": {"line": 7489, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7494, "column": 0}, "map": {"version":3,"sources":["/turbopack/[turbopack]/dev/client/websocket.ts"],"sourcesContent":["// Adapted from https://github.com/vercel/next.js/blob/canary/packages/next/client/dev/error-overlay/websocket.ts\n\nlet source: WebSocket;\nconst eventCallbacks: ((msg: WebSocketMessage) => void)[] = [];\n\n// TODO: add timeout again\n// let lastActivity = Date.now()\n\nfunction getSocketProtocol(assetPrefix: string): string {\n  let protocol = location.protocol;\n\n  try {\n    // assetPrefix is a url\n    protocol = new URL(assetPrefix).protocol;\n  } catch (_) {}\n\n  return protocol === \"http:\" ? \"ws\" : \"wss\";\n}\n\nexport type WebSocketMessage =\n  | {\n      type: \"turbopack-connected\";\n    }\n  | {\n      type: \"turbopack-message\";\n      data: Record<string, any>;\n    };\n\nexport function addMessageListener(cb: (msg: WebSocketMessage) => void) {\n  eventCallbacks.push(cb);\n}\n\nexport function sendMessage(data: any) {\n  if (!source || source.readyState !== source.OPEN) return;\n  return source.send(data);\n}\n\nexport type HMROptions = {\n  path: string;\n  assetPrefix: string;\n  timeout?: number;\n  log?: boolean;\n};\n\nexport function connectHMR(options: HMROptions) {\n  const { timeout = 5 * 1000 } = options;\n\n  function init() {\n    if (source) source.close();\n\n    console.log(\"[HMR] connecting...\");\n\n    function handleOnline() {\n      const connected = { type: \"turbopack-connected\" as const };\n      eventCallbacks.forEach((cb) => {\n        cb(connected);\n      });\n\n      if (options.log) console.log(\"[HMR] connected\");\n      // lastActivity = Date.now()\n    }\n\n    function handleMessage(event: MessageEvent) {\n      // lastActivity = Date.now()\n\n      const message = {\n        type: \"turbopack-message\" as const,\n        data: JSON.parse(event.data),\n      };\n      eventCallbacks.forEach((cb) => {\n        cb(message);\n      });\n    }\n\n    // let timer: NodeJS.Timeout\n\n    function handleDisconnect() {\n      source.close();\n      setTimeout(init, timeout);\n    }\n\n    const { hostname, port } = location;\n    const protocol = getSocketProtocol(options.assetPrefix || \"\");\n    const assetPrefix = options.assetPrefix.replace(/^\\/+/, \"\");\n\n    let url = `${protocol}://${hostname}:${port}${\n      assetPrefix ? `/${assetPrefix}` : \"\"\n    }`;\n\n    if (assetPrefix.startsWith(\"http\")) {\n      url = `${protocol}://${assetPrefix.split(\"://\")[1]}`;\n    }\n\n    source = new window.WebSocket(`${url}${options.path}`);\n    source.onopen = handleOnline;\n    source.onerror = handleDisconnect;\n    source.onmessage = handleMessage;\n  }\n\n  init();\n}\n"],"names":[],"mappings":"AAAA,iHAAiH;;;;;;AAEjH,IAAI;AACJ,MAAM,iBAAsD,EAAE;AAE9D,0BAA0B;AAC1B,gCAAgC;AAEhC,SAAS,kBAAkB,WAAmB;IAC5C,IAAI,WAAW,SAAS,QAAQ;IAEhC,IAAI;QACF,uBAAuB;QACvB,WAAW,IAAI,IAAI,aAAa,QAAQ;IAC1C,EAAE,OAAO,GAAG,CAAC;IAEb,OAAO,aAAa,UAAU,OAAO;AACvC;AAWO,SAAS,mBAAmB,EAAmC;IACpE,eAAe,IAAI,CAAC;AACtB;AAEO,SAAS,YAAY,IAAS;IACnC,IAAI,CAAC,UAAU,OAAO,UAAU,KAAK,OAAO,IAAI,EAAE;IAClD,OAAO,OAAO,IAAI,CAAC;AACrB;AASO,SAAS,WAAW,OAAmB;IAC5C,MAAM,EAAE,UAAU,IAAI,IAAI,EAAE,GAAG;IAE/B,SAAS;QACP,IAAI,QAAQ,OAAO,KAAK;QAExB,QAAQ,GAAG,CAAC;QAEZ,SAAS;YACP,MAAM,YAAY;gBAAE,MAAM;YAA+B;YACzD,eAAe,OAAO,CAAC,CAAC;gBACtB,GAAG;YACL;YAEA,IAAI,QAAQ,GAAG,EAAE,QAAQ,GAAG,CAAC;QAC7B,4BAA4B;QAC9B;QAEA,SAAS,cAAc,KAAmB;YACxC,4BAA4B;YAE5B,MAAM,UAAU;gBACd,MAAM;gBACN,MAAM,KAAK,KAAK,CAAC,MAAM,IAAI;YAC7B;YACA,eAAe,OAAO,CAAC,CAAC;gBACtB,GAAG;YACL;QACF;QAEA,4BAA4B;QAE5B,SAAS;YACP,OAAO,KAAK;YACZ,WAAW,MAAM;QACnB;QAEA,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG;QAC3B,MAAM,WAAW,kBAAkB,QAAQ,WAAW,IAAI;QAC1D,MAAM,cAAc,QAAQ,WAAW,CAAC,OAAO,CAAC,QAAQ;QAExD,IAAI,MAAM,CAAC,EAAE,SAAS,GAAG,EAAE,SAAS,CAAC,EAAE,KAAK,EAC1C,cAAc,CAAC,CAAC,EAAE,YAAY,CAAC,GAAG,GACnC,CAAC;QAEF,IAAI,YAAY,UAAU,CAAC,SAAS;YAClC,MAAM,CAAC,EAAE,SAAS,GAAG,EAAE,YAAY,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QACtD;QAEA,SAAS,IAAI,OAAO,SAAS,CAAC,CAAC,EAAE,IAAI,EAAE,QAAQ,IAAI,CAAC,CAAC;QACrD,OAAO,MAAM,GAAG;QAChB,OAAO,OAAO,GAAG;QACjB,OAAO,SAAS,GAAG;IACrB;IAEA;AACF"}},
    {"offset": {"line": 7563, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 7568, "column": 0}, "map": {"version":3,"sources":["/turbopack/[turbopack]/dev/client/hmr-client.ts"],"sourcesContent":["/// <reference path=\"../../shared/runtime-types.d.ts\" />\n/// <reference path=\"../runtime/base/globals.d.ts\" />\n/// <reference path=\"../runtime/base/protocol.d.ts\" />\n/// <reference path=\"../runtime/base/extensions.d.ts\" />\n\nimport {\n  addMessageListener as turboSocketAddMessageListener,\n  sendMessage as turboSocketSendMessage,\n} from \"./websocket\";\ntype SendMessage = typeof import(\"./websocket\").sendMessage;\n\nexport type ClientOptions = {\n  addMessageListener: typeof import(\"./websocket\").addMessageListener;\n  sendMessage: SendMessage;\n};\n\nexport function connect({\n  // TODO(WEB-1465) Remove this backwards compat fallback once\n  // vercel/next.js#54586 is merged.\n  addMessageListener = turboSocketAddMessageListener,\n  // TODO(WEB-1465) Remove this backwards compat fallback once\n  // vercel/next.js#54586 is merged.\n  sendMessage = turboSocketSendMessage,\n}: ClientOptions) {\n  addMessageListener((msg) => {\n    switch (msg.type) {\n      case \"turbopack-connected\":\n        handleSocketConnected(sendMessage);\n        break;\n      default:\n        if (Array.isArray(msg.data)) {\n          for (let i = 0; i < msg.data.length; i++) {\n            handleSocketMessage(msg.data[i] as ServerMessage);\n          }\n        } else {\n          handleSocketMessage(msg.data as ServerMessage);\n        }\n        applyAggregatedUpdates();\n        break;\n    }\n  });\n\n  const queued = globalThis.TURBOPACK_CHUNK_UPDATE_LISTENERS;\n  if (queued != null && !Array.isArray(queued)) {\n    throw new Error(\"A separate HMR handler was already registered\");\n  }\n  globalThis.TURBOPACK_CHUNK_UPDATE_LISTENERS = {\n    push: ([chunkPath, callback]: [ChunkPath, UpdateCallback]) => {\n      subscribeToChunkUpdate(chunkPath, sendMessage, callback);\n    },\n  };\n\n  if (Array.isArray(queued)) {\n    for (const [chunkPath, callback] of queued) {\n      subscribeToChunkUpdate(chunkPath, sendMessage, callback);\n    }\n  }\n}\n\ntype UpdateCallbackSet = {\n  callbacks: Set<UpdateCallback>;\n  unsubscribe: () => void;\n};\n\nconst updateCallbackSets: Map<ResourceKey, UpdateCallbackSet> = new Map();\n\nfunction sendJSON(sendMessage: SendMessage, message: ClientMessage) {\n  sendMessage(JSON.stringify(message));\n}\n\ntype ResourceKey = string;\n\nfunction resourceKey(resource: ResourceIdentifier): ResourceKey {\n  return JSON.stringify({\n    path: resource.path,\n    headers: resource.headers || null,\n  });\n}\n\nfunction subscribeToUpdates(\n  sendMessage: SendMessage,\n  resource: ResourceIdentifier\n): () => void {\n  sendJSON(sendMessage, {\n    type: \"turbopack-subscribe\",\n    ...resource,\n  });\n\n  return () => {\n    sendJSON(sendMessage, {\n      type: \"turbopack-unsubscribe\",\n      ...resource,\n    });\n  };\n}\n\nfunction handleSocketConnected(sendMessage: SendMessage) {\n  for (const key of updateCallbackSets.keys()) {\n    subscribeToUpdates(sendMessage, JSON.parse(key));\n  }\n}\n\n// we aggregate all pending updates until the issues are resolved\nconst chunkListsWithPendingUpdates: Map<ResourceKey, PartialServerMessage> =\n  new Map();\n\nfunction aggregateUpdates(msg: PartialServerMessage) {\n  const key = resourceKey(msg.resource);\n  let aggregated = chunkListsWithPendingUpdates.get(key);\n\n  if (aggregated) {\n    aggregated.instruction = mergeChunkListUpdates(\n      aggregated.instruction,\n      msg.instruction\n    );\n  } else {\n    chunkListsWithPendingUpdates.set(key, msg);\n  }\n}\n\nfunction applyAggregatedUpdates() {\n  if (chunkListsWithPendingUpdates.size === 0) return;\n  hooks.beforeRefresh();\n  for (const msg of chunkListsWithPendingUpdates.values()) {\n    triggerUpdate(msg);\n  }\n  chunkListsWithPendingUpdates.clear();\n  finalizeUpdate();\n}\n\nfunction mergeChunkListUpdates(\n  updateA: ChunkListUpdate,\n  updateB: ChunkListUpdate\n): ChunkListUpdate {\n  let chunks;\n  if (updateA.chunks != null) {\n    if (updateB.chunks == null) {\n      chunks = updateA.chunks;\n    } else {\n      chunks = mergeChunkListChunks(updateA.chunks, updateB.chunks);\n    }\n  } else if (updateB.chunks != null) {\n    chunks = updateB.chunks;\n  }\n\n  let merged;\n  if (updateA.merged != null) {\n    if (updateB.merged == null) {\n      merged = updateA.merged;\n    } else {\n      // Since `merged` is an array of updates, we need to merge them all into\n      // one, consistent update.\n      // Since there can only be `EcmascriptMergeUpdates` in the array, there is\n      // no need to key on the `type` field.\n      let update = updateA.merged[0];\n      for (let i = 1; i < updateA.merged.length; i++) {\n        update = mergeChunkListEcmascriptMergedUpdates(\n          update,\n          updateA.merged[i]\n        );\n      }\n\n      for (let i = 0; i < updateB.merged.length; i++) {\n        update = mergeChunkListEcmascriptMergedUpdates(\n          update,\n          updateB.merged[i]\n        );\n      }\n\n      merged = [update];\n    }\n  } else if (updateB.merged != null) {\n    merged = updateB.merged;\n  }\n\n  return {\n    type: \"ChunkListUpdate\",\n    chunks,\n    merged,\n  };\n}\n\nfunction mergeChunkListChunks(\n  chunksA: Record<ChunkPath, ChunkUpdate>,\n  chunksB: Record<ChunkPath, ChunkUpdate>\n): Record<ChunkPath, ChunkUpdate> {\n  const chunks: Record<ChunkPath, ChunkUpdate> = {};\n\n  for (const [chunkPath, chunkUpdateA] of Object.entries(chunksA)) {\n    const chunkUpdateB = chunksB[chunkPath];\n    if (chunkUpdateB != null) {\n      const mergedUpdate = mergeChunkUpdates(chunkUpdateA, chunkUpdateB);\n      if (mergedUpdate != null) {\n        chunks[chunkPath] = mergedUpdate;\n      }\n    } else {\n      chunks[chunkPath] = chunkUpdateA;\n    }\n  }\n\n  for (const [chunkPath, chunkUpdateB] of Object.entries(chunksB)) {\n    if (chunks[chunkPath] == null) {\n      chunks[chunkPath] = chunkUpdateB;\n    }\n  }\n\n  return chunks;\n}\n\nfunction mergeChunkUpdates(\n  updateA: ChunkUpdate,\n  updateB: ChunkUpdate\n): ChunkUpdate | undefined {\n  if (\n    (updateA.type === \"added\" && updateB.type === \"deleted\") ||\n    (updateA.type === \"deleted\" && updateB.type === \"added\")\n  ) {\n    return undefined;\n  }\n\n  if (updateA.type === \"partial\") {\n    invariant(updateA.instruction, \"Partial updates are unsupported\");\n  }\n\n  if (updateB.type === \"partial\") {\n    invariant(updateB.instruction, \"Partial updates are unsupported\");\n  }\n\n  return undefined;\n}\n\nfunction mergeChunkListEcmascriptMergedUpdates(\n  mergedA: EcmascriptMergedUpdate,\n  mergedB: EcmascriptMergedUpdate\n): EcmascriptMergedUpdate {\n  const entries = mergeEcmascriptChunkEntries(mergedA.entries, mergedB.entries);\n  const chunks = mergeEcmascriptChunksUpdates(mergedA.chunks, mergedB.chunks);\n\n  return {\n    type: \"EcmascriptMergedUpdate\",\n    entries,\n    chunks,\n  };\n}\n\nfunction mergeEcmascriptChunkEntries(\n  entriesA: Record<ModuleId, EcmascriptModuleEntry> | undefined,\n  entriesB: Record<ModuleId, EcmascriptModuleEntry> | undefined\n): Record<ModuleId, EcmascriptModuleEntry> {\n  return { ...entriesA, ...entriesB };\n}\n\nfunction mergeEcmascriptChunksUpdates(\n  chunksA: Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined,\n  chunksB: Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined\n): Record<ChunkPath, EcmascriptMergedChunkUpdate> | undefined {\n  if (chunksA == null) {\n    return chunksB;\n  }\n\n  if (chunksB == null) {\n    return chunksA;\n  }\n\n  const chunks: Record<ChunkPath, EcmascriptMergedChunkUpdate> = {};\n\n  for (const [chunkPath, chunkUpdateA] of Object.entries(chunksA)) {\n    const chunkUpdateB = chunksB[chunkPath];\n    if (chunkUpdateB != null) {\n      const mergedUpdate = mergeEcmascriptChunkUpdates(\n        chunkUpdateA,\n        chunkUpdateB\n      );\n      if (mergedUpdate != null) {\n        chunks[chunkPath] = mergedUpdate;\n      }\n    } else {\n      chunks[chunkPath] = chunkUpdateA;\n    }\n  }\n\n  for (const [chunkPath, chunkUpdateB] of Object.entries(chunksB)) {\n    if (chunks[chunkPath] == null) {\n      chunks[chunkPath] = chunkUpdateB;\n    }\n  }\n\n  if (Object.keys(chunks).length === 0) {\n    return undefined;\n  }\n\n  return chunks;\n}\n\nfunction mergeEcmascriptChunkUpdates(\n  updateA: EcmascriptMergedChunkUpdate,\n  updateB: EcmascriptMergedChunkUpdate\n): EcmascriptMergedChunkUpdate | undefined {\n  if (updateA.type === \"added\" && updateB.type === \"deleted\") {\n    // These two completely cancel each other out.\n    return undefined;\n  }\n\n  if (updateA.type === \"deleted\" && updateB.type === \"added\") {\n    const added = [];\n    const deleted = [];\n    const deletedModules = new Set(updateA.modules ?? []);\n    const addedModules = new Set(updateB.modules ?? []);\n\n    for (const moduleId of addedModules) {\n      if (!deletedModules.has(moduleId)) {\n        added.push(moduleId);\n      }\n    }\n\n    for (const moduleId of deletedModules) {\n      if (!addedModules.has(moduleId)) {\n        deleted.push(moduleId);\n      }\n    }\n\n    if (added.length === 0 && deleted.length === 0) {\n      return undefined;\n    }\n\n    return {\n      type: \"partial\",\n      added,\n      deleted,\n    };\n  }\n\n  if (updateA.type === \"partial\" && updateB.type === \"partial\") {\n    const added = new Set([...(updateA.added ?? []), ...(updateB.added ?? [])]);\n    const deleted = new Set([\n      ...(updateA.deleted ?? []),\n      ...(updateB.deleted ?? []),\n    ]);\n\n    if (updateB.added != null) {\n      for (const moduleId of updateB.added) {\n        deleted.delete(moduleId);\n      }\n    }\n\n    if (updateB.deleted != null) {\n      for (const moduleId of updateB.deleted) {\n        added.delete(moduleId);\n      }\n    }\n\n    return {\n      type: \"partial\",\n      added: [...added],\n      deleted: [...deleted],\n    };\n  }\n\n  if (updateA.type === \"added\" && updateB.type === \"partial\") {\n    const modules = new Set([\n      ...(updateA.modules ?? []),\n      ...(updateB.added ?? []),\n    ]);\n\n    for (const moduleId of updateB.deleted ?? []) {\n      modules.delete(moduleId);\n    }\n\n    return {\n      type: \"added\",\n      modules: [...modules],\n    };\n  }\n\n  if (updateA.type === \"partial\" && updateB.type === \"deleted\") {\n    // We could eagerly return `updateB` here, but this would potentially be\n    // incorrect if `updateA` has added modules.\n\n    const modules = new Set(updateB.modules ?? []);\n\n    if (updateA.added != null) {\n      for (const moduleId of updateA.added) {\n        modules.delete(moduleId);\n      }\n    }\n\n    return {\n      type: \"deleted\",\n      modules: [...modules],\n    };\n  }\n\n  // Any other update combination is invalid.\n\n  return undefined;\n}\n\nfunction invariant(never: never, message: string): never {\n  throw new Error(`Invariant: ${message}`);\n}\n\nconst CRITICAL = [\"bug\", \"error\", \"fatal\"];\n\nfunction compareByList(list: any[], a: any, b: any) {\n  const aI = list.indexOf(a) + 1 || list.length;\n  const bI = list.indexOf(b) + 1 || list.length;\n  return aI - bI;\n}\n\nconst chunksWithIssues: Map<ResourceKey, Issue[]> = new Map();\n\nfunction emitIssues() {\n  const issues = [];\n  const deduplicationSet = new Set();\n\n  for (const [_, chunkIssues] of chunksWithIssues) {\n    for (const chunkIssue of chunkIssues) {\n      if (deduplicationSet.has(chunkIssue.formatted)) continue;\n\n      issues.push(chunkIssue);\n      deduplicationSet.add(chunkIssue.formatted);\n    }\n  }\n\n  sortIssues(issues);\n\n  hooks.issues(issues);\n}\n\nfunction handleIssues(msg: ServerMessage): boolean {\n  const key = resourceKey(msg.resource);\n  let hasCriticalIssues = false;\n\n  for (const issue of msg.issues) {\n    if (CRITICAL.includes(issue.severity)) {\n      hasCriticalIssues = true;\n    }\n  }\n\n  if (msg.issues.length > 0) {\n    chunksWithIssues.set(key, msg.issues);\n  } else if (chunksWithIssues.has(key)) {\n    chunksWithIssues.delete(key);\n  }\n\n  emitIssues();\n\n  return hasCriticalIssues;\n}\n\nconst SEVERITY_ORDER = [\"bug\", \"fatal\", \"error\", \"warning\", \"info\", \"log\"];\nconst CATEGORY_ORDER = [\n  \"parse\",\n  \"resolve\",\n  \"code generation\",\n  \"rendering\",\n  \"typescript\",\n  \"other\",\n];\n\nfunction sortIssues(issues: Issue[]) {\n  issues.sort((a, b) => {\n    const first = compareByList(SEVERITY_ORDER, a.severity, b.severity);\n    if (first !== 0) return first;\n    return compareByList(CATEGORY_ORDER, a.category, b.category);\n  });\n}\n\nconst hooks = {\n  beforeRefresh: () => {},\n  refresh: () => {},\n  buildOk: () => {},\n  issues: (issues: Issue[]) => {},\n};\n\nexport function setHooks(newHooks: typeof hooks) {\n  Object.assign(hooks, newHooks);\n}\n\nfunction handleSocketMessage(msg: ServerMessage) {\n  sortIssues(msg.issues);\n\n  handleIssues(msg);\n\n  switch (msg.type) {\n    case \"issues\":\n      // issues are already handled\n      break;\n    case \"partial\":\n      // aggregate updates\n      aggregateUpdates(msg);\n      break;\n    default:\n      // run single update\n      const runHooks = chunkListsWithPendingUpdates.size === 0;\n      if (runHooks) hooks.beforeRefresh();\n      triggerUpdate(msg);\n      if (runHooks) finalizeUpdate();\n      break;\n  }\n}\n\nfunction finalizeUpdate() {\n  hooks.refresh();\n  hooks.buildOk();\n\n  // This is used by the Next.js integration test suite to notify it when HMR\n  // updates have been completed.\n  // TODO: Only run this in test environments (gate by `process.env.__NEXT_TEST_MODE`)\n  if (globalThis.__NEXT_HMR_CB) {\n    globalThis.__NEXT_HMR_CB();\n    globalThis.__NEXT_HMR_CB = null;\n  }\n}\n\nfunction subscribeToChunkUpdate(\n  chunkPath: ChunkPath,\n  sendMessage: SendMessage,\n  callback: UpdateCallback\n): () => void {\n  return subscribeToUpdate(\n    {\n      path: chunkPath,\n    },\n    sendMessage,\n    callback\n  );\n}\n\nexport function subscribeToUpdate(\n  resource: ResourceIdentifier,\n  sendMessage: SendMessage,\n  callback: UpdateCallback\n) {\n  // TODO(WEB-1465) Remove this backwards compat fallback once\n  // vercel/next.js#54586 is merged.\n  if (callback === undefined) {\n    callback = sendMessage;\n    sendMessage = turboSocketSendMessage;\n  }\n\n  const key = resourceKey(resource);\n  let callbackSet: UpdateCallbackSet;\n  const existingCallbackSet = updateCallbackSets.get(key);\n  if (!existingCallbackSet) {\n    callbackSet = {\n      callbacks: new Set([callback]),\n      unsubscribe: subscribeToUpdates(sendMessage, resource),\n    };\n    updateCallbackSets.set(key, callbackSet);\n  } else {\n    existingCallbackSet.callbacks.add(callback);\n    callbackSet = existingCallbackSet;\n  }\n\n  return () => {\n    callbackSet.callbacks.delete(callback);\n\n    if (callbackSet.callbacks.size === 0) {\n      callbackSet.unsubscribe();\n      updateCallbackSets.delete(key);\n    }\n  };\n}\n\nfunction triggerUpdate(msg: ServerMessage) {\n  const key = resourceKey(msg.resource);\n  const callbackSet = updateCallbackSets.get(key);\n  if (!callbackSet) {\n    return;\n  }\n\n  try {\n    for (const callback of callbackSet.callbacks) {\n      callback(msg);\n    }\n\n    if (msg.type === \"notFound\") {\n      // This indicates that the resource which we subscribed to either does not exist or\n      // has been deleted. In either case, we should clear all update callbacks, so if a\n      // new subscription is created for the same resource, it will send a new \"subscribe\"\n      // message to the server.\n      // No need to send an \"unsubscribe\" message to the server, it will have already\n      // dropped the update stream before sending the \"notFound\" message.\n      updateCallbackSets.delete(key);\n    }\n  } catch (err) {\n    console.error(\n      `An error occurred during the update of resource \\`${msg.resource.path}\\``,\n      err\n    );\n    location.reload();\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8036, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}