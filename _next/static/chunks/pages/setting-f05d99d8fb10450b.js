(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{45824:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/setting",function(){return s(97402)}])},97402:function(e,t,s){"use strict";s.r(t),s.d(t,{SettingsPage:function(){return U},default:function(){return B}});var l=s(85893),n=s(16702),a=s(86204),r=s(71054),i=s(67294),c=s(65058),o=s(37039),x=s(93513),d=s(23482);const m=i.forwardRef(((e,t)=>{let{className:s,...n}=e;return(0,l.jsx)("div",{ref:t,className:(0,d.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})}));m.displayName="Card";const u=i.forwardRef(((e,t)=>{let{className:s,...n}=e;return(0,l.jsx)("div",{ref:t,className:(0,d.cn)("flex flex-col space-y-1.5 p-6",s),...n})}));u.displayName="CardHeader";const h=i.forwardRef(((e,t)=>{let{className:s,...n}=e;return(0,l.jsx)("h3",{ref:t,className:(0,d.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})}));h.displayName="CardTitle";const f=i.forwardRef(((e,t)=>{let{className:s,...n}=e;return(0,l.jsx)("p",{ref:t,className:(0,d.cn)("text-sm text-muted-foreground",s),...n})}));f.displayName="CardDescription";const j=i.forwardRef(((e,t)=>{let{className:s,...n}=e;return(0,l.jsx)("div",{ref:t,className:(0,d.cn)("p-6 pt-0",s),...n})}));j.displayName="CardContent";const g=i.forwardRef(((e,t)=>{let{className:s,...n}=e;return(0,l.jsx)("div",{ref:t,className:(0,d.cn)("flex items-center p-6 pt-0",s),...n})}));g.displayName="CardFooter";var w=s(30080);const p=e=>{let{index:t}=e;const{connected:s,calibration:a,setCalibration:r}=(0,c.Z)(),[d,g]=(0,i.useState)(new Array(100).fill({temperature:0,power:0})),{t:p}=(0,o.$G)(),{flowmeterDisplay:y}=(0,c.Z)(),[N,b]=(0,i.useState)(!1),v=(0,l.jsx)(l.Fragment,{}),[C,R]=(0,i.useState)(!0),[S,k]=(0,i.useState)(y[t].flowCount),[I,F]=(0,i.useState)(1e3);return(0,i.useEffect)((()=>{k(y[t].flowCount)}),[y,t]),(0,l.jsxs)(l.Fragment,{children:[N&&(0,l.jsx)(n.u_l,{size:"small",title:p("Calibrate flowmeter"),onClose:()=>b(!1),primaryAction:{label:"OK",onPress:()=>{b(!1),function(){var e=S,s=e/y[t].flowCount*a.flowmeter[t];console.log("calibration/ ",{calibration:a,suggestedValue:e,previousValue:y[t].flowCount,currentCalibration:a.flowmeter[t],newCalibration:s}),s<0||s>1e3?console.warn("Invalid calibation"):r((0,x.Uy)(a,(e=>(e.flowmeter[t]=s,e))))}()}},secondaryAction:{label:"Cancel",onPress:()=>b(!1)},children:(0,l.jsxs)(n.Kqy,{space:8,children:[(0,l.jsx)(n.jL0,{kind:"informative",title:p("Notice"),description:p("This calibration process is to set the conversion between flowmeter pulses count with the actual total weight of water extracted, specify how much it is actually weight to update the conversion"),action:{label:p("Learn more"),onPress:()=>{window.open("https://www.google.com")}}}),(0,l.jsx)(n.RWL,{type:"single",name:"value",label:p("Real weight (gram)"),value:S,onChange:e=>{k(e)},minValue:0,maxValue:I,step:1})]})}),(0,l.jsxs)(m,{className:"w-auto m-4",children:[(0,l.jsxs)(u,{children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)(h,{children:[p("Group")," ",t+1]}),(0,l.jsx)(n.zxk,{onPress:function(){0!=S&&(F(Math.max(2*S,200)),b(!0))},hierarchy:"secondary",kind:"outline",label:p("Calibrate"),size:"small",icon:()=>(0,l.jsx)(w.b9P,{})})]}),(0,l.jsx)(n.izJ,{}),(0,l.jsx)(f,{children:(0,l.jsxs)("div",{className:"h-16 bg-white flex flex-col justify-evenly space-y-4 mt-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{children:p("Flowrate ")}),(0,l.jsxs)("h1",{className:"text-xl",children:[y[t].flowRate," gram/s"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{children:p("Weight")}),(0,l.jsxs)("h1",{className:"text-xl",children:[y[t].flowCount," gram"]})]})]})})]}),(0,l.jsx)(j,{children:C?(0,l.jsx)(l.Fragment,{children:v}):null})]})]})};var y=s(19151);const N=e=>{let{key:t,index:s}=e;const{grinderSettings:r,setGrinderSettings:i}=(0,c.Z)();return console.log("Grinder/ create ",t),(0,l.jsxs)("div",{className:"flex flex-col  space-y-4 rounded-xl bg-white p-4",children:[(0,l.jsx)(n.nvn,{name:"ingredient",label:"Ingredient",placeholder:"What is the coffee bean ?",value:r[s].name,onChange:e=>{i((0,x.Uy)(r,(t=>{t[s].name=e})))}}),(0,l.jsx)("div",{className:"flex flex-grow flex-row justify-stretch space-x-4",children:(0,l.jsxs)(n.oeA,{space:8,children:[(0,l.jsx)(n.sgG,{width:"4/5",children:(0,l.jsx)(n.mgC,{value:r[s].connectionType,onChange:e=>{i((0,x.Uy)(r,(t=>{t[s].connectionType=e})))},name:"connectionType",label:"Connection",placeholder:"How is the grinder connected ?",options:[{value:"wire",label:"Wire",kind:"two-line",secondLine:"Direct wiring using the PID port"},{value:"ble",label:"Bluetooth",kind:"two-line",secondLine:"Pair to a Bluetooth scale"}]})}),(0,l.jsx)(n.sgG,{width:"1/5",children:(0,l.jsx)(n.Ki0,{name:"ID",value:r[s].connectionId,onChange:e=>{i((0,x.Uy)(r,(t=>{t[s].connectionId=e})))},label:"ID"})})]})}),(0,l.jsxs)("div",{className:"my-4 flex flex-row space-x-4",children:[(0,l.jsx)(n.zxk,{label:"Calibrate",onPress:()=>{},hierarchy:"primary",kind:"outline",icon:()=>(0,l.jsx)(a.mdD,{})}),(0,l.jsx)(n.zxk,{label:"Test",onPress:()=>{},hierarchy:"primary",kind:"outline",icon:()=>(0,l.jsx)(y.WuV,{})}),(0,l.jsx)(n.zxk,{label:"Remove",onPress:()=>{},hierarchy:"danger",kind:"outline",icon:()=>(0,l.jsx)(w.ZkW,{})})]})]})};var b=s(55903),v=s(64399);const C=e=>{let{index:t}=e;const{pidState:s,setPidState:a,pidDisplay:r}=(0,c.Z)(),{connected:d}=(0,c.Z)(),[p,N]=(0,i.useState)(new Array(100).fill({temperature:0,power:0}));(0,i.useEffect)((()=>{if(void 0==r[t].powerSamples)return;const e=[];for(var l=0;l<r[t].powerSamples.length;l++)e.push({power:r[t].powerSamples[l],temperature:Math.round(10*r[t].temperatureSamples[l])/10,target:Math.round(10*s[t].targetTemperature)/10});N(e)}),[r,t,s]);const{t:C}=(0,o.$G)();(0,i.useEffect)((()=>{}),[r,t,s]);const R=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.RWL,{type:"single",name:"value",label:C("Temperature"),value:s[t].targetTemperature,onChange:e=>{a((0,x.Uy)(s,(s=>(s[t].targetTemperature=e,s))))},minValue:0,maxValue:200,step:1,disabled:!d}),(0,l.jsx)(n.RWL,{type:"single",name:"value",label:C("Active Range"),value:s[t].activeRange,onChange:e=>{a((0,x.Uy)(s,(s=>(s[t].activeRange=e,s))))},minValue:0,maxValue:10,step:1,disabled:!d}),(0,l.jsx)(n.RWL,{type:"single",name:"value",label:"Proportional",value:s[t].proportional,onChange:e=>{a((0,x.Uy)(s,(s=>{s[t].proportional=e})))},minValue:0,maxValue:10,step:.1,disabled:!d}),(0,l.jsx)(n.RWL,{type:"single",name:"value",label:"integral",value:s[t].integral,onChange:e=>{a((0,x.Uy)(s,(s=>{s[t].integral=e})))},minValue:0,maxValue:1,step:.1,disabled:!d}),(0,l.jsx)(n.RWL,{type:"single",name:"value",label:"Derivative",value:s[t].derivative,onChange:e=>{a((0,x.Uy)(s,(s=>{s[t].derivative=e})))},minValue:0,maxValue:10,step:.1,disabled:!d})]}),[S,k]=(0,i.useState)(!0),I=(0,l.jsxs)("div",{className:"flex flex-wrap justify-center space-x-1 space-y-1 mb-4",children:[(0,l.jsx)(n.zxk,{onPress:()=>{},hierarchy:"primary",kind:"outline",label:"Test",size:"small",icon:()=>(0,l.jsx)(y.WuV,{})}),(0,l.jsx)(n.zxk,{onPress:()=>{a((0,x.Uy)(s,(e=>{e[t].targetTemperature=110,e[t].activeRange=2,e[t].proportional=3.2,e[t].integral=.2,e[t].derivative=5})))},hierarchy:"danger",kind:"outline",size:"small",label:"Reset",icon:()=>(0,l.jsx)(v.Z4w,{})})]});return(0,l.jsxs)(m,{className:"w-auto",children:[(0,l.jsxs)(u,{children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)(h,{children:[C("Channel")," ",t+1]}),(0,l.jsx)(n.rsf,{value:s[t].isActive,onChange:e=>{a((0,x.Uy)(s,(s=>(s[t].isActive=e,s))))},label:C("Active")})]}),(0,l.jsx)(b.j,{}),(0,l.jsx)(f,{children:s[t].isActive?(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(m,{className:"h-40 bg-white",children:[(0,l.jsx)(n.wWH,{hideLegend:!1,hideXAxis:!0,dataKey:"name",categories:["temperature","power","target"],disableAnimation:!0,hideYAxis:!0,hideTooltip:!1,data:p})," "]})}):(0,l.jsx)(l.Fragment,{children:C("This PID channel is currently disabled")})})]}),s[t].isActive?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j,{children:S?(0,l.jsxs)(l.Fragment,{children:[I,R]}):null}),(0,l.jsx)(g,{onClick:()=>{k(!S)},className:"justify-center",children:S?(0,l.jsx)(w.Faw,{}):(0,l.jsx)(w.Yc6,{})})]}):null]})};var R=s(62740),S=s(24862),k=s(19314),I=s(22845),F=s(11163),P=s(52091),G=s(87771),A=s(7696),E=s(12006);const V=()=>{const{t:e}=(0,o.$G)(),[t,s]=(0,i.useState)(!1),[r,c]=(0,i.useState)(!1),x=()=>{s(!t),console.log("toggle expand")},d=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if(!t&&d.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);d.current.getBoundingClientRect().top}}),[t]),(0,l.jsxs)(R.w,{ref:d,className:"w-full max-w-2xl transform bg-gradient-to-r from-purple-600 to-red-600 transition duration-500 ",children:[(0,l.jsxs)(S.u,{className:"flex h-16 flex-row items-center justify-between",onClick:x,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(a.YzZ,{className:"ml-4 text-white"}),(0,l.jsx)("h2",{className:"mx-4 font-bold text-white",children:e("Heater")})]}),t?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Ix0,{className:"mr-4 text-white"})}):(0,l.jsx)(w.AeI,{className:"mr-4 text-white"})]}),t?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:[(0,l.jsx)(C,{index:0}),(0,l.jsx)(C,{index:1}),(0,l.jsx)(C,{index:2})]}),(0,l.jsx)(I.i,{onClick:x,className:"align-center justify-center",children:(0,l.jsx)(w.rWj,{className:"m-4 text-white"})})]}):null,r&&(0,l.jsx)(n.u_l,{title:"Calibrate flowmeter",size:"small",onClose:()=>c(!1),primaryAction:{label:"OK",onPress:()=>c(!1)},secondaryAction:{label:"Cancel",onPress:()=>c(!1)},autoFocus:!1,children:(0,l.jsx)(n.eBu,{space:4,children:(0,l.jsx)(n.uTp,{size:"medium",children:"Content"})})})]})},W=()=>{const[e,t]=(0,i.useState)(!1),{t:s}=(0,o.$G)(),n=()=>{t(!e),console.log("toggle expand")},r=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if(!e&&r.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);r.current.getBoundingClientRect().top}}),[e]),(0,l.jsxs)(R.w,{ref:r,className:"w-full max-w-2xl transform bg-gradient-to-r from-blue-600 to-green-600 transition duration-500 ",children:[(0,l.jsxs)(S.u,{className:"flex h-16 flex-row items-center justify-between",onClick:n,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(a.E3g,{className:"ml-4 text-white"}),(0,l.jsx)("h2",{className:"mx-4 font-bold text-white",children:s("Flowmeter")})]}),e?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Ix0,{className:"mr-4 text-white"})}):(0,l.jsx)(w.AeI,{className:"mr-4 text-white"})]}),e?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex w-full flex-col justify-center space-y-4 py-4",children:[(0,l.jsx)(p,{index:0}),(0,l.jsx)(p,{index:1}),(0,l.jsx)(p,{index:2})]}),(0,l.jsx)(I.i,{onClick:n,className:"align-center justify-center",children:(0,l.jsx)(w.rWj,{className:"m-4 text-white"})})]}):null]})},L=()=>{const{locale:e,locales:t,defaultLocale:s}=(0,F.useRouter)(),[n,a]=(0,i.useState)(!1),{grinderSettings:x}=(0,c.Z)(),{t:d}=(0,o.$G)(),m=()=>{console.log("toggle expand")},u=(0,i.useRef)(null);(0,i.useEffect)((()=>{if(!n&&u.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);u.current.getBoundingClientRect().top}}),[n]);return(0,l.jsxs)(R.w,{ref:u,className:"w-full max-w-2xl transform bg-gradient-to-r from-orange-600 to-yellow-600 transition duration-500 ",children:[(0,l.jsxs)(S.u,{className:"flex h-16 flex-row items-center justify-between",onClick:m,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(r.nXt,{className:"ml-4 text-white"}),(0,l.jsx)("h2",{className:"mx-4 font-bold text-white",children:d("Grinder")})]}),n?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Ix0,{className:"mr-4 text-white"})}):(0,l.jsx)(w.AeI,{className:"mr-4 text-white"})]}),n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:x.map(((e,t)=>(console.log("Grinder/ create with",{item:e,index:t}),(0,l.jsx)(N,{index:t},t))))}),(0,l.jsx)(I.i,{onClick:m,className:"align-center justify-center",children:(0,l.jsx)(w.rWj,{className:"m-4 text-white"})})]}):null]})},T=()=>{const{locale:e,locales:t,defaultLocale:s}=(0,F.useRouter)(),[n,a]=(0,i.useState)(!1),{grinderSettings:r}=(0,c.Z)(),{t:x}=(0,o.$G)(),d=()=>{console.log("toggle expand")},m=(0,i.useRef)(null);(0,i.useEffect)((()=>{if(!n&&m.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);m.current.getBoundingClientRect().top}}),[n]);return(0,l.jsxs)(R.w,{ref:m,className:"w-full max-w-2xl transform bg-gradient-to-r from-yellow-600 to-orange-600 transition duration-500 ",children:[(0,l.jsxs)(S.u,{className:"flex h-16 flex-row items-center justify-between",onClick:d,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(P.pno,{className:"ml-4 text-white"}),(0,l.jsx)("h2",{className:"mx-4 font-bold text-white",children:x("Scale")})]}),n?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Ix0,{className:"mr-4 text-white"})}):(0,l.jsx)(w.AeI,{className:"mr-4 text-white"})]}),n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:r.map(((e,t)=>(console.log("Grinder/ create with",{item:e,index:t}),(0,l.jsx)(N,{index:t},t))))}),(0,l.jsx)(I.i,{onClick:d,className:"align-center justify-center",children:(0,l.jsx)(w.rWj,{className:"m-4 text-white"})})]}):null]})},z=()=>{const{locale:e,locales:t,defaultLocale:s}=(0,F.useRouter)(),[n,a]=(0,i.useState)(!1),{grinderSettings:r}=(0,c.Z)(),{t:x}=(0,o.$G)(),d=()=>{console.log("toggle expand")},m=(0,i.useRef)(null);(0,i.useEffect)((()=>{if(!n&&m.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);m.current.getBoundingClientRect().top}}),[n]);return(0,l.jsxs)(R.w,{ref:m,className:"w-full max-w-2xl transform bg-gradient-to-r from-teal-600 to-green-600 transition duration-500 ",children:[(0,l.jsxs)(S.u,{className:"flex h-16 flex-row items-center justify-between",onClick:d,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(G.dfw,{className:"ml-4 text-white"}),(0,l.jsx)("h2",{className:"mx-4 font-bold text-white",children:x("Sound")})]}),n?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Ix0,{className:"mr-4 text-white"})}):(0,l.jsx)(w.AeI,{className:"mr-4 text-white"})]}),n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:r.map(((e,t)=>(console.log("Grinder/ create with",{item:e,index:t}),(0,l.jsx)(N,{index:t},t))))}),(0,l.jsx)(I.i,{onClick:d,className:"align-center justify-center",children:(0,l.jsx)(w.rWj,{className:"m-4 text-white"})})]}):null]})},_=()=>{const{locale:e,locales:t,defaultLocale:s}=(0,F.useRouter)(),[n,a]=(0,i.useState)(!1),{grinderSettings:r}=(0,c.Z)(),{t:x}=(0,o.$G)(),d=()=>{console.log("toggle expand")},m=(0,i.useRef)(null);(0,i.useEffect)((()=>{if(!n&&m.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);m.current.getBoundingClientRect().top}}),[n]);return(0,l.jsxs)(R.w,{ref:m,className:"w-full max-w-2xl transform bg-gradient-to-r from-red-600  to-red-400 transition duration-500 ",children:[(0,l.jsxs)(S.u,{className:"flex h-16 flex-row items-center justify-between",onClick:d,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(P.iih,{className:"ml-4 text-white"}),(0,l.jsx)("h2",{className:"mx-4 font-bold text-white",children:x("Light")})]}),n?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Ix0,{className:"mr-4 text-white"})}):(0,l.jsx)(w.AeI,{className:"mr-4 text-white"})]}),n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:r.map(((e,t)=>(console.log("Grinder/ create with",{item:e,index:t}),(0,l.jsx)(N,{index:t},t))))}),(0,l.jsx)(I.i,{onClick:d,className:"align-center justify-center",children:(0,l.jsx)(w.rWj,{className:"m-4 text-white"})})]}):null]})},Z=()=>{const{locale:e,locales:t,defaultLocale:s}=(0,F.useRouter)(),[n,a]=(0,i.useState)(!1),{grinderSettings:r}=(0,c.Z)(),{t:x}=(0,o.$G)(),d=()=>{console.log("toggle expand")},m=(0,i.useRef)(null);(0,i.useEffect)((()=>{if(!n&&m.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);m.current.getBoundingClientRect().top}}),[n]);return(0,l.jsxs)(R.w,{ref:m,className:"w-full max-w-2xl transform bg-gradient-to-r from-blue-600  to-blue-400 transition duration-500 ",children:[(0,l.jsxs)(S.u,{className:"flex h-16 flex-row items-center justify-between",onClick:d,children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(A.Ll6,{className:"ml-4 text-white"}),(0,l.jsx)("h2",{className:"mx-4 font-bold text-white",children:x("Keyboard")})]}),n?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Ix0,{className:"mr-4 text-white"})}):(0,l.jsx)(w.AeI,{className:"mr-4 text-white"})]}),n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:r.map(((e,t)=>(console.log("Grinder/ create with",{item:e,index:t}),(0,l.jsx)(N,{index:t},t))))}),(0,l.jsx)(I.i,{onClick:d,className:"align-center justify-center",children:(0,l.jsx)(w.rWj,{className:"m-4 text-white"})})]}):null]})},U=()=>(0,l.jsx)(E.default,{children:(0,l.jsxs)("div",{className:" flex flex-col items-center  p-8 space-y-4",children:[(0,l.jsx)(V,{}),(0,l.jsx)(W,{}),(0,l.jsx)(L,{}),(0,l.jsx)(T,{}),(0,l.jsx)(z,{}),(0,l.jsx)(_,{}),(0,l.jsx)(Z,{})]})});var B=U}},function(e){e.O(0,[838,396,660,817,509,127,365,594,391,653,317,578,426,115,6,774,888,179],(function(){return t=45824,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=setting-f05d99d8fb10450b.js.map