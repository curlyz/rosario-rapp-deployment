{"version":3,"file":"static/chunks/pages/lab-f421746fea02f3d6.js","mappings":"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","sources":["webpack://_N_E/","webpack://_N_E/./src/components/NewStepCard/components/ActionRune.tsx","webpack://_N_E/./src/components/NewStepCard/components/GrinderRune.tsx","webpack://_N_E/./src/components/ui/popover.tsx","webpack://_N_E/./src/components/ui/separator.tsx","webpack://_N_E/./src/components/NewStepCard/components/TextRune.tsx","webpack://_N_E/./src/components/NewStepCard/components/TimeRune.tsx","webpack://_N_E/./src/components/NewStepCard/components/ProfileRune.tsx","webpack://_N_E/./src/components/NewStepCard/components/IngredientRune.tsx","webpack://_N_E/./src/components/NewStepCard/components/PumpRune.tsx","webpack://_N_E/./src/components/NewStepCard/components/WeightRune.tsx","webpack://_N_E/./src/components/NewStepCard/index.tsx","webpack://_N_E/./src/pages/lab.tsx"],"sourcesContent":["\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/lab\",\n      function () {\n        return require(\"private-next-pages/lab.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/lab\"])\n      });\n    }\n  ","import {\n  EnumAction,\n  EnumProfileType,\n  EnumTarget,\n  IAction,\n  IProfileParam,\n  ITarget,\n} from \"@/gateway/formula/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { Button, Modal, Tiles } from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useEffect, useState } from \"react\";\n// import { OptionItem } from \"./OptionItem\";\n\nimport { useSelectedLanguage } from \"next-export-i18n\";\nimport { useTranslation } from \"react-i18next\";\nimport { AiFillSound } from \"react-icons/ai\";\nimport { FaChartArea } from \"react-icons/fa\";\nimport { FaClock } from \"react-icons/fa6\";\nimport { GiManualMeatGrinder } from \"react-icons/gi\";\nimport { IoWaterSharp } from \"react-icons/io5\";\nimport { LiaFillDripSolid } from \"react-icons/lia\";\nimport { TbColorFilter } from \"react-icons/tb\";\nexport const ActionRune = ({ index }: { index: number }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n\n  const [action, setAction] = useState<EnumAction>(\n    formulas[selectedFormulaId].steps[index].action.actionType as EnumAction,\n  );\n  const step = formulas[selectedFormulaId].steps[index];\n  const { t } = useTranslation();\n  const { lang } = useSelectedLanguage();\n\n  function handleChangeAction(e: EnumAction) {\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index].action as IAction;\n        action.actionType = e as EnumAction;\n        const target = draft[selectedFormulaId].steps[index].target as ITarget;\n\n        // set the target\n        if (e == EnumAction.Grind) {\n          target.targetType = EnumTarget.Weight;\n        } else if (e == EnumAction.Extract) {\n          target.targetType = EnumTarget.Weight;\n        } else if (e == EnumAction.Rest) {\n          target.targetType = EnumTarget.Time;\n        } else if (e == EnumAction.Profile) {\n          target.targetType = EnumTarget.Weight;\n          let _action = action as IProfileParam;\n          _action.segments = _action.segments || [];\n          _action.profilingType =\n            _action.profilingType || EnumProfileType.Flowrate;\n        } else if (e == EnumAction.PourOver) {\n          target.targetType = EnumTarget.Weight;\n        }\n\n        draft[selectedFormulaId].steps[index].action = action;\n        draft[selectedFormulaId].steps[index].target = target;\n      }),\n    );\n  }\n\n  useEffect(() => {\n    setIsOpen(false);\n  }, [formulas]);\n\n  console.log(\"action/ rerender\", { lang });\n\n  return (\n    <>\n      <h1\n        className=\"text-xl font-bold text-orange-900 underline decoration-pink-500\"\n        onClick={() => {\n          setIsOpen(true);\n        }}\n      >\n        {/* {step.action.actionType || \"Action\"} */}\n        {t(step.action.actionType) || \"Action\"}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title={t(\"Select an action\")}\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              handleChangeAction(action);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Tiles space={4} columns={3}>\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Grind ? \"solid\" : \"outline\"}\n              label={t(\"Grind\")}\n              onPress={() => {\n                setAction(EnumAction.Grind);\n              }}\n              icon={() => <GiManualMeatGrinder />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Extract ? \"solid\" : \"outline\"}\n              label=\"Extract\"\n              onPress={() => {\n                setAction(EnumAction.Extract);\n              }}\n              icon={() => <IoWaterSharp />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Rest ? \"solid\" : \"outline\"}\n              label=\"Rest\"\n              onPress={() => {\n                setAction(EnumAction.Rest);\n              }}\n              icon={() => <FaClock />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Profile ? \"solid\" : \"outline\"}\n              label=\"Profile\"\n              onPress={() => {\n                setAction(EnumAction.Profile);\n              }}\n              icon={() => <FaChartArea />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.PourOver ? \"solid\" : \"outline\"}\n              label=\"Pour\"\n              onPress={() => {\n                setAction(EnumAction.PourOver);\n              }}\n              icon={() => <LiaFillDripSolid />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.Sound ? \"solid\" : \"outline\"}\n              label=\"Sound\"\n              onPress={() => {\n                setAction(EnumAction.Sound);\n              }}\n              icon={() => <AiFillSound />}\n            />\n            <Button\n              hierarchy=\"primary\"\n              kind={action == EnumAction.RGB ? \"solid\" : \"outline\"}\n              label=\"RGB\"\n              onPress={() => {\n                setAction(EnumAction.RGB);\n              }}\n              icon={() => <TbColorFilter />}\n            />\n          </Tiles>\n        </Modal>\n      )}\n    </>\n  );\n};\n","import {\n  Banner,\n  Button,\n  Modal,\n  Stack,\n  Tiles,\n} from \"@buildo/bento-design-system\";\nimport { Dispatch, SetStateAction, useEffect, useState } from \"react\";\nimport { FaRegClock } from \"react-icons/fa\";\nimport { IoMdSkipForward } from \"react-icons/io\";\nimport { useEffectOnce } from \"usehooks-ts\";\n// import { IOptionItemProps } from \"./OptionItem\";\n\n// const grinderBehaviourOptions: IOptionItemProps[] = [\n//   {\n//     title: \"can skip\",\n//     text: \"Grinder will skip this step if portafilter is not in position\",\n//     value: true,\n//   },\n//   {\n//     title: \"must wait\",\n//     text: \"Grinder will wait until the portafilter is in position\",\n//     value: false,\n//   },\n// ];\n\nexport const GrinderSkipRune = ({\n  value,\n  onChange,\n}: {\n  value: boolean;\n  onChange: Dispatch<SetStateAction<boolean>>;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  useEffect(() => {\n    setIsOpen(false);\n  }, [value]);\n  useEffectOnce(() => {\n    onChange(false);\n  });\n\n  const [skippable, setSkippable] = useState<boolean>(true);\n\n  return (\n    <>\n      <h1\n        className=\" font-bold text-xl text-blue-800\"\n        onClick={() => setIsOpen(true)}\n      >\n        {skippable ? \"can skip\" : \"must wait\"}\n      </h1>\n\n      {isOpen && (\n              <Modal\n                  autoFocus={false}\n          size=\"small\"\n          title=\"Set grinder behaviour\"\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              onChange(skippable);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Tiles space={8} columns={2}>\n              <Button\n                kind={skippable ? \"solid\" : \"outline\"}\n                hierarchy=\"primary\"\n                label=\"Can skip\"\n                onPress={() => setSkippable(true)}\n                icon={() => <IoMdSkipForward />}\n              />\n              <Button\n                kind={!skippable ? \"solid\" : \"outline\"}\n                hierarchy=\"primary\"\n                label=\"Must wait\"\n                onPress={() => setSkippable(false)}\n                icon={() => <FaRegClock />}\n              />\n            </Tiles>\n            <Banner\n              kind=\"informative\"\n              title=\"Explaination\"\n              description={\n                skippable\n                  ? \"Grinder will skip this step if portafilter is not in position\"\n                  : \"Grinder will wait until the portafilter is in position, then it will start grinding \"\n              }\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n","import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","export const TextRune = ({ text }: { text: string }) => {\n  /**\n   * This function displays the input text as normal text, but word by word so it will wrap around.\n   * @param {string} text - The text to be displayed.\n   */\n  return (\n    <>\n      {text.split(\" \").map((word, index) => (\n        <h1 key={index} className=\"text-xl\">\n          {word}\n        </h1>\n      ))}\n    </>\n  );\n};\n","import { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { IProfileParam } from \"@/gateway/formula/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { SliderField } from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { IoIosCloseCircle } from \"react-icons/io\";\n\n\nexport function TimeRune({\n  // value,\n  //   onChange,\n  // progress\n  index,\n  subIndex = -1,\n}: {\n  // value: number;\n  //       onChange: Dispatch<SetStateAction<number>>;\n  //      progress:  number;\n  index: number;\n  subIndex: number;\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [current, setCurrent] = useState<number>(-1);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const { formulaFeedbacks } = useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n\n  const [value, setValue] = useState<number>(\n    subIndex == -1\n      ? step.target.value\n      : (step.action as IProfileParam).segments[subIndex]?.duration || 0,\n  );\n\n  /*\n    Progress doesn't always show up, it will disappear after 5 seconds\n    So after 5 seconds, it must be clear to null\n    So the number has its own internal state\n  */\n\n  let timeout = useRef(null);\n\n  // useEffect(() => {\n  //   setCurrent(progress);\n\n  //   clearTimeout(timeout.current);\n  //   timeout.current = setTimeout(() => {\n  //     setCurrent(null);\n  //   }, 5000);\n  // }, [progress]);\n\n  useEffect(() => {\n    setValue(\n      subIndex == -1\n        ? step.target.value\n        : (step.action as IProfileParam).segments[subIndex].duration,\n    );\n  }, [formulas[selectedFormulaId].steps[index].target.value]);\n\n  useEffect(() => {\n    const updated = formulaFeedbacks[selectedFormulaId]?.[index]?.target?.value;\n    // if you have subIndex, there nis no need to update progress, handled by the line chart already, more visual\n    if (subIndex == -1) {\n      setCurrent(updated || -1);\n    }\n  }, [formulaFeedbacks, index, selectedFormulaId]);\n\n  return (\n    <Popover\n      onOpenChange={(e) => {\n        setIsOpen(e != false);\n      }}\n      open={isOpen}\n    >\n      <PopoverTrigger>\n        <div\n          className=\"flex h-8 w-fit items-center justify-between rounded-lg p-2\"\n          onClick={() => {\n            setIsOpen(true);\n          }}\n        >\n          {current != -1 && (\n            <h1\n              className=\" text-xl font-bold text-green-800\"\n              onClick={() => setIsOpen(true)}\n            >\n              {`${(current / 1000).toFixed(1)}/`}\n            </h1>\n          )}\n\n          <h1 className=\" text-xl font-bold text-blue-800\">\n            {value} {value <= 1 ? \"second\" : \"seconds\"}\n          </h1>\n        </div>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80 space-y-8 rounded-xl  border\">\n        <IoIosCloseCircle\n          className=\"absolute right-2 top-2 text-gray-500\"\n          size={20}\n          onClick={() => {\n            setIsOpen(false);\n          }}\n        />\n\n        <SliderField\n          value={value}\n          onChange={(e: number) => {\n            setValue(e);\n            setFormulas(\n              produce(formulas, (draft) => {\n                // draft[selectedFormulaId].steps[index].target.value = e;\n                if (subIndex == -1) {\n                  draft[selectedFormulaId].steps[index].target.value = e;\n                } else {\n                  const action = step.action as IProfileParam;\n                  action.segments[subIndex].duration = e;\n                }\n              }),\n            );\n          }}\n          label=\"Time\"\n          type=\"single\"\n          name=\"value\"\n          minValue={0}\n          maxValue={60}\n          step={1}\n        />\n      </PopoverContent>\n    </Popover>\n  );\n};\n","// @refresh reset\n\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  EnumAction,\n  EnumProfileType,\n  IProfileParam,\n  IProfilingSegment,\n  IStepFeedback\n} from \"@/gateway/formula/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { Banner, Button, LineChart, Modal, SliderField, Stack, Tiles } from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { FaMinus, FaPlus } from \"react-icons/fa6\";\nimport { IoIosCloseCircle } from \"react-icons/io\";\nimport { useEffectOnce } from \"usehooks-ts\";\nimport { TextRune } from \"./TextRune\";\nimport { TimeRune } from \"./TimeRune\";\n\ntype PressureDtps = {\n  timestamp: number;\n  pressure: number;\n  min: number;\n  max: number;\n  current?: number;\n};\ntype FlowrateDtps = {\n  timestamp: number;\n  flowrate: number;\n  min: number;\n  max: number;\n  current?: number;\n};\ntype PowerDtps = {\n  timestamp: number;\n  power: number;\n  min: number;\n  max: number;\n  current?: number;\n}\n\nexport type DataPoint = PressureDtps | FlowrateDtps | PowerDtps;\n\nconst generateDatapoints = (\n  segments: IProfilingSegment[],\n  sensor: EnumProfileType,\n  formulaFeedbacks?: IStepFeedback[\"action\"][],\n) => {\n  if (segments === undefined) return [];\n\n  const dps: DataPoint[] = [];\n  // for each segments, we add a new point\n  let totalTime = 0;\n  segments.forEach((segment) => {\n    totalTime += segment.duration;\n  });\n\n  var startTime = 0;\n  var previousValue = 0;\n  for (const segment of segments) {\n    for (var time = 0; time < segment.duration; time += 1) {\n      var interimValue =\n        previousValue +\n        (segment.value - previousValue) * (time / segment.duration);\n      interimValue = Math.round(interimValue * 10) / 10;\n      if (sensor == EnumProfileType.Pressure) {\n        dps.push({\n          timestamp: startTime + time,\n          pressure: interimValue,\n          max: 10,\n          min: 0,\n          // time: timestamp\n        });\n      } else if (sensor == EnumProfileType.Flowrate) {\n        dps.push({\n          timestamp: startTime + time,\n          flowrate: interimValue,\n          max: 50,\n          min: 0,\n          // time: timestamp\n        });\n      } else if (sensor == EnumProfileType.Power) {\n        dps.push({\n          timestamp: startTime + time,\n          power: interimValue,\n          max: 100,\n          min: 0,\n          // time: timestamp\n        });\n      }\n    }\n    previousValue = segment.value;\n    startTime += segment.duration;\n  }\n  return dps;\n};\nexport const RenderedSegment = ({\n  // segments,\n  // // setSegments,\n  // sensor,\n  index,\n}: {\n  // segments: IProfilingSegment[];\n  // sensor: EnumProfileType;\n  index: number;\n  // setSegments: Dispatch<SetStateAction<IProfilingSegment[]>>;\n}) => {\n  useEffectOnce(() => {\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const action = draft[index].action as IProfileParam\n    //     action.actionType = \"Profile\";\n\n    //     action.segments = action.segments || [];\n\n    //     console.log(\"profile/ create object\", action)\n    //     if ((draft[index].action as IProfileParam).segments.length == 0) {\n    //       (draft[index].action as IProfileParam).segments = [\n    //         {\n    //           duration: 10,\n    //           value: 3,\n    //         },\n    //       ];\n    //     }\n    //     return draft\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index]\n          .action as IProfileParam;\n        action.actionType = \"Profile\";\n\n        action.segments = action.segments || [];\n\n        console.log(\"profile/ create object\", action);\n        if (\n          (draft[selectedFormulaId].steps[index].action as IProfileParam)\n            .segments.length == 0\n        ) {\n          (\n            draft[selectedFormulaId].steps[index].action as IProfileParam\n          ).segments = [\n            {\n              duration: 10,\n              value: 3,\n            },\n          ];\n        }\n        return draft;\n      }),\n    );\n  });\n\n  // const [renderedSegments, setRenderedSegments] = useState<JSX.Element[]>([]);\n\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam;\n\n  const renderedSegments = (action.segments || []).map((segment, idx) => {\n    return (\n      <div className=\"flex-rol flex flex-wrap\" key={idx}>\n        {idx == 0 ? <TextRune text=\"First, reach\" /> : <TextRune text=\"then\" />}\n        <ProfileValueRune index={index} subIndex={idx} />\n        {idx == 0 ? <TextRune text=\"within\" /> : <TextRune text=\"in\" />}\n        <TimeRune\n          // progress={segments[idx].duration}\n          // value={segments[idx].duration}\n          // onChange={(e: number) => {\n          //   setSteps(\n          //     produce(steps, (draft) => {\n          //       const action = draft[index].action as IProfileParam;\n          //       action.segments[idx].duration = e;\n          //     })\n          //   );\n          // }}\n          index={index}\n          subIndex={idx}\n        />\n        <h1 className=\"text-xl\">\n          {idx === action.segments.length - 1 ? \".\" : \",\"}\n        </h1>\n      </div>\n    );\n  });\n\n  /**\n   *  Render segments in text readable format\n   *  First, extract with 9 bar for 2 seconds, then slowly turn to 1 bar for 5 seconds, then\n   *\n   * then is a button ?\n   *\n   *  */\n\n  /* \n    Click Add -> First, reaching [pressure] of [9bar] withing [10 seconds] [+]\n    Click Add -> First, reaching [pressure] of [9bar] withing [10 seconds], then, 2 bar within 2 seconds, then 3 bar whithin 20s\n  */\n  const addSegment = () => {\n    // setSegments(\n    //   produce(segments, (draft: IProfilingSegment[]) => {\n    //     // draft.push({\n    //     //   duration: 5,\n    //     //   value: 3\n    //     // })\n    //     draft.push({\n    //       duration: Math.floor(Math.random() * 30),\n    //       value: +(Math.random() * (10 - 2) + 2).toFixed(1),\n    //     });\n    //   })\n    // );\n\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const action = draft[index].action as IProfileParam;\n    //     action.segments.push({\n    //       duration: Math.floor(Math.random() * 30),\n    //       value: +(Math.random() * (10 - 2) + 2).toFixed(1),\n    //     });\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index]\n          .action as IProfileParam;\n        action.segments = action.segments || [];\n        action.segments.push({\n          duration: Math.floor(Math.random() * 30),\n          value: +(Math.random() * (10 - 2) + 2).toFixed(1),\n        });\n      }),\n    );\n  };\n  const removeSegment = () => {\n    // console.log(\"remove segment\", { segments });\n    // if (segments.length > 1) {\n    //   // setSegments(\n    //   //   produce(segments, (draft) => {\n    //   //     draft.splice(-1);\n    //   //   })\n    //   // );\n    // }\n    if (action.segments === undefined) return;\n    if (action.segments.length < 2) return;\n\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const action = draft[index].action as IProfileParam;\n    //     action.segments.pop();\n    //     return draft;\n    //   })\n    // );\n\n    setFormulas(\n      produce(formulas, (draft) => {\n        const action = draft[selectedFormulaId].steps[index]\n          .action as IProfileParam;\n        action.segments.pop();\n        return draft;\n      }),\n    );\n  };\n  return (\n    <>\n      <Separator />\n      <ul>{renderedSegments}</ul>\n      <div className=\"flex h-6 w-fit cursor-pointer  flex-row items-center space-x-1 rounded-md bg-blue-100 p-2 transition-transform duration-200 hover:scale-105\">\n        <FaPlus color=\"#1180EF\" size={16} onClick={addSegment} />\n        <FaMinus color=\"#1180EF\" size={16} onClick={removeSegment} />\n      </div>\n    </>\n  );\n};\nexport const MagicLine = ({\n  // segments,\n  // sensor,\n  index,\n}: {\n  index: number;\n  // segments: IProfilingSegment[];\n  // sensor: EnumProfileType;\n}) => {\n  const [dataPoints, setDataPoints] = useState<DataPoint[]>([]);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const { formulaFeedbacks } = useDeviceContext();\n\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam;\n  const sensor = action.profilingType;\n  const segments = action.segments;\n\n  const fbstore = useRef<IStepFeedback[\"action\"][]>([]);\n\n  useEffect(() => {\n    try {\n      const actionUpdate = formulaFeedbacks[selectedFormulaId][index]\n        .action as IStepFeedback[\"action\"];\n      // when ever formulaFeedbacks are updated, store the values here\n      console.log(\"Line/ add value\", actionUpdate);\n\n      fbstore.current = fbstore.current || [];\n      var store = fbstore.current;\n      store.push({\n        ...actionUpdate,\n        timestamp: Math.round(actionUpdate.timestamp / 1000),\n      });\n      // filter out the store, using the timestamp, remove those that has higher timestmap than actionUpdate\n      // store = store.filter((s) => s.timestamp >= Math.round(actionUpdate.timestamp / 1000))\n\n      const dpts = generateDatapoints(segments, sensor, store);\n      dpts.map((dpt, idx) => {\n        var current = null;\n        store.forEach((s) => {\n          // find the latest value\n          if (s.timestamp == dpt.timestamp) {\n            dpt.current = s.input;\n          }\n        });\n      });\n      console.log(\"Line/ dpts\", dpts, store);\n      setDataPoints(dpts);\n    } catch (e) {\n      console.error(e);\n    }\n  }, [formulaFeedbacks]);\n\n  useEffect(() => {\n    setDataPoints(generateDatapoints(segments, sensor));\n  }, [segments, sensor]);\n\n  const attrMap = {};\n  attrMap[EnumProfileType.Pressure] = \"pressure\";\n  attrMap[EnumProfileType.Flowrate] = \"flowrate\";\n  attrMap[EnumProfileType.Power] = \"power\";\n\n  return (\n    <div className=\"hover:scale-120 w-full -translate-x-10 transition-transform duration-200\">\n      <LineChart\n        key={index}\n        height={300}\n        dataKey=\"Time\"\n        categories={[\n          // add the sensor of power herer\n\n          // sensor == EnumProfileType.Pressure ? \"pressure\" : \"flowrate\",\n          attrMap[sensor] || \"unknown sensor\",\n          \"current\",\n          \"max\",\n          \"min\",\n        ]}\n        hideLegend={false}\n        hideXAxis={true}\n        hideYAxis={false}\n        data={dataPoints}\n        disableAnimation={true}\n      />\n    </div>\n  );\n};\nconst ProfileValueRune = ({\n  // segments,\n  // setValue,\n  // sensor,\n  // idx,\n  index,\n  subIndex,\n}: {\n  // segments: IProfilingSegment[];\n  // setValue: Dispatch<SetStateAction<number>>;\n  // sensor: EnumProfileType;\n  // idx: number;\n  index: number;\n  subIndex: number;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam;\n  const sensor = action.profilingType;\n  const segments = action.segments;\n  const idx = subIndex;\n\n  let unit: string = \"\";\n  if (sensor == EnumProfileType.Pressure) {\n    unit = \"bar\";\n  }\n  if (sensor == EnumProfileType.Flowrate) {\n    unit = \"gram/s\";\n  } else if (sensor == EnumProfileType.Power) {\n    unit = \"%\";\n  }\n\n  const maxValue: Record<EnumProfileType, number> = {\n    [EnumProfileType.Pressure]: 10,\n    [EnumProfileType.Flowrate]: 100,\n    [EnumProfileType.Power]: 100,\n  };\n\n  return (\n    <Popover\n      onOpenChange={(e) => {\n        console.log(\"close\", e);\n        if (e == false) {\n          setIsOpen(false);\n        }\n      }}\n      open={isOpen}\n    >\n      <PopoverTrigger>\n        <div\n          className=\"flex h-8 w-fit items-center justify-between rounded-lg p-2\"\n          onClick={() => {\n            setIsOpen(true);\n          }}\n        >\n          <h1 className=\" text-xl font-bold text-blue-800\">\n            {segments[idx].value} {unit}\n          </h1>\n        </div>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-96 min-w-96 rounded-xl border\">\n        <IoIosCloseCircle\n          className=\"absolute right-2 top-2 text-gray-500\"\n          size={20}\n          onClick={() => {\n            setIsOpen(false);\n          }}\n        />\n\n        <SliderField\n          value={segments[idx].value}\n          onChange={(e: number) => {\n            setFormulas(\n              produce(formulas, (draft) => {\n                (\n                  draft[selectedFormulaId].steps[index].action as IProfileParam\n                ).segments[idx].value = e;\n              }),\n            );\n          }}\n          label={sensor}\n          type=\"single\"\n          name=\"value\"\n          minValue={0}\n          maxValue={maxValue[sensor]}\n          step={0.1}\n        />\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport const ProfileRune = ({\n  // value,\n  // onChange,\n  index,\n}: {\n    // value: EnumProfileType;\n    // onChange: Dispatch<SetStateAction<string>>;\n    index: number;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n  const action = step.action as IProfileParam\n\n\n\n  const [profileType, setProfileType] = useState<EnumProfileType>(\n    action.profilingType || EnumProfileType.Flowrate\n  );\n\n  useEffect(() => {\n    setIsOpen(false);\n  }, [formulas]);\n\n  function onChange(sensor: EnumProfileType) {\n    setFormulas(produce(formulas, draft => {\n      draft[selectedFormulaId].steps[index].action.actionType = EnumAction.Profile;\n      (draft[selectedFormulaId].steps[index].action as IProfileParam).profilingType = sensor;\n    }))\n\n  }\n\n  return (\n    <>\n      <h1\n        className=\" font-bold text-xl text-blue-800\"\n        onClick={() => {\n          setIsOpen(true);\n        }}\n      >\n        {action.profilingType || EnumProfileType.Flowrate}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title=\"Select an profiling method\"\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              onChange(profileType);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={16}>\n            <Tiles space={8} columns={2}>\n              <Button\n                hierarchy=\"primary\"\n                kind={\n                  profileType == EnumProfileType.Flowrate ? \"solid\" : \"outline\"\n                }\n                label=\"Flowrate\"\n                onPress={() => {\n                  setProfileType(EnumProfileType.Flowrate);\n                }}\n              />\n\n              <Button\n                hierarchy=\"primary\"\n                kind={\n                  profileType == EnumProfileType.Pressure ? \"solid\" : \"outline\"\n                }\n                label=\"Pressure\"\n                onPress={() => {\n                  setProfileType(EnumProfileType.Pressure);\n                }}\n              />\n              <Button\n                hierarchy=\"primary\"\n                kind={\n                  profileType == EnumProfileType.Power ? \"solid\" : \"outline\"\n                }\n                label=\"Power\"\n                onPress={() => {\n                  setProfileType(EnumProfileType.Power);\n                }}\n              />\n            </Tiles>\n            <Banner\n              kind=\"informative\"\n              title=\"What is this ?\"\n              description={\n                profileType == EnumProfileType.Flowrate\n                  ? \"Flowrate is the amount of water that flows through the coffee bed in a given time\"\n                  : profileType == EnumProfileType.Pressure\n                    ? \"Pressure is the force applied to the coffee bed\"\n                    : \"Power is the energy applied to the coffee bed, purely control the pump power to achieve the result\"\n                // if it is power, add another message here\n\n              }\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n","import { IGrinderState } from \"@/gateway/device/grinder\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport {\n  Banner,\n  Button,\n  Inline,\n  Modal,\n  Stack,\n} from \"@buildo/bento-design-system\";\nimport { useRouter } from \"next/router\";\nimport { Dispatch, SetStateAction, useState } from \"react\";\nimport { useEffectOnce } from \"usehooks-ts\";\n\nexport const IngredientRune = ({\n  value,\n  onChange,\n}: {\n  value: string;\n  onChange: Dispatch<SetStateAction<string>>;\n}) => {\n  console.log(\"action/ recreate\");\n\n  const [isOpen, setIsOpen] = useState(false);\n  const { grinderSettings } = useDeviceContext();\n\n  const [ingredient, setIngridient] = useState<string>(\n    value || \"[select grinder]\",\n  );\n  const router = useRouter();\n  useEffectOnce(() => {\n    onChange(\"[select grinder]\");\n  });\n\n  return (\n    <>\n      <h1\n        className=\" text-xl font-bold text-blue-800\"\n        onClick={() => setIsOpen(true)}\n      >\n        {ingredient}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title=\"Select ingredient\"\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              onChange(ingredient);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <Inline space={4}>\n              {grinderSettings.map((grinder: IGrinderState, index: number) => {\n                return (\n                  <Button\n                    key={index}\n                    kind={ingredient == grinder.name ? \"solid\" : \"outline\"}\n                    hierarchy=\"primary\"\n                    label={grinder.name}\n                    onPress={() => setIngridient(grinder.name)}\n                  />\n                );\n              })}\n              <Button\n                key={-1}\n                kind={\"outline\"}\n                hierarchy=\"primary\"\n                label={\"+\"}\n                onPress={() => {\n                  router.push(\"/setting\");\n                }}\n              />\n            </Inline>\n            <Banner\n              kind=\"informative\"\n              title=\"Reminder\"\n              description=\"You can set up your grinder in the settings, the hardware can be connected to the machine wirelessly to the espresso machine\"\n              action={{\n                label: \"Learn more\",\n                onPress: () => {\n                  window.open(\"https://www.google.com\");\n                },\n              }}\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n","import { Banner, Modal, SliderField, Stack } from \"@buildo/bento-design-system\";\nimport { Dispatch, SetStateAction, useState } from \"react\";\n\nexport const PumpRune = ({\n  value,\n  onChange,\n}: {\n  value: number;\n  onChange: Dispatch<SetStateAction<number>>;\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [power, setPower] = useState<number>(value || 0);\n\n\n  return (\n    <>\n      <div\n        className=\"rounded-lg w-fit h-8 p-2 justify-between items-center flex\"\n        onClick={() => {\n          setIsOpen(true);\n        }}\n      >\n        <h1 className=\"font-bold text-xl text-blue-800\">{value || 0} %</h1>\n      </div>\n\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title=\"Set pump power\"\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              console.log(\" update power\", power)\n              onChange(power);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <SliderField\n              type=\"single\"\n              name=\"power\"\n              value={power}\n              onChange={(e: number) => {\n                console.log(\"Power is updated for pump\", e)\n                setPower(e)\n              }}\n              label=\"Pump Power\"\n              minValue={10}\n              maxValue={100}\n              step={1}\n\n            />\n            <Banner\n              kind=\"informative\"\n              title=\"Notice\"\n              description=\"Power require an external pump to be connected to the machine, other wise it is simply ON/OFF\"\n              action={{\n                label: \"Learn more\",\n                onPress: () => {\n                  window.open(\"https://www.google.com\");\n                },\n              }}\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n};\n","import { EnumTarget } from \"@/gateway/formula/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { Banner, Modal, SliderField, Stack } from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useEffect, useRef, useState } from \"react\";\n\nexport function WeightRune({\n  // value,\n  //   onChange,\n  // progress,\n\n  index,\n}: {\n    // value: number;\n    // onChange: Dispatch<SetStateAction<number>>;\n    // progress: number;\n    index: number;\n}) {\n  const [isOpen, setIsOpen] = useState(false);\n  const { formulas, setFormulas, selectedFormulaId, formulaFeedbacks } =\n    useDeviceContext();\n  const step = formulas[selectedFormulaId].steps[index];\n  const [weight, setWeight] = useState(step.target.value);\n\n\n  const [current, setCurrent] = useState<number>(0);\n\n  /*\n      Progress doesn't always show up, it will disappear after 5 seconds\n      So after 5 seconds, it must be clear to null\n      So the number has its own internal state\n  */\n\n  useEffect(() => {\n    const updated =\n      formulaFeedbacks[selectedFormulaId]?.[index]?.target?.value || 0;\n    setCurrent(updated);\n  }, [formulaFeedbacks, index, selectedFormulaId]);\n\n  let timeout = useRef(null)\n\n  // useEffect(() => {\n  //   setCurrent(progress);\n\n  //   clearTimeout(timeout.current)\n  //   timeout.current = setTimeout(() => {\n  //     setCurrent(null)\n  //   }, 5000)\n  //   console.log(\"Progress is updated for weight\", progress)\n  // }, [progress])\n\n\n  function handleChangeAction() {\n    setFormulas(produce(formulas, draft => {\n      draft[selectedFormulaId].steps[index].target.targetType = EnumTarget.Weight;\n      draft[selectedFormulaId].steps[index].target.value = weight;\n    }))\n  }\n\n  return (\n    <>\n      {current != null && (\n        <h1\n          className=\" text-xl font-bold text-green-800\"\n          onClick={() => setIsOpen(true)}\n        >\n          {`${(current / 10).toFixed(1)}/`}\n        </h1>\n      )}\n\n      <h1\n        className=\" text-xl font-bold text-blue-800\"\n        onClick={() => setIsOpen(true)}\n      >\n        {step.target.value.toFixed(1)}\n        {step.target.value <= 1 ? \" gram\" : \" grams\"}\n      </h1>\n      {isOpen && (\n        <Modal\n          size=\"small\"\n          title=\"How much ?\"\n          onClose={() => setIsOpen(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => {\n              setIsOpen(false);\n              handleChangeAction();\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setIsOpen(false),\n          }}\n        >\n          <Stack space={8}>\n            <SliderField\n              type=\"single\"\n              name=\"weight\"\n              value={weight}\n              onChange={setWeight}\n              label=\"Weight\"\n              minValue={0}\n              maxValue={500}\n              step={1}\n            />\n            <Banner\n              kind=\"informative\"\n              title=\"Reminder\"\n              description=\"Calibration is required for accurate weight, please go to Settings\"\n            />\n          </Stack>\n        </Modal>\n      )}\n    </>\n  );\n}\n","import {\n  EnumAction,\n  IExtractParam,\n  IGrindParam,\n  IRestParam\n} from \"@/gateway/formula/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport { produce } from \"immer\";\nimport { MdOutlineClear } from \"react-icons/md\";\nimport { ActionRune } from \"./components/ActionRune\";\nimport { GrinderSkipRune } from \"./components/GrinderRune\";\nimport { MagicLine, RenderedSegment } from \"./components/ProfileRune\";\n\nimport { IngredientRune } from \"./components/IngredientRune\";\nimport { ProfileRune } from \"./components/ProfileRune\";\nimport { PumpRune } from \"./components/PumpRune\";\nimport { TextRune } from \"./components/TextRune\";\nimport { TimeRune } from \"./components/TimeRune\";\nimport { WeightRune } from \"./components/WeightRune\";\n\nexport type ProfilingType = \"pressure sensor\" | \"flowrate profiler\";\nexport type GrinderBehaviour = \"can skip\" | \"must wait\";\nexport type ActionType = \"Grind\" | \"Extract\" | \"Rest\" | \"Profiling\";\n\n// ----------------------------------------------------------- //\n\nfunction Wrapper() {\n  return (\n    <div className=\"group relative mx-auto max-w-7xl\">\n      <div className=\"absolute -inset-1 rounded-lg bg-gradient-to-r from-purple-600 to-pink-600 opacity-25 blur transition duration-1000 group-hover:opacity-100 group-hover:duration-200\">\n        <div className=\"items-pop flex justify-start space-x-6 rounded-lg bg-white px-7 py-6 leading-none ring-1 ring-gray-900\"></div>\n      </div>\n    </div>\n  );\n}\n\nexport function NewStepCard({\n  onDelete,\n  index,\n}: {\n  onDelete: () => void;\n  index: number;\n}) {\n  const { formulas, setFormulas, selectedFormulaId } = useDeviceContext();\n  const steps = formulas[selectedFormulaId].steps || [];\n\n  return (\n    <div className=\"flex h-fit w-96 max-w-[calc(90vw)] flex-col rounded-xl  border  bg-white p-4 drop-shadow-xl transition-transform duration-200 hover:scale-105 hover:border-blue-500\">\n      <div\n        className=\"absolute right-0 top-0 cursor-pointer p-2\"\n        onClick={() => onDelete()}\n      >\n        <MdOutlineClear className=\"text-gray-300\" />\n      </div>\n      <div className=\"inline-flex max-w-96 flex-wrap items-center gap-2 space-x-1 text-wrap\">\n        <ActionRune index={index} />\n\n        {formulas[selectedFormulaId].steps[index].action.actionType ===\n          \"Grind\" && (\n          <>\n            <WeightRune index={index} />\n            <TextRune text=\"of\" />\n            <IngredientRune\n              value={(steps[index].action as IGrindParam).ingredient}\n              onChange={(ingredient: string) => {\n                // setSteps(\n                //   produce(steps, (draft) => {\n                //     (draft[index].action as IGrindParam).ingredient =\n                //       ingredient;\n                //   })\n                // );\n\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    (\n                      draft[selectedFormulaId].steps[index]\n                        .action as IGrindParam\n                    ).ingredient = ingredient;\n                  }),\n                );\n              }}\n            />\n            <TextRune text=\"bean, grinder\" />\n            <GrinderSkipRune\n              value={(steps[index].action as IGrindParam).canSkip}\n              onChange={(state: boolean) => {\n                // setSteps(\n                //   produce(steps, (draft) => {\n                //     (draft[index].action as IGrindParam).canSkip = state;\n                //     draft[index].action.actionType = EnumAction.Grind;\n                //   })\n                // );\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    (\n                      draft[selectedFormulaId].steps[index]\n                        .action as IGrindParam\n                    ).canSkip = state;\n                    draft[selectedFormulaId].steps[index].action.actionType =\n                      EnumAction.Grind;\n                  }),\n                );\n              }}\n            />\n\n            {(steps[index].action as IGrindParam).canSkip === true ? (\n              <TextRune text=\"this step is portafilter is absent\" />\n            ) : (\n              <TextRune text=\"until portafilter is present\" />\n            )}\n          </>\n        )}\n        {steps[index].action.actionType === \"Extract\" && (\n          <>\n            {/* <TextRune text=\"a shot of\" /> */}\n            <WeightRune index={index} />\n            <TextRune text=\"with pump power\" />\n            <PumpRune\n              value={(steps[index].action as IExtractParam).power}\n              onChange={(power: number) => {\n                // setSteps(\n                //   produce(steps, (draft) => {\n                //     (draft[index].action as IExtractParam).actionType =\n                //       EnumAction.Extract;\n                //     (draft[index].action as IExtractParam).power = power;\n                //   })\n                // );\n\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    (\n                      draft[selectedFormulaId].steps[index]\n                        .action as IExtractParam\n                    ).actionType = EnumAction.Extract;\n                    (\n                      draft[selectedFormulaId].steps[index]\n                        .action as IExtractParam\n                    ).power = power;\n                  }),\n                );\n              }}\n            />\n          </>\n        )}\n        {steps[index].action.actionType === EnumAction.PourOver && (\n          <>\n            <WeightRune index={index} />\n            <TextRune text=\"in\" />\n            <TimeRune subIndex={-1} index={index} />\n          </>\n        )}\n        {steps[index].action.actionType === \"Rest\" && (\n          <>\n            <TextRune text=\"for\" />\n            <TimeRune\n              subIndex={-1}\n              index={index}\n              // valveState={(steps[index].action as IRestParam).valveState}\n              // toggleChecked={(checked: boolean) => {\n              //   setSteps(\n              //     produce(steps, (draft) => {\n              //       draft[index].target.targetType = EnumTarget.Time;\n              //       (draft[index].action as IRestParam).valveState = checked;\n              //     })\n              //   );\n              // }}\n            />\n            {(steps[index].action as IRestParam).valveState && (\n              <TextRune text=\"but keep valve open\" />\n            )}\n          </>\n        )}\n        {steps[index].action.actionType === \"Profile\" && (\n          <>\n            <TextRune text=\"to extract\" />\n\n            <WeightRune index={index} />\n            <TextRune text=\"of espresso using\" />\n            <ProfileRune index={index} />\n            <TextRune text=\"profiling\" />\n            <RenderedSegment\n              index={index}\n              // segments={(steps[index].action as IProfileParam).segments}\n              // setSegments={() => {\n              //   setSteps(\n              //     produce(steps, draft => {\n              //       (draft[index].action as IProfileParam).segments = segments;\n              //     })\n              //   );\n              // }}\n              // sensor={(steps[index].action as IProfileParam).profilingType}\n            />\n            <MagicLine\n              index={index}\n              // segments={(steps[index].action as IProfileParam).segments}\n              // sensor={(steps[index].action as IProfileParam).profilingType}\n            />\n          </>\n        )}\n      </div>\n    </div>\n  );\n}","\"use client\";\n\n\nimport { NewStepCard } from \"@/components/NewStepCard\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { EnumAction, EnumTarget } from \"@/gateway/formula/step\";\nimport useDeviceContext from \"@/hooks/useDeviceContext\";\nimport {\n  Body,\n  Button,\n  Modal,\n  TextField,\n  Tiles,\n} from \"@buildo/bento-design-system\";\nimport { produce } from \"immer\";\nimport { useRouter } from \"next/router\";\nimport { ReactNode, useEffect, useRef, useState } from \"react\";\nimport {\n  DragDropContext,\n  Draggable,\n  DropResult,\n  Droppable,\n  ResponderProvided,\n} from \"react-beautiful-dnd\";\nimport { AiFillPlusCircle } from \"react-icons/ai\";\nimport { FaDownload, FaPlay, FaShareAlt, FaStop, FaWindowClose } from \"react-icons/fa\";\nimport { uuid } from \"uuidv4\";\nimport Layout from \"./layout\";\n\nconst BetterButton = ({\n  icon,\n  label,\n  color,\n  onClick,\n}: {\n  icon: ReactNode;\n  label: string;\n  color: string;\n  onClick: () => void;\n}) => {\n  return (\n    <div\n      className={`rounded-xl border flex flex-row space-x-1 items-center bg-white p-4 size-12 cursor-pointer hover:border-blue-500`}\n    >\n      {icon}\n    </div>\n  );\n};\n\nconst Detail = () => {\n  const router = useRouter();\n  const id = router.query.slug;\n\n  const [downloadTargetGroup, setDownloadTargetGroup] = useState(-1);\n  const [downloadTargetButton, setDownloadTargetButton] = useState(-1);\n\n  const [downloadWindow, setDownloadWindow] = useState(false);\n  const [shareWindow, setShareWindow] = useState(false);\n  const [loading, setLoading] = useState(true);\n\n  const [running, setRunning] = useState<boolean>(false);\n\n  const {\n    selectedFormulaId,\n    registerSelectedFormulaId,\n    setFormulas,\n    formulas,\n    setSelectedPage,\n    registerFormulaClick,\n    cancelFormulaClick,\n    progressReport,\n  } = useDeviceContext();\n  const [winReady, setwinReady] = useState(false);\n  const timeoutRef = useRef<ReturnType<typeof setTimeout>>();\n\n  const { formulaFeedbacks } = useDeviceContext();\n\n  useEffect(() => {\n    if (timeoutRef) {\n      clearTimeout(timeoutRef.current);\n      timeoutRef.current = setTimeout(() => {\n        setRunning(false);\n      }, 2000);\n      setRunning(true);\n    }\n  }, [formulaFeedbacks[selectedFormulaId]]);\n\n\n\n  //TODO: Assume don't have any formular before\n  function handleAddStep() {\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     draft.push({\n    //       id: uuid(),\n    //       action: {\n    //         actionType: EnumAction.Rest,\n    //         valveState: false,\n    //       },\n    //       target: {\n    //         targetType: EnumTarget.Time,\n    //         value: 10,\n    //       },\n    //     });\n    //   })\n    // );\n\n    setFormulas(produce(formulas, (draft) => {\n      const formula = draft[selectedFormulaId];\n      formula.steps.push({\n        id: uuid(),\n        action: {\n          actionType: EnumAction.Rest,\n          valveState: false,\n        },\n        target: {\n          targetType: EnumTarget.Time,\n          value: 10,\n        },\n      })\n    }))\n  }\n\n  function handleDeleteStep(id: string) {\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     return draft.filter(function (item) {\n    //       return item?.id !== id;\n    //     });\n    //   })\n    // );\n\n    setFormulas(produce(formulas, (draft) => {\n      const formula = draft[selectedFormulaId];\n      formula.steps = formula.steps.filter(function (item) {\n        return item?.id !== id;\n      });\n      return draft;\n    }))\n\n  }\n\n  function handleDragAndDrop(result: DropResult, provided: ResponderProvided) {\n    if (!result.destination) return;\n    // setSteps(\n    //   produce(steps, (draft) => {\n    //     const [reorderedItem] = draft.splice(result.source.index, 1);\n    //     draft.splice(result.destination.index, 0, reorderedItem);\n    //     return draft;\n    //   })\n    // );\n\n    setFormulas(produce(formulas, (draft) => {\n      const formula = draft[selectedFormulaId];\n      const [reorderedItem] = formula.steps.splice(result.source.index, 1);\n      formula.steps.splice(result?.destination?.index || 0, 0, reorderedItem);\n      return draft;\n    }));\n  }\n\n  useEffect(function () {\n    setwinReady(true);\n  }, []);\n  useEffect(() => {\n    console.log(\"lab/ re-render\", selectedFormulaId);\n  }, [selectedFormulaId]);\n\n  const listDrinkType = () => {\n    return (\n      <div className=\"flex flex-row w-full h-16 space-x-4 justify-between\"></div>\n    );\n  };\n\n  return (\n    <Layout>\n      {downloadWindow && (\n        <Modal\n          size=\"large\"\n          autoFocus={false}\n          title=\"Assign to Button\"\n          onClose={() => setDownloadWindow(false)}\n          primaryAction={{\n            label: \"Download\",\n            onPress: () => {\n              setLoading(true);\n              setTimeout(() => {\n                setDownloadWindow(false);\n              }, 3000);\n            },\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setDownloadWindow(false),\n          }}\n        >\n          <Body size=\"medium\">\n            {\n              \"This process will save the formula to a physical button on your cofee machine so you don't always need a mobile device connected\"\n            }\n          </Body>\n\n          <div className=\"w-full h-32 flex flex-col space-y-4 p-4\">\n            <Tiles space={8} columns={3}>\n              {[1, 2, 3].map((value, index) => {\n                return (\n                  <Button\n                    key={index}\n                    label={`Group ${value}`}\n                    hierarchy=\"primary\"\n                    kind={index === downloadTargetGroup ? \"solid\" : \"outline\"}\n                    onPress={() => setDownloadTargetGroup(index)}\n                  />\n                );\n              })}\n            </Tiles>\n            <Tiles space={8} columns={4}>\n              {[1, 2, 3, 4].map((value, index) => {\n                return (\n                  <Button\n                    key={index}\n                    label={`Button ${value}`}\n                    hierarchy=\"primary\"\n                    kind={index === downloadTargetButton ? \"solid\" : \"outline\"}\n                    onPress={() => setDownloadTargetButton(index)}\n                  />\n                );\n              })}\n            </Tiles>\n          </div>\n        </Modal>\n      )}\n\n      {shareWindow && (\n        <Modal\n          title=\"Share\"\n          onClose={() => setShareWindow(false)}\n          primaryAction={{\n            label: \"OK\",\n            onPress: () => setShareWindow(false),\n          }}\n          secondaryAction={{\n            label: \"Cancel\",\n            onPress: () => setShareWindow(false),\n          }}\n        >\n          <Body size=\"medium\">Content</Body>\n        </Modal>\n      )}\n\n      <div className=\"flex flex-col  items-center space-y-4 p-4\">\n        <div\n          className={\n            \" h-fit  rounded-xl max-w-[calc(90vw)] w-96 p-4 flex flex-col space-y-4 shadow-xl border\"\n          }\n        >\n          <TextField\n            value={formulas[selectedFormulaId]?.title}\n            onChange={(e: string) => {\n              setFormulas(\n                produce(formulas, (draft) => {\n                  console.log(\"Formulas\", formulas, selectedFormulaId);\n                  draft[selectedFormulaId].title = e;\n                })\n              );\n            }}\n            label=\"Formula\"\n            placeholder=\"Untitled formula\"\n          />\n\n          {/* {listDrinkType()} */}\n\n          <div className=\"flex flex-row justify-between items-center space-x-1 text-white\">\n            {running === true ? (\n              <div\n                className={`rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-2/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-orange-400 to-red-400 text-white select-none`}\n                onClick={() => {\n                  cancelFormulaClick(selectedFormulaId);\n                }}\n              >\n                <FaStop />\n                <h1>Stop</h1>\n              </div>\n            ) : (\n                <div\n                  className={`rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-2/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-blue-400 to-emerald-400 text-white select-none`}\n                  onClick={() => {\n                // console.log(\"play\");\n                    registerFormulaClick(selectedFormulaId);\n                  }}\n                >\n                  <FaPlay />\n                  <h1>Play</h1>\n                </div>\n            )}\n            <div\n              className={`rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-1/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-purple-800 via-violet-900 to-purple-800`}\n              onClick={() => {\n                console.log(\"download\");\n                // open a bento model\n                setDownloadWindow(true);\n              }}\n            >\n              <FaDownload />\n            </div>\n\n            <div\n              className={`rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-1/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-blue-500 to-blue-600`}\n              onClick={() => {\n                setShareWindow(true);\n              }}\n            >\n              <FaShareAlt />\n            </div>\n\n            <div\n              className={`rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-1/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-red-500 to-red-800`}\n              onClick={() => {\n                console.log(\"delete\");\n                setSelectedPage(\"Formula\");\n                registerSelectedFormulaId('');\n                setFormulas(\n                  produce(formulas, (draft) => {\n                    // return draft.filter(item => item?.id !== selectedFormulaId)\n                    delete formulas[selectedFormulaId];\n                  })\n                );\n\n                router.push(\"/\");\n              }}\n            >\n              <FaWindowClose />\n            </div>\n          </div>\n        </div>\n        <Separator />\n        <div className=\" flex flex-col py-3 justify-center items-center mix-w-80 \">\n          <DragDropContext\n            onDragEnd={handleDragAndDrop}\n            onBeforeDragStart={() => {\n              console.log(\"onBeforeDragStart\");\n            }}\n            onDragStart={() => {\n              console.log(\"onDragStart\");\n            }}\n            onDragUpdate={() => {\n              console.log(\"onDragUpdate\");\n            }}\n          >\n            <div className=\"flex flex-row w-full\">\n              <Droppable droppableId=\"ROOT\">\n                {(provided) => (\n                  <div\n                    {...provided.droppableProps}\n                    ref={provided.innerRef}\n                    className=\"flex flex-col w-full justify-between mx-auto items-center space-y-4\"\n                  >\n                    {(formulas[selectedFormulaId]?.steps || [])?.map((item, idx) => {\n                      console.log(\"render\", { item, idx });\n                      return (\n                        winReady && (\n                          <Draggable\n                            draggableId={item?.id}\n                            key={item?.id}\n                            index={idx}\n                          >\n                            {(provided) => (\n                              <div\n                                className=\"\"\n                                {...provided.dragHandleProps}\n                                {...provided.draggableProps}\n                                ref={provided.innerRef}\n                              >\n                                <NewStepCard\n                                  onDelete={() => handleDeleteStep(item?.id)}\n                                  index={idx}\n                                  // onChange={(params) =>\n                                  //   handleChange(item?.id, params)\n                                  // }\n                                />\n                              </div>\n                            )}\n                          </Draggable>\n                        )\n                      );\n                    })}\n                    {provided.placeholder}\n                  </div>\n                )}\n              </Droppable>\n            </div>\n          </DragDropContext>\n          <button\n            className=\"flex flex-row space-x-4 justify-center items-center rounded-xl border  cursor-pointer w-80 h-16 my-4 bg-blue-100\"\n            onClick={handleAddStep}\n          >\n            <AiFillPlusCircle color=\"#1180EF\" size={30} />\n            <p className=\"text-[#1180EF] font-bold text-lg\">Add steps</p>\n          </button>\n        </div>\n      </div>\n    </Layout>\n  );\n};\n\nexport default Detail;\n"],"names":["window","__NEXT_P","push","ActionRune","index","isOpen","setIsOpen","useState","formulas","setFormulas","selectedFormulaId","useDeviceContext","action","setAction","steps","actionType","step","t","useTranslation","lang","useSelectedLanguage","useEffect","console","log","h1","className","onClick","Modal","size","title","onClose","primaryAction","label","onPress","e","produce","draft","target","EnumAction","Grind","targetType","EnumTarget","Weight","Extract","Rest","Time","Profile","_action","segments","profilingType","EnumProfileType","Flowrate","PourOver","secondaryAction","Tiles","space","columns","Button","hierarchy","kind","icon","GiManualMeatGrinder","IoWaterSharp","FaClock","FaChartArea","LiaFillDripSolid","Sound","AiFillSound","RGB","TbColorFilter","GrinderSkipRune","value","onChange","useEffectOnce","skippable","setSkippable","autoFocus","Stack","IoMdSkipForward","FaRegClock","Banner","description","Popover","PopoverPrimitive","PopoverTrigger","PopoverContent","React","ref","align","sideOffset","props","cn","displayName","Separator","orientation","decorative","SeparatorPrimitive","TextRune","text","split","map","word","TimeRune","subIndex","current","setCurrent","formulaFeedbacks","setValue","duration","useRef","updated","onOpenChange","open","div","toFixed","IoIosCloseCircle","SliderField","type","name","minValue","maxValue","generateDatapoints","sensor","undefined","dps","totalTime","forEach","segment","startTime","previousValue","time","interimValue","Math","round","Pressure","timestamp","pressure","max","min","flowrate","Power","power","RenderedSegment","length","renderedSegments","idx","ProfileValueRune","ul","FaPlus","color","floor","random","FaMinus","pop","MagicLine","dataPoints","setDataPoints","fbstore","actionUpdate","store","dpts","dpt","s","input","error","attrMap","LineChart","height","dataKey","categories","hideLegend","hideXAxis","hideYAxis","data","disableAnimation","unit","ProfileRune","profileType","setProfileType","IngredientRune","grinderSettings","ingredient","setIngridient","router","useRouter","Inline","grinder","PumpRune","setPower","WeightRune","weight","setWeight","NewStepCard","onDelete","MdOutlineClear","canSkip","state","valveState","downloadTargetGroup","setDownloadTargetGroup","query","slug","downloadTargetButton","setDownloadTargetButton","downloadWindow","setDownloadWindow","shareWindow","setShareWindow","loading","setLoading","running","setRunning","registerSelectedFormulaId","setSelectedPage","registerFormulaClick","cancelFormulaClick","progressReport","winReady","setwinReady","timeoutRef","clearTimeout","setTimeout","Layout","Body","TextField","placeholder","FaStop","FaPlay","FaDownload","FaShareAlt","FaWindowClose","DragDropContext","onDragEnd","result","provided","destination","formula","reorderedItem","splice","source","onBeforeDragStart","onDragStart","onDragUpdate","Droppable","droppableId","droppableProps","innerRef","item","Draggable","draggableId","id","dragHandleProps","draggableProps","filter","handleDeleteStep","button","uuid","AiFillPlusCircle","p"],"sourceRoot":""}