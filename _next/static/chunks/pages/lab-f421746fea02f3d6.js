(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[701],{17503:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/lab",function(){return s(15747)}])},15747:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return V}});var n=s(85893),r=s(77814),o=s(63522),l=s(93513),i=s(30080),a=s(80907),c=s(67294),d=s(37039),u=s(67421),x=s(87771),p=s(52091),m=s(86204),h=s(71054),f=s(18318),g=s(45341),j=s(19151);const v=e=>{let{index:t}=e;const[s,i]=(0,c.useState)(!1),{formulas:v,setFormulas:b,selectedFormulaId:y}=(0,o.Z)(),[w,k]=(0,c.useState)(v[y].steps[t].action.actionType),P=v[y].steps[t],{t:F}=(0,u.$G)(),{lang:C}=(0,d.gE)();return(0,c.useEffect)((()=>{i(!1)}),[v]),console.log("action/ rerender",{lang:C}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-orange-900 underline decoration-pink-500",onClick:()=>{i(!0)},children:F(P.action.actionType)||"Action"}),s&&(0,n.jsx)(a.u_l,{size:"small",title:F("Select an action"),onClose:()=>i(!1),primaryAction:{label:"OK",onPress:()=>{var e;i(!1),e=w,b((0,l.Uy)(v,(s=>{const n=s[y].steps[t].action;n.actionType=e;const o=s[y].steps[t].target;if(e==r.g8.Grind)o.targetType=r.YK.Weight;else if(e==r.g8.Extract)o.targetType=r.YK.Weight;else if(e==r.g8.Rest)o.targetType=r.YK.Time;else if(e==r.g8.Profile){o.targetType=r.YK.Weight;let e=n;e.segments=e.segments||[],e.profilingType=e.profilingType||r.jk.Flowrate}else e==r.g8.PourOver&&(o.targetType=r.YK.Weight);s[y].steps[t].action=n,s[y].steps[t].target=o})))}},secondaryAction:{label:"Cancel",onPress:()=>i(!1)},children:(0,n.jsxs)(a.r5R,{space:4,columns:3,children:[(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:w==r.g8.Grind?"solid":"outline",label:F("Grind"),onPress:()=>{k(r.g8.Grind)},icon:()=>(0,n.jsx)(h.nXt,{})}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:w==r.g8.Extract?"solid":"outline",label:"Extract",onPress:()=>{k(r.g8.Extract)},icon:()=>(0,n.jsx)(f.bYu,{})}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:w==r.g8.Rest?"solid":"outline",label:"Rest",onPress:()=>{k(r.g8.Rest)},icon:()=>(0,n.jsx)(m.qyc,{})}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:w==r.g8.Profile?"solid":"outline",label:"Profile",onPress:()=>{k(r.g8.Profile)},icon:()=>(0,n.jsx)(p.p$z,{})}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:w==r.g8.PourOver?"solid":"outline",label:"Pour",onPress:()=>{k(r.g8.PourOver)},icon:()=>(0,n.jsx)(g._eR,{})}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:w==r.g8.Sound?"solid":"outline",label:"Sound",onPress:()=>{k(r.g8.Sound)},icon:()=>(0,n.jsx)(x.dfw,{})}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:w==r.g8.RGB?"solid":"outline",label:"RGB",onPress:()=>{k(r.g8.RGB)},icon:()=>(0,n.jsx)(j.$Vy,{})})]})})]})};var b=s(37094),y=s(64158);const w=e=>{let{value:t,onChange:s}=e;const[r,o]=(0,c.useState)(!1);(0,c.useEffect)((()=>{o(!1)}),[t]),(0,y.q)((()=>{s(!1)}));const[l,i]=(0,c.useState)(!0);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:" font-bold text-xl text-blue-800",onClick:()=>o(!0),children:l?"can skip":"must wait"}),r&&(0,n.jsx)(a.u_l,{autoFocus:!1,size:"small",title:"Set grinder behaviour",onClose:()=>o(!1),primaryAction:{label:"OK",onPress:()=>{o(!1),s(l)}},secondaryAction:{label:"Cancel",onPress:()=>o(!1)},children:(0,n.jsxs)(a.Kqy,{space:8,children:[(0,n.jsxs)(a.r5R,{space:8,columns:2,children:[(0,n.jsx)(a.zxk,{kind:l?"solid":"outline",hierarchy:"primary",label:"Can skip",onPress:()=>i(!0),icon:()=>(0,n.jsx)(b.PCn,{})}),(0,n.jsx)(a.zxk,{kind:l?"outline":"solid",hierarchy:"primary",label:"Must wait",onPress:()=>i(!1),icon:()=>(0,n.jsx)(p.fSQ,{})})]}),(0,n.jsx)(a.jL0,{kind:"informative",title:"Explaination",description:l?"Grinder will skip this step if portafilter is not in position":"Grinder will wait until the portafilter is in position, then it will start grinding "})]})})]})};var k=s(71111),P=s(23482);const F=k.fC,C=k.xz,N=c.forwardRef(((e,t)=>{let{className:s,align:r="center",sideOffset:o=4,...l}=e;return(0,n.jsx)(k.h_,{children:(0,n.jsx)(k.VY,{ref:t,align:r,sideOffset:o,className:(0,P.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})}));N.displayName=k.VY.displayName;var S=s(12780);const T=c.forwardRef(((e,t)=>{let{className:s,orientation:r="horizontal",decorative:o=!0,...l}=e;return(0,n.jsx)(S.f,{ref:t,decorative:o,orientation:r,className:(0,P.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...l})}));T.displayName=S.f.displayName;const z=e=>{let{text:t}=e;return(0,n.jsx)(n.Fragment,{children:t.split(" ").map(((e,t)=>(0,n.jsx)("h1",{className:"text-xl",children:e},t)))})};function R(e){let{index:t,subIndex:s=-1}=e;var r;const[i,d]=(0,c.useState)(!1),[u,x]=(0,c.useState)(-1),{formulas:p,setFormulas:m,selectedFormulaId:h}=(0,o.Z)(),{formulaFeedbacks:f}=(0,o.Z)(),g=p[h].steps[t],[j,v]=(0,c.useState)(-1==s?g.target.value:(null===(r=g.action.segments[s])||void 0===r?void 0:r.duration)||0);(0,c.useRef)(null);return(0,c.useEffect)((()=>{v(-1==s?g.target.value:g.action.segments[s].duration)}),[p[h].steps[t].target.value]),(0,c.useEffect)((()=>{var e,n,r;const o=null===(r=f[h])||void 0===r||null===(n=r[t])||void 0===n||null===(e=n.target)||void 0===e?void 0:e.value;-1==s&&x(o||-1)}),[f,t,h]),(0,n.jsxs)(F,{onOpenChange:e=>{d(0!=e)},open:i,children:[(0,n.jsx)(C,{children:(0,n.jsxs)("div",{className:"flex h-8 w-fit items-center justify-between rounded-lg p-2",onClick:()=>{d(!0)},children:[-1!=u&&(0,n.jsx)("h1",{className:" text-xl font-bold text-green-800",onClick:()=>d(!0),children:"".concat((u/1e3).toFixed(1),"/")}),(0,n.jsxs)("h1",{className:" text-xl font-bold text-blue-800",children:[j," ",j<=1?"second":"seconds"]})]})}),(0,n.jsxs)(N,{className:"w-80 space-y-8 rounded-xl  border",children:[(0,n.jsx)(b.FMH,{className:"absolute right-2 top-2 text-gray-500",size:20,onClick:()=>{d(!1)}}),(0,n.jsx)(a.RWL,{value:j,onChange:e=>{v(e),m((0,l.Uy)(p,(n=>{if(-1==s)n[h].steps[t].target.value=e;else{g.action.segments[s].duration=e}})))},label:"Time",type:"single",name:"value",minValue:0,maxValue:60,step:1})]})]})}const E=(e,t,s)=>{if(void 0===e)return[];const n=[];let o=0;e.forEach((e=>{o+=e.duration}));var l=0,i=0;for(const d of e){for(var a=0;a<d.duration;a+=1){var c=i+(d.value-i)*(a/d.duration);c=Math.round(10*c)/10,t==r.jk.Pressure?n.push({timestamp:l+a,pressure:c,max:10,min:0}):t==r.jk.Flowrate?n.push({timestamp:l+a,flowrate:c,max:50,min:0}):t==r.jk.Power&&n.push({timestamp:l+a,power:c,max:100,min:0})}i=d.value,l+=d.duration}return n},_=e=>{let{index:t}=e;(0,y.q)((()=>{r((0,l.Uy)(s,(e=>{const s=e[i].steps[t].action;return s.actionType="Profile",s.segments=s.segments||[],console.log("profile/ create object",s),0==e[i].steps[t].action.segments.length&&(e[i].steps[t].action.segments=[{duration:10,value:3}]),e})))}));const{formulas:s,setFormulas:r,selectedFormulaId:i}=(0,o.Z)(),a=s[i].steps[t].action,c=(a.segments||[]).map(((e,s)=>(0,n.jsxs)("div",{className:"flex-rol flex flex-wrap",children:[0==s?(0,n.jsx)(z,{text:"First, reach"}):(0,n.jsx)(z,{text:"then"}),(0,n.jsx)(O,{index:t,subIndex:s}),0==s?(0,n.jsx)(z,{text:"within"}):(0,n.jsx)(z,{text:"in"}),(0,n.jsx)(R,{index:t,subIndex:s}),(0,n.jsx)("h1",{className:"text-xl",children:s===a.segments.length-1?".":","})]},s)));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T,{}),(0,n.jsx)("ul",{children:c}),(0,n.jsxs)("div",{className:"flex h-6 w-fit cursor-pointer  flex-row items-center space-x-1 rounded-md bg-blue-100 p-2 transition-transform duration-200 hover:scale-105",children:[(0,n.jsx)(m.wEH,{color:"#1180EF",size:16,onClick:()=>{r((0,l.Uy)(s,(e=>{const s=e[i].steps[t].action;s.segments=s.segments||[],s.segments.push({duration:Math.floor(30*Math.random()),value:+(8*Math.random()+2).toFixed(1)})})))}}),(0,n.jsx)(m.iFH,{color:"#1180EF",size:16,onClick:()=>{void 0!==a.segments&&(a.segments.length<2||r((0,l.Uy)(s,(e=>(e[i].steps[t].action.segments.pop(),e)))))}})]})]})},A=e=>{let{index:t}=e;const[s,l]=(0,c.useState)([]),{formulas:i,setFormulas:d,selectedFormulaId:u}=(0,o.Z)(),{formulaFeedbacks:x}=(0,o.Z)(),p=i[u].steps[t].action,m=p.profilingType,h=p.segments,f=(0,c.useRef)([]);(0,c.useEffect)((()=>{try{const s=x[u][t].action;console.log("Line/ add value",s),f.current=f.current||[];var e=f.current;e.push({...s,timestamp:Math.round(s.timestamp/1e3)});const n=E(h,m);n.map(((t,s)=>{e.forEach((e=>{e.timestamp==t.timestamp&&(t.current=e.input)}))})),console.log("Line/ dpts",n,e),l(n)}catch(s){console.error(s)}}),[x]),(0,c.useEffect)((()=>{l(E(h,m))}),[h,m]);const g={};return g[r.jk.Pressure]="pressure",g[r.jk.Flowrate]="flowrate",g[r.jk.Power]="power",(0,n.jsx)("div",{className:"hover:scale-120 w-full -translate-x-10 transition-transform duration-200",children:(0,n.jsx)(a.wWH,{height:300,dataKey:"Time",categories:[g[m]||"unknown sensor","current","max","min"],hideLegend:!1,hideXAxis:!0,hideYAxis:!1,data:s,disableAnimation:!0},t)})},O=e=>{let{index:t,subIndex:s}=e;const[i,d]=(0,c.useState)(!1),{formulas:u,setFormulas:x,selectedFormulaId:p}=(0,o.Z)(),m=u[p].steps[t].action,h=m.profilingType,f=m.segments,g=s;let j="";h==r.jk.Pressure&&(j="bar"),h==r.jk.Flowrate?j="gram/s":h==r.jk.Power&&(j="%");const v={[r.jk.Pressure]:10,[r.jk.Flowrate]:100,[r.jk.Power]:100};return(0,n.jsxs)(F,{onOpenChange:e=>{console.log("close",e),0==e&&d(!1)},open:i,children:[(0,n.jsx)(C,{children:(0,n.jsx)("div",{className:"flex h-8 w-fit items-center justify-between rounded-lg p-2",onClick:()=>{d(!0)},children:(0,n.jsxs)("h1",{className:" text-xl font-bold text-blue-800",children:[f[g].value," ",j]})})}),(0,n.jsxs)(N,{className:"w-96 min-w-96 rounded-xl border",children:[(0,n.jsx)(b.FMH,{className:"absolute right-2 top-2 text-gray-500",size:20,onClick:()=>{d(!1)}}),(0,n.jsx)(a.RWL,{value:f[g].value,onChange:e=>{x((0,l.Uy)(u,(s=>{s[p].steps[t].action.segments[g].value=e})))},label:h,type:"single",name:"value",minValue:0,maxValue:v[h],step:.1})]})]})},K=e=>{let{index:t}=e;const[s,i]=(0,c.useState)(!1),{formulas:d,setFormulas:u,selectedFormulaId:x}=(0,o.Z)(),p=d[x].steps[t].action,[m,h]=(0,c.useState)(p.profilingType||r.jk.Flowrate);return(0,c.useEffect)((()=>{i(!1)}),[d]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:" font-bold text-xl text-blue-800",onClick:()=>{i(!0)},children:p.profilingType||r.jk.Flowrate}),s&&(0,n.jsx)(a.u_l,{size:"small",title:"Select an profiling method",onClose:()=>i(!1),primaryAction:{label:"OK",onPress:()=>{var e;i(!1),e=m,u((0,l.Uy)(d,(s=>{s[x].steps[t].action.actionType=r.g8.Profile,s[x].steps[t].action.profilingType=e})))}},secondaryAction:{label:"Cancel",onPress:()=>i(!1)},children:(0,n.jsxs)(a.Kqy,{space:16,children:[(0,n.jsxs)(a.r5R,{space:8,columns:2,children:[(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:m==r.jk.Flowrate?"solid":"outline",label:"Flowrate",onPress:()=>{h(r.jk.Flowrate)}}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:m==r.jk.Pressure?"solid":"outline",label:"Pressure",onPress:()=>{h(r.jk.Pressure)}}),(0,n.jsx)(a.zxk,{hierarchy:"primary",kind:m==r.jk.Power?"solid":"outline",label:"Power",onPress:()=>{h(r.jk.Power)}})]}),(0,n.jsx)(a.jL0,{kind:"informative",title:"What is this ?",description:m==r.jk.Flowrate?"Flowrate is the amount of water that flows through the coffee bed in a given time":m==r.jk.Pressure?"Pressure is the force applied to the coffee bed":"Power is the energy applied to the coffee bed, purely control the pump power to achieve the result"})]})})]})};var U=s(11163);const I=e=>{let{value:t,onChange:s}=e;console.log("action/ recreate");const[r,l]=(0,c.useState)(!1),{grinderSettings:i}=(0,o.Z)(),[d,u]=(0,c.useState)(t||"[select grinder]"),x=(0,U.useRouter)();return(0,y.q)((()=>{s("[select grinder]")})),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:" text-xl font-bold text-blue-800",onClick:()=>l(!0),children:d}),r&&(0,n.jsx)(a.u_l,{size:"small",title:"Select ingredient",onClose:()=>l(!1),primaryAction:{label:"OK",onPress:()=>{l(!1),s(d)}},secondaryAction:{label:"Cancel",onPress:()=>l(!1)},children:(0,n.jsxs)(a.Kqy,{space:8,children:[(0,n.jsxs)(a.gFv,{space:4,children:[i.map(((e,t)=>(0,n.jsx)(a.zxk,{kind:d==e.name?"solid":"outline",hierarchy:"primary",label:e.name,onPress:()=>u(e.name)},t))),(0,n.jsx)(a.zxk,{kind:"outline",hierarchy:"primary",label:"+",onPress:()=>{x.push("/setting")}},-1)]}),(0,n.jsx)(a.jL0,{kind:"informative",title:"Reminder",description:"You can set up your grinder in the settings, the hardware can be connected to the machine wirelessly to the espresso machine",action:{label:"Learn more",onPress:()=>{window.open("https://www.google.com")}}})]})})]})},G=e=>{let{value:t,onChange:s}=e;const[r,o]=(0,c.useState)(!1),[l,i]=(0,c.useState)(t||0);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"rounded-lg w-fit h-8 p-2 justify-between items-center flex",onClick:()=>{o(!0)},children:(0,n.jsxs)("h1",{className:"font-bold text-xl text-blue-800",children:[t||0," %"]})}),r&&(0,n.jsx)(a.u_l,{size:"small",title:"Set pump power",onClose:()=>o(!1),primaryAction:{label:"OK",onPress:()=>{o(!1),console.log(" update power",l),s(l)}},secondaryAction:{label:"Cancel",onPress:()=>o(!1)},children:(0,n.jsxs)(a.Kqy,{space:8,children:[(0,n.jsx)(a.RWL,{type:"single",name:"power",value:l,onChange:e=>{console.log("Power is updated for pump",e),i(e)},label:"Pump Power",minValue:10,maxValue:100,step:1}),(0,n.jsx)(a.jL0,{kind:"informative",title:"Notice",description:"Power require an external pump to be connected to the machine, other wise it is simply ON/OFF",action:{label:"Learn more",onPress:()=>{window.open("https://www.google.com")}}})]})})]})};function L(e){let{index:t}=e;const[s,i]=(0,c.useState)(!1),{formulas:d,setFormulas:u,selectedFormulaId:x,formulaFeedbacks:p}=(0,o.Z)(),m=d[x].steps[t],[h,f]=(0,c.useState)(m.target.value),[g,j]=(0,c.useState)(0);(0,c.useEffect)((()=>{var e,s,n;const r=(null===(n=p[x])||void 0===n||null===(s=n[t])||void 0===s||null===(e=s.target)||void 0===e?void 0:e.value)||0;j(r)}),[p,t,x]);(0,c.useRef)(null);return(0,n.jsxs)(n.Fragment,{children:[null!=g&&(0,n.jsx)("h1",{className:" text-xl font-bold text-green-800",onClick:()=>i(!0),children:"".concat((g/10).toFixed(1),"/")}),(0,n.jsxs)("h1",{className:" text-xl font-bold text-blue-800",onClick:()=>i(!0),children:[m.target.value.toFixed(1),m.target.value<=1?" gram":" grams"]}),s&&(0,n.jsx)(a.u_l,{size:"small",title:"How much ?",onClose:()=>i(!1),primaryAction:{label:"OK",onPress:()=>{i(!1),u((0,l.Uy)(d,(e=>{e[x].steps[t].target.targetType=r.YK.Weight,e[x].steps[t].target.value=h})))}},secondaryAction:{label:"Cancel",onPress:()=>i(!1)},children:(0,n.jsxs)(a.Kqy,{space:8,children:[(0,n.jsx)(a.RWL,{type:"single",name:"weight",value:h,onChange:f,label:"Weight",minValue:0,maxValue:500,step:1}),(0,n.jsx)(a.jL0,{kind:"informative",title:"Reminder",description:"Calibration is required for accurate weight, please go to Settings"})]})})]})}function Z(e){let{onDelete:t,index:s}=e;const{formulas:a,setFormulas:c,selectedFormulaId:d}=(0,o.Z)(),u=a[d].steps||[];return(0,n.jsxs)("div",{className:"flex h-fit w-96 max-w-[calc(90vw)] flex-col rounded-xl  border  bg-white p-4 drop-shadow-xl transition-transform duration-200 hover:scale-105 hover:border-blue-500",children:[(0,n.jsx)("div",{className:"absolute right-0 top-0 cursor-pointer p-2",onClick:()=>t(),children:(0,n.jsx)(i.maG,{className:"text-gray-300"})}),(0,n.jsxs)("div",{className:"inline-flex max-w-96 flex-wrap items-center gap-2 space-x-1 text-wrap",children:[(0,n.jsx)(v,{index:s}),"Grind"===a[d].steps[s].action.actionType&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L,{index:s}),(0,n.jsx)(z,{text:"of"}),(0,n.jsx)(I,{value:u[s].action.ingredient,onChange:e=>{c((0,l.Uy)(a,(t=>{t[d].steps[s].action.ingredient=e})))}}),(0,n.jsx)(z,{text:"bean, grinder"}),(0,n.jsx)(w,{value:u[s].action.canSkip,onChange:e=>{c((0,l.Uy)(a,(t=>{t[d].steps[s].action.canSkip=e,t[d].steps[s].action.actionType=r.g8.Grind})))}}),!0===u[s].action.canSkip?(0,n.jsx)(z,{text:"this step is portafilter is absent"}):(0,n.jsx)(z,{text:"until portafilter is present"})]}),"Extract"===u[s].action.actionType&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L,{index:s}),(0,n.jsx)(z,{text:"with pump power"}),(0,n.jsx)(G,{value:u[s].action.power,onChange:e=>{c((0,l.Uy)(a,(t=>{t[d].steps[s].action.actionType=r.g8.Extract,t[d].steps[s].action.power=e})))}})]}),u[s].action.actionType===r.g8.PourOver&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L,{index:s}),(0,n.jsx)(z,{text:"in"}),(0,n.jsx)(R,{subIndex:-1,index:s})]}),"Rest"===u[s].action.actionType&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z,{text:"for"}),(0,n.jsx)(R,{subIndex:-1,index:s}),u[s].action.valveState&&(0,n.jsx)(z,{text:"but keep valve open"})]}),"Profile"===u[s].action.actionType&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z,{text:"to extract"}),(0,n.jsx)(L,{index:s}),(0,n.jsx)(z,{text:"of espresso using"}),(0,n.jsx)(K,{index:s}),(0,n.jsx)(z,{text:"profiling"}),(0,n.jsx)(_,{index:s}),(0,n.jsx)(A,{index:s})]})]})]})}var W=s(15948),Y=s(26281),q=s(3189);var V=()=>{var e;const t=(0,U.useRouter)(),[s,i]=(t.query.slug,(0,c.useState)(-1)),[d,u]=(0,c.useState)(-1),[m,h]=(0,c.useState)(!1),[f,g]=(0,c.useState)(!1),[j,v]=(0,c.useState)(!0),[b,y]=(0,c.useState)(!1),{selectedFormulaId:w,registerSelectedFormulaId:k,setFormulas:P,formulas:F,setSelectedPage:C,registerFormulaClick:N,cancelFormulaClick:S,progressReport:z}=(0,o.Z)(),[R,E]=(0,c.useState)(!1),_=(0,c.useRef)(),{formulaFeedbacks:A}=(0,o.Z)();(0,c.useEffect)((()=>{_&&(clearTimeout(_.current),_.current=setTimeout((()=>{y(!1)}),2e3),y(!0))}),[A[w]]),(0,c.useEffect)((function(){E(!0)}),[]),(0,c.useEffect)((()=>{console.log("lab/ re-render",w)}),[w]);return(0,n.jsxs)(q.default,{children:[m&&(0,n.jsxs)(a.u_l,{size:"large",autoFocus:!1,title:"Assign to Button",onClose:()=>h(!1),primaryAction:{label:"Download",onPress:()=>{v(!0),setTimeout((()=>{h(!1)}),3e3)}},secondaryAction:{label:"Cancel",onPress:()=>h(!1)},children:[(0,n.jsx)(a.uTp,{size:"medium",children:"This process will save the formula to a physical button on your cofee machine so you don't always need a mobile device connected"}),(0,n.jsxs)("div",{className:"w-full h-32 flex flex-col space-y-4 p-4",children:[(0,n.jsx)(a.r5R,{space:8,columns:3,children:[1,2,3].map(((e,t)=>(0,n.jsx)(a.zxk,{label:"Group ".concat(e),hierarchy:"primary",kind:t===s?"solid":"outline",onPress:()=>i(t)},t)))}),(0,n.jsx)(a.r5R,{space:8,columns:4,children:[1,2,3,4].map(((e,t)=>(0,n.jsx)(a.zxk,{label:"Button ".concat(e),hierarchy:"primary",kind:t===d?"solid":"outline",onPress:()=>u(t)},t)))})]})]}),f&&(0,n.jsx)(a.u_l,{title:"Share",onClose:()=>g(!1),primaryAction:{label:"OK",onPress:()=>g(!1)},secondaryAction:{label:"Cancel",onPress:()=>g(!1)},children:(0,n.jsx)(a.uTp,{size:"medium",children:"Content"})}),(0,n.jsxs)("div",{className:"flex flex-col  items-center space-y-4 p-4",children:[(0,n.jsxs)("div",{className:" h-fit  rounded-xl max-w-[calc(90vw)] w-96 p-4 flex flex-col space-y-4 shadow-xl border",children:[(0,n.jsx)(a.nvn,{value:null===(e=F[w])||void 0===e?void 0:e.title,onChange:e=>{P((0,l.Uy)(F,(t=>{console.log("Formulas",F,w),t[w].title=e})))},label:"Formula",placeholder:"Untitled formula"}),(0,n.jsxs)("div",{className:"flex flex-row justify-between items-center space-x-1 text-white",children:[!0===b?(0,n.jsxs)("div",{className:"rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-2/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-orange-400 to-red-400 text-white select-none",onClick:()=>{S(w)},children:[(0,n.jsx)(p.JuG,{}),(0,n.jsx)("h1",{children:"Stop"})]}):(0,n.jsxs)("div",{className:"rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-2/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-blue-400 to-emerald-400 text-white select-none",onClick:()=>{N(w)},children:[(0,n.jsx)(p.gmG,{}),(0,n.jsx)("h1",{children:"Play"})]}),(0,n.jsx)("div",{className:"rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-1/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-purple-800 via-violet-900 to-purple-800",onClick:()=>{console.log("download"),h(!0)},children:(0,n.jsx)(p.aBF,{})}),(0,n.jsx)("div",{className:"rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-1/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-blue-500 to-blue-600",onClick:()=>{g(!0)},children:(0,n.jsx)(p.PPi,{})}),(0,n.jsx)("div",{className:"rounded-xl border flex flex-row justify-evenly items-center bg-white p-4 h-12 w-1/5 cursor-pointer hover:border-blue-500 bg-gradient-to-r from-red-500 to-red-800",onClick:()=>{console.log("delete"),C("Formula"),k(""),P((0,l.Uy)(F,(e=>{delete F[w]}))),t.push("/")},children:(0,n.jsx)(p.zYX,{})})]})]}),(0,n.jsx)(T,{}),(0,n.jsxs)("div",{className:" flex flex-col py-3 justify-center items-center mix-w-80 ",children:[(0,n.jsx)(W.Z5,{onDragEnd:function(e,t){e.destination&&P((0,l.Uy)(F,(t=>{var s;const n=t[w],[r]=n.steps.splice(e.source.index,1);return n.steps.splice((null===e||void 0===e||null===(s=e.destination)||void 0===s?void 0:s.index)||0,0,r),t})))},onBeforeDragStart:()=>{console.log("onBeforeDragStart")},onDragStart:()=>{console.log("onDragStart")},onDragUpdate:()=>{console.log("onDragUpdate")},children:(0,n.jsx)("div",{className:"flex flex-row w-full",children:(0,n.jsx)(W.bK,{droppableId:"ROOT",children:e=>{var t,s;return(0,n.jsxs)("div",{...e.droppableProps,ref:e.innerRef,className:"flex flex-col w-full justify-between mx-auto items-center space-y-4",children:[null===(t=(null===(s=F[w])||void 0===s?void 0:s.steps)||[])||void 0===t?void 0:t.map(((e,t)=>(console.log("render",{item:e,idx:t}),R&&(0,n.jsx)(W._l,{draggableId:null===e||void 0===e?void 0:e.id,index:t,children:s=>(0,n.jsx)("div",{className:"",...s.dragHandleProps,...s.draggableProps,ref:s.innerRef,children:(0,n.jsx)(Z,{onDelete:()=>function(e){P((0,l.Uy)(F,(t=>{const s=t[w];return s.steps=s.steps.filter((function(t){return(null===t||void 0===t?void 0:t.id)!==e})),t})))}(null===e||void 0===e?void 0:e.id),index:t})})},null===e||void 0===e?void 0:e.id)))),e.placeholder]})}})})}),(0,n.jsxs)("button",{className:"flex flex-row space-x-4 justify-center items-center rounded-xl border  cursor-pointer w-80 h-16 my-4 bg-blue-100",onClick:function(){P((0,l.Uy)(F,(e=>{e[w].steps.push({id:(0,Y.Vj)(),action:{actionType:r.g8.Rest,valveState:!1},target:{targetType:r.YK.Time,value:10}})})))},children:[(0,n.jsx)(x.OzW,{color:"#1180EF",size:30}),(0,n.jsx)("p",{className:"text-[#1180EF] font-bold text-lg",children:"Add steps"})]})]})]})]})}}},function(e){e.O(0,[838,396,660,817,509,127,391,365,768,594,630,415,281,810,189,774,888,179],(function(){return t=17503,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=lab-f421746fea02f3d6.js.map