(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{45824:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/setting",function(){return t(97402)}])},97402:function(e,s,t){"use strict";t.r(s),t.d(s,{SettingsPage:function(){return W},default:function(){return E}});var n=t(85893),l=t(80907),a=t(86204),r=t(71054),i=t(67294),c=t(65058),o=t(37039),d=t(93513),x=t(23482);const m=i.forwardRef(((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("div",{ref:s,className:(0,x.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...l})}));m.displayName="Card";const u=i.forwardRef(((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("div",{ref:s,className:(0,x.cn)("flex flex-col space-y-1.5 p-6",t),...l})}));u.displayName="CardHeader";const h=i.forwardRef(((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("h3",{ref:s,className:(0,x.cn)("text-2xl font-semibold leading-none tracking-tight",t),...l})}));h.displayName="CardTitle";const j=i.forwardRef(((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("p",{ref:s,className:(0,x.cn)("text-sm text-muted-foreground",t),...l})}));j.displayName="CardDescription";const f=i.forwardRef(((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("div",{ref:s,className:(0,x.cn)("p-6 pt-0",t),...l})}));f.displayName="CardContent";const g=i.forwardRef(((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("div",{ref:s,className:(0,x.cn)("flex items-center p-6 pt-0",t),...l})}));g.displayName="CardFooter";var p=t(30080);const w=e=>{let{index:s}=e;const{connected:t,calibration:a,setCalibration:r}=(0,c.Z)(),[x,g]=(0,i.useState)(new Array(100).fill({temperature:0,power:0})),{t:w}=(0,o.$G)(),{flowmeterDisplay:y}=(0,c.Z)(),[v,b]=(0,i.useState)(!1),N=(0,n.jsx)(n.Fragment,{}),[C,k]=(0,i.useState)(!0),[R,P]=(0,i.useState)(y[s].flowCount);return(0,i.useEffect)((()=>{P(y[s].flowCount)}),[y,s]),(0,n.jsxs)(n.Fragment,{children:[v&&(0,n.jsx)(l.u_l,{size:"small",title:w("Calibrate flowmeter"),onClose:()=>b(!1),primaryAction:{label:"OK",onPress:()=>{b(!1),function(){var e=R,t=e/y[s].flowCount*a.flowmeter[s];console.log("calibration/ ",{suggestedValue:e,previousValue:y[s].flowCount,currentCalibration:a.flowmeter[s],newCalibration:t}),r((0,d.Uy)(a,(e=>{e.flowmeter[s]=t})))}()}},secondaryAction:{label:"Cancel",onPress:()=>b(!1)},children:(0,n.jsxs)(l.Kqy,{space:8,children:[(0,n.jsx)(l.jL0,{kind:"informative",title:w("Notice"),description:w("This calibration process is to set the conversion between flowmeter pulses count with the actual total weight of water extracted"),action:{label:w("Learn more"),onPress:()=>{window.open("https://www.google.com")}}}),(0,n.jsx)(l.RWL,{type:"single",name:"value",label:w("Real weight (gram)"),value:R,onChange:e=>{P(e)},minValue:0,maxValue:200,step:1})]})}),(0,n.jsxs)(m,{className:"w-auto m-4",children:[(0,n.jsxs)(u,{children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)(h,{children:[w("Channel")," ",s+1]}),(0,n.jsx)(l.zxk,{onPress:function(){b(!0)},hierarchy:"secondary",kind:"outline",label:w("Calibrate"),size:"small",icon:()=>(0,n.jsx)(p.b9P,{})})]}),(0,n.jsx)(l.izJ,{}),(0,n.jsx)(j,{children:(0,n.jsxs)("div",{className:"h-16 bg-white flex flex-row justify-evenly",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:w("Flowrate ")}),(0,n.jsxs)("h1",{className:"text-3xl",children:[y[s].flowRate," gram/s"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{children:w("Weight")}),(0,n.jsxs)("h1",{className:"text-3xl",children:[y[s].flowCount," gram"]})]})]})})]}),(0,n.jsx)(f,{children:C?(0,n.jsx)(n.Fragment,{children:N}):null})]})]})};var y=t(19151);const v=e=>{let{key:s,index:t}=e;const{grinderSettings:r,setGrinderSettings:i}=(0,c.Z)();return console.log("Grinder/ create ",s),(0,n.jsxs)("div",{className:"flex flex-col  space-y-4 rounded-xl bg-white p-4",children:[(0,n.jsx)(l.nvn,{name:"ingredient",label:"Ingredient",placeholder:"What is the coffee bean ?",value:r[t].name,onChange:e=>{i((0,d.Uy)(r,(s=>{s[t].name=e})))}}),(0,n.jsx)("div",{className:"flex flex-grow flex-row justify-stretch space-x-4",children:(0,n.jsxs)(l.oeA,{space:8,children:[(0,n.jsx)(l.sgG,{width:"4/5",children:(0,n.jsx)(l.mgC,{value:r[t].connectionType,onChange:e=>{i((0,d.Uy)(r,(s=>{s[t].connectionType=e})))},name:"connectionType",label:"Connection",placeholder:"How is the grinder connected ?",options:[{value:"wire",label:"Wire",kind:"two-line",secondLine:"Direct wiring using the PID port"},{value:"ble",label:"Bluetooth",kind:"two-line",secondLine:"Pair to a Bluetooth scale"}]})}),(0,n.jsx)(l.sgG,{width:"1/5",children:(0,n.jsx)(l.Ki0,{name:"ID",value:r[t].connectionId,onChange:e=>{i((0,d.Uy)(r,(s=>{s[t].connectionId=e})))},label:"ID"})})]})}),(0,n.jsxs)("div",{className:"my-4 flex flex-row space-x-4",children:[(0,n.jsx)(l.zxk,{label:"Calibrate",onPress:()=>{},hierarchy:"primary",kind:"outline",icon:()=>(0,n.jsx)(a.mdD,{})}),(0,n.jsx)(l.zxk,{label:"Test",onPress:()=>{},hierarchy:"primary",kind:"outline",icon:()=>(0,n.jsx)(y.WuV,{})}),(0,n.jsx)(l.zxk,{label:"Remove",onPress:()=>{},hierarchy:"danger",kind:"outline",icon:()=>(0,n.jsx)(p.ZkW,{})})]})]})};var b=t(55903),N=t(64399);const C=e=>{let{index:s}=e;const{pidState:t,setPidState:a,pidDisplay:r}=(0,c.Z)(),{connected:x}=(0,c.Z)(),[w,v]=(0,i.useState)(new Array(100).fill({temperature:0,power:0}));(0,i.useEffect)((()=>{if(void 0==r[s].powerSamples)return;const e=[];for(var n=0;n<r[s].powerSamples.length;n++)e.push({power:r[s].powerSamples[n],temperature:r[s].temperatureSamples[n],target:t[s].targetTemperature});v(e)}),[r,s,t]);const{t:C}=(0,o.$G)();(0,i.useEffect)((()=>{}),[r,s,t]);const k=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.RWL,{type:"single",name:"value",label:C("Temperature"),value:t[s].targetTemperature,onChange:e=>{a((0,d.Uy)(t,(t=>(t[s].targetTemperature=e,t))))},minValue:0,maxValue:200,step:1,disabled:!x}),(0,n.jsx)(l.RWL,{type:"single",name:"value",label:C("Active Range"),value:t[s].activeRange,onChange:e=>{a((0,d.Uy)(t,(t=>(t[s].activeRange=e,t))))},minValue:0,maxValue:10,step:1,disabled:!x}),(0,n.jsx)(l.RWL,{type:"single",name:"value",label:"Proportional",value:t[s].proportional,onChange:e=>{a((0,d.Uy)(t,(t=>{t[s].proportional=e})))},minValue:0,maxValue:10,step:.1,disabled:!x}),(0,n.jsx)(l.RWL,{type:"single",name:"value",label:"integral",value:t[s].integral,onChange:e=>{a((0,d.Uy)(t,(t=>{t[s].integral=e})))},minValue:0,maxValue:1,step:.1,disabled:!x}),(0,n.jsx)(l.RWL,{type:"single",name:"value",label:"Derivative",value:t[s].derivative,onChange:e=>{a((0,d.Uy)(t,(t=>{t[s].derivative=e})))},minValue:0,maxValue:10,step:.1,disabled:!x})]}),[R,P]=(0,i.useState)(!0),S=(0,n.jsxs)("div",{className:"flex flex-wrap justify-center space-x-1 space-y-1 mb-4",children:[(0,n.jsx)(l.zxk,{onPress:()=>{},hierarchy:"primary",kind:"outline",label:"Test",size:"small",icon:()=>(0,n.jsx)(y.WuV,{})}),(0,n.jsx)(l.zxk,{onPress:()=>{a((0,d.Uy)(t,(e=>{e[s].targetTemperature=110,e[s].activeRange=2,e[s].proportional=3.2,e[s].integral=.2,e[s].derivative=5})))},hierarchy:"danger",kind:"outline",size:"small",label:"Reset",icon:()=>(0,n.jsx)(N.Z4w,{})})]});return(0,n.jsxs)(m,{className:"w-auto",children:[(0,n.jsxs)(u,{children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)(h,{children:[C("Channel")," ",s+1]}),(0,n.jsx)(l.rsf,{value:t[s].isActive,onChange:e=>{a((0,d.Uy)(t,(t=>(t[s].isActive=e,t))))},label:C("Active")})]}),(0,n.jsx)(b.j,{}),(0,n.jsx)(j,{children:t[s].isActive?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(m,{className:"h-40 bg-white",children:[(0,n.jsx)(l.wWH,{hideLegend:!1,hideXAxis:!0,dataKey:"name",categories:["temperature","power","target"],disableAnimation:!0,hideYAxis:!0,hideTooltip:!1,data:w})," "]})}):(0,n.jsx)(n.Fragment,{children:C("This PID channel is currently disabled")})})]}),t[s].isActive?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f,{children:R?(0,n.jsxs)(n.Fragment,{children:[S,k]}):null}),(0,n.jsx)(g,{onClick:()=>{P(!R)},className:"justify-center",children:R?(0,n.jsx)(p.Faw,{}):(0,n.jsx)(p.Yc6,{})})]}):null]})};var k=t(6011),R=t(24862),P=t(19314),S=t(22845),A=t(11163),F=t(95485);const V=()=>{const{t:e}=(0,o.$G)(),[s,t]=(0,i.useState)(!1),[r,c]=(0,i.useState)(!1),d=()=>{t(!s),console.log("toggle expand")},x=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if(!s&&x.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);x.current.getBoundingClientRect().top}}),[s]),(0,n.jsxs)(k.w,{ref:x,className:"w-full max-w-2xl transform bg-gradient-to-r from-purple-600 to-red-600 transition duration-500 ",children:[(0,n.jsxs)(R.u,{className:"flex h-16 flex-row items-center justify-between",onClick:d,children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(a.YzZ,{className:"ml-4 text-white"}),(0,n.jsx)("h2",{className:"mx-4 font-bold text-white",children:e("Heater")})]}),s?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(p.Ix0,{className:"mr-4 text-white"})}):(0,n.jsx)(p.AeI,{className:"mr-4 text-white"})]}),s?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(P.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:[(0,n.jsx)(C,{index:0}),(0,n.jsx)(C,{index:1}),(0,n.jsx)(C,{index:2})]}),(0,n.jsx)(S.i,{onClick:d,className:"align-center justify-center",children:(0,n.jsx)(p.rWj,{className:"m-4 text-white"})})]}):null,r&&(0,n.jsx)(l.u_l,{title:"Calibrate flowmeter",size:"small",onClose:()=>c(!1),primaryAction:{label:"OK",onPress:()=>c(!1)},secondaryAction:{label:"Cancel",onPress:()=>c(!1)},autoFocus:!1,children:(0,n.jsx)(l.eBu,{space:4,children:(0,n.jsx)(l.uTp,{size:"medium",children:"Content"})})})]})},T=()=>{const[e,s]=(0,i.useState)(!1),{t:t}=(0,o.$G)(),l=()=>{s(!e),console.log("toggle expand")},r=(0,i.useRef)(null);return(0,i.useEffect)((()=>{if(!e&&r.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);r.current.getBoundingClientRect().top}}),[e]),(0,n.jsxs)(k.w,{ref:r,className:"w-full max-w-2xl transform bg-gradient-to-r from-blue-600 to-green-600 transition duration-500 ",children:[(0,n.jsxs)(R.u,{className:"flex h-16 flex-row items-center justify-between",onClick:l,children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(a.E3g,{className:"ml-4 text-white"}),(0,n.jsx)("h2",{className:"mx-4 font-bold text-white",children:t("Flowmeter")})]}),e?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(p.Ix0,{className:"mr-4 text-white"})}):(0,n.jsx)(p.AeI,{className:"mr-4 text-white"})]}),e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex w-full flex-col justify-center space-y-4 py-4",children:[(0,n.jsx)(w,{index:0}),(0,n.jsx)(w,{index:1}),(0,n.jsx)(w,{index:2})]}),(0,n.jsx)(S.i,{onClick:l,className:"align-center justify-center",children:(0,n.jsx)(p.rWj,{className:"m-4 text-white"})})]}):null]})},I=()=>{const{locale:e,locales:s,defaultLocale:t}=(0,A.useRouter)(),[l,a]=(0,i.useState)(!1),{grinderSettings:d}=(0,c.Z)(),{t:x}=(0,o.$G)(),m=()=>{console.log("toggle expand")},u=(0,i.useRef)(null);(0,i.useEffect)((()=>{if(!l&&u.current){const e=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--navbar-height"),10);u.current.getBoundingClientRect().top}}),[l]);return(0,n.jsxs)(k.w,{ref:u,className:"w-full max-w-2xl transform bg-gradient-to-r from-orange-600 to-yellow-600 transition duration-500 ",children:[(0,n.jsxs)(R.u,{className:"flex h-16 flex-row items-center justify-between",onClick:m,children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(r.nXt,{className:"ml-4 text-white"}),(0,n.jsx)("h2",{className:"mx-4 font-bold text-white",children:x("Grinder")})]}),l?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(p.Ix0,{className:"mr-4 text-white"})}):(0,n.jsx)(p.AeI,{className:"mr-4 text-white"})]}),l?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.G,{className:"flex w-full flex-col justify-center space-y-4 py-4",children:d.map(((e,s)=>(console.log("Grinder/ create with",{item:e,index:s}),(0,n.jsx)(v,{index:s},s))))}),(0,n.jsx)(S.i,{onClick:m,className:"align-center justify-center",children:(0,n.jsx)(p.rWj,{className:"m-4 text-white"})})]}):null]})},W=()=>(0,n.jsx)(F.default,{children:(0,n.jsxs)("div",{className:" flex flex-col items-center  p-8 space-y-4",children:[(0,n.jsx)(V,{}),(0,n.jsx)(T,{}),(0,n.jsx)(I,{})]})});var E=W}},function(e){e.O(0,[838,396,660,817,509,127,391,653,415,153,485,774,888,179],(function(){return s=45824,e(e.s=s);var s}));var s=e.O();_N_E=s}]);
//# sourceMappingURL=setting-8821dbc7174049e0.js.map