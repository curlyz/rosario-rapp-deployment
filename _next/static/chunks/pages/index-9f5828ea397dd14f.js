(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(407)}])},407:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return k}});var o,l,a=t(5893);t(4554),t(6839),(o=l||(l={})).Espresso="Espresso",o.Teapresso="Teapresso",o.PourOver="PourOver";var s=t(2290),n=t(9600),i=t(7294),d=t(2777),u=t(1054),c=t(7094),g=t(80),m=t(5282);function h(e){var r,t,o;let{formulaId:h,onClickEdit:b,onClick:f}=e,{draggable:x,progressReport:v}=(0,s.Z)(),[p,y]=(0,i.useState)(0),w=(0,i.useRef)(null),{formulas:j,setFormulas:N}=(0,s.Z)();(0,i.useEffect)(()=>{y(w.current.clientHeight)},[]);let k=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 flex flex-col  items-center justify-between",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"hover:opacity-50",onMouseDown:e=>{b(),e.preventDefault(),e.stopPropagation()},onTouchStart:e=>{b(),e.preventDefault(),e.stopPropagation()},children:(0,a.jsx)(m.DVr,{size:32,className:"text-white m-1 "})}),(0,a.jsx)("button",{children:(0,a.jsx)(d.uWH,{size:20,className:"text-white m-1 drag-handle"})})]}):(0,a.jsxs)("div",{className:"opacity-20 m-1",children:[j[h].formulaType===l.Espresso&&(0,a.jsx)(u.q_H,{size:32,className:"text-white m-1"}),j[h].formulaType===l.Teapresso&&(0,a.jsx)(c.QFv,{size:32,className:"text-white m-1"}),j[h].formulaType===l.PourOver&&(0,a.jsx)(g.e0F,{size:32,className:"text-white m-1"})]})}),(0,a.jsx)("h1",{className:"truncate text-clip text-balance text-xl text-center select-none text-white",children:j[h].title})]}),P=(0,a.jsxs)("div",{className:"w-full h-full first-letter  absolute bottom-0 left-0",children:[(0,a.jsx)(n.wWH,{height:p,dataKey:"name",categories:["flowrate"],hideLegend:!0,hideXAxis:!0,hideYAxis:!0,data:[...Array.from({length:10},(e,r)=>({name:"Point ".concat(r+1),flowrate:Math.floor(100*Math.random())}))]})," "]});return(0,a.jsx)("div",{ref:w,className:"border rounded-xl ".concat((null===(r=v[j[h].id])||void 0===r?void 0:r.isRunning)===!0?"bg-white":j[h].backdrop,"  w-full h-full flex flex-col  transition transform duration-200 hover:border-blue-500  items-center  justify-center shadow-large border ").concat((null===(t=v[j[h].id])||void 0===t?void 0:t.isRunning)===!0?"border-black":"border-white"," cursor-pointer select-none transition-all duration-1000 ease-in-out"),onMouseDown:e=>{f(),console.log("profile/ clicked")},children:(null===(o=v[j[h].id])||void 0===o?void 0:o.isRunning)===!0?P:k})}var b=t(3513),f=t(1163),x=t(9968),v=t(6281),p=t(8979);let y=(0,x.WidthProvider)(x.Responsive),w=["bg-gradient-to-br from-yellow-900 via-red-600 to-yellow-500","bg-gradient-to-bl from-yellow-900 via-red-600 to-yellow-500","bg-gradient-to-tl from-yellow-900 via-red-600 to-yellow-500","bg-gradient-to-br from-yellow-900 via-red-600 to-yellow-500","bg-gradient-to-bl from-yellow-900 via-red-600 to-yellow-500","bg-gradient-to-tr from-yellow-900 via-red-600 to-yellow-500"],j=["bg-gradient-to-b from-green-900 via-green-600 to-teal-500","bg-gradient-to-r from-green-900 via-green-600 to-teal-500","bg-gradient-to-r from-green-900 via-green-600 to-teal-500","bg-gradient-to-b from-green-900 via-green-600 to-teal-500","bg-gradient-to-b from-green-900 via-green-600 to-teal-500","bg-gradient-to-r from-green-900 via-green-600 to-teal-500"],N=["bg-gradient-to-b from-blue-900 via-blue-600 to-cyan-500","bg-gradient-to-b from-blue-900 via-blue-600 to-cyan-500","bg-gradient-to-t from-blue-900 via-blue-600 to-cyan-500","bg-gradient-to-t from-blue-900 via-blue-600 to-cyan-500","bg-gradient-to-l from-blue-900 via-blue-600 to-cyan-500","bg-gradient-to-t from-blue-900 via-blue-600 to-cyan-500"];var k=()=>{let[e,r]=(0,i.useState)(!1),{formulas:t,setFormulas:o,addFormulaOpen:d,setAddFormulaOpen:u}=(0,s.Z)(),{layout:c,setLayout:g}=(0,s.Z)(),m=(0,f.useRouter)(),{showToast:x}=(0,n.pmc)(),{registerFormulaClick:k,registerSelectedFormulaId:P}=(0,s.Z)(),E=[];Object.values(t).forEach(e=>{let r=(0,a.jsx)("div",{className:"grid-item__title ",children:(0,a.jsx)("div",{className:"w-full h-full",children:(0,a.jsx)(h,{formulaId:e.id,onClick:()=>{k(e.id)},onClickEdit:()=>{P(e.id),m.push("/lab")}})})},e.id);E.push(r)});let{draggable:T}=(0,s.Z)(),[_,O]=(0,i.useState)("New Formula"),[M,z]=(0,i.useState)(l.Espresso);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(p.default,{children:[(0,a.jsx)("div",{className:"h-[80vh] dark:bg-gray",children:(0,a.jsx)(y,{compactType:null,className:"layout relative",layouts:c,isDraggable:T,isResizable:T,useCSSTransforms:!1,draggableHandle:".drag-handle",breakpoints:{lg:1280,md:992,sm:767,xs:430,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},onLayoutChange:(t,o)=>{if(!e){r(!0);return}g(o)},onDragStart:()=>{console.log("OnDragStart")},children:E})}),d&&(0,a.jsx)(n.u_l,{title:"Add formula",onClose:()=>u(!1),primaryAction:{label:"OK",onPress:()=>{u(!1),function(){let e=(0,v.Vj)();g((0,b.Uy)(c,r=>{var t,o,l;null===(t=r.md)||void 0===t||t.push({i:e,x:0,y:0,w:1,h:1}),null===(o=r.xs)||void 0===o||o.push({i:e,x:0,y:0,w:1,h:1}),null===(l=r.sm)||void 0===l||l.push({i:e,x:0,y:0,w:1,h:1})})),o((0,b.Uy)(t,r=>{let t;M==l.Espresso?t=w[Math.floor(Math.random()*w.length)]:M==l.PourOver?t=N[Math.floor(Math.random()*N.length)]:M==l.Teapresso&&(t=j[Math.floor(Math.random()*j.length)]);let o={id:e,title:_,text:"New Formula",color:"gray",backdrop:t,formulaType:M,steps:[]};r[e]=o,console.log("fml/ create new",o)})),console.log("addFormula",{layout:c,formulas:t})}()}},secondaryAction:{label:"Cancel",onPress:()=>u(!1)},children:(0,a.jsxs)(n.Kqy,{space:4,children:[(0,a.jsx)(n.nvn,{label:"Formula Name",value:_,onChange:e=>{O(e)}}),(0,a.jsxs)(n.r5R,{space:4,columns:3,children:[(0,a.jsx)(n.zxk,{hierarchy:"primary",kind:M==l.Espresso?"solid":"outline",label:"Espresso",onPress:()=>{z(l.Espresso)}}),(0,a.jsx)(n.zxk,{hierarchy:"primary",kind:M==l.Teapresso?"solid":"outline",label:"Teapresso",onPress:()=>{z(l.Teapresso)}}),(0,a.jsx)(n.zxk,{hierarchy:"primary",kind:M==l.PourOver?"solid":"outline",label:"Pour over",onPress:()=>{z(l.PourOver)}})]})]})})]})})}}},function(e){e.O(0,[838,396,660,817,509,127,970,415,281,611,979,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);